<!doctype html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>MEME ChIP</title>
    <script>
      // @JSON_VAR data
      var data = {
        "version": "4.9.0",
        "revision": "dda626be5dfa",
        "release": "Wed Sep 19 09:32:35 EST 2012",
        "cmd": ["meme-chip", "-db", "JASPAR_CORE_2009.meme", "sample-dna-Klf1.fa"],
        "programs": [
          {
            "name": "bg",
            "cmd": "fasta-get-markov -nostatus -m 1 < memechip_out\/sample-dna-Klf1.fa 1> memechip_out\/background",
            "status": 0,
            "oot": false,
            "time": 1.918697,
            "outputs": [
              {
                "name": "Background",
                "file": "background"
              }
            ]
          }, {
            "name": "count_seqs",
            "cmd": "getsize memechip_out\/sample-dna-Klf1.fa 1> $metrics",
            "status": 0,
            "oot": false,
            "time": 0.04782,
            "outputs": []
          }, {
            "name": "most_seqs",
            "cmd": "fasta-most -min 50 < memechip_out\/sample-dna-Klf1.fa 1> $metrics",
            "status": 0,
            "oot": false,
            "time": 0.185613,
            "outputs": []
          }, {
            "name": "center_seqs",
            "cmd": "fasta-center -len 100 < memechip_out\/sample-dna-Klf1.fa 1> memechip_out\/seqs-centered",
            "status": 0,
            "oot": false,
            "time": 0.128835,
            "outputs": [
              {
                "name": "seqs-centered",
                "file": "seqs-centered"
              }
            ]
          }, {
            "name": "shuffle_seqs",
            "cmd": "fasta-dinucleotide-shuffle -f memechip_out\/seqs-centered -t -dinuc 1> memechip_out\/seqs-shuffled",
            "status": 0,
            "oot": false,
            "time": 5.025475,
            "outputs": [
              {
                "name": "seqs-shuffled",
                "file": "seqs-shuffled"
              }
            ]
          }, {
            "name": "sample_seqs",
            "cmd": "fasta-subsample memechip_out\/seqs-centered 600 -rest memechip_out\/seqs-discarded 1> memechip_out\/seqs-sampled",
            "status": 0,
            "oot": false,
            "time": 0.054148,
            "outputs": [
              {
                "name": "seqs-sampled",
                "file": "seqs-sampled"
              }, {
                "name": "seqs-discarded",
                "file": "seqs-discarded"
              }
            ]
          }, {
            "name": "meme",
            "cmd": "meme memechip_out\/seqs-sampled -oc memechip_out\/meme_out -dna -mod zoops -nmotifs 3 -minw 6 -maxw 30 -bfile memechip_out\/background -revcomp -nostatus",
            "status": 0,
            "oot": false,
            "time": 2458.595146,
            "outputs": [
              {
                "name": "MEME HTML",
                "file": "meme_out\/meme.html"
              }, {
                "name": "MEME text",
                "file": "meme_out\/meme.txt"
              }, {
                "name": "MEME XML",
                "file": "meme_out\/meme.xml"
              }
            ]
          }, {
            "name": "dreme",
            "cmd": "dreme -v 1 -oc memechip_out\/dreme_out -p memechip_out\/seqs-centered -n memechip_out\/seqs-shuffled -png",
            "status": 0,
            "oot": false,
            "time": 145.394736,
            "outputs": [
              {
                "name": "DREME HTML",
                "file": "dreme_out\/dreme.html"
              }, {
                "name": "DREME text",
                "file": "dreme_out\/dreme.txt"
              }, {
                "name": "DREME XML",
                "file": "dreme_out\/dreme.xml"
              }
            ]
          }, {
            "name": "centrimo",
            "cmd": "centrimo -noflip -seqlen 500 -verbosity 1 -oc memechip_out\/centrimo_out -bgfile memechip_out\/background memechip_out\/sample-dna-Klf1.fa memechip_out\/meme_out\/meme.xml memechip_out\/dreme_out\/dreme.xml JASPAR_CORE_2009.meme",
            "status": 0,
            "oot": false,
            "time": 42.977827,
            "outputs": [
              {
                "name": "CentriMo HTML",
                "file": "centrimo_out\/centrimo.html"
              }, {
                "name": "Site Counts",
                "file": "centrimo_out\/site_counts.txt"
              }
            ]
          }, {
            "name": "meme_tomtom",
            "cmd": "tomtom -verbosity 1 -oc memechip_out\/meme_tomtom_out -min-overlap 5 -dist pearson -evalue -thresh 1 -no-ssc -bfile memechip_out\/background memechip_out\/meme_out\/meme.xml JASPAR_CORE_2009.meme",
            "status": 0,
            "oot": false,
            "time": 5.716438,
            "outputs": [
              {
                "name": "TOMTOM HTML",
                "file": "meme_tomtom_out\/tomtom.html"
              }, {
                "name": "TOMTOM text",
                "file": "meme_tomtom_out\/tomtom.txt"
              }, {
                "name": "TOMTOM XML",
                "file": "meme_tomtom_out\/tomtom.xml"
              }
            ]
          }, {
            "name": "dreme_tomtom",
            "cmd": "tomtom -verbosity 1 -oc memechip_out\/dreme_tomtom_out -min-overlap 5 -dist pearson -evalue -thresh 1 -no-ssc -bfile memechip_out\/background memechip_out\/dreme_out\/dreme.xml JASPAR_CORE_2009.meme",
            "status": 0,
            "oot": false,
            "time": 2.667074,
            "outputs": [
              {
                "name": "TOMTOM HTML",
                "file": "dreme_tomtom_out\/tomtom.html"
              }, {
                "name": "TOMTOM text",
                "file": "dreme_tomtom_out\/tomtom.txt"
              }, {
                "name": "TOMTOM XML",
                "file": "dreme_tomtom_out\/tomtom.xml"
              }
            ]
          }, {
            "name": "align",
            "cmd": "tomtom -verbosity 1 -text -thresh 0.5 memechip_out\/combined.meme memechip_out\/combined.meme 1> memechip_out\/motif_alignment.txt",
            "status": 0,
            "oot": false,
            "time": 2.0331,
            "messages_file": "align_msgs.txt",
            "outputs": [
              {
                "name": "Motif Alignment",
                "file": "motif_alignment.txt"
              }
            ]
          }
        ],
        "sequence_db": {
          "source": "sample-dna-Klf1.fa",
          "count": 904,
          "file": "sample-dna-Klf1.fa",
          "centrimo_seqlen": 500
        },
        "motif_dbs": [
          {
            "source": "JASPAR_CORE_2009.meme",
            "count": 476
          }
        ],
        "motif_count": {
          "meme": 3,
          "dreme": 5
        },
        "motifs": [
          {
            "prog": "meme",
            "db": -1,
            "id": "1",
            "len": 11,
            "evalue": "8.1e-229",
            "sites": 285,
            "sig": "8.1e-229",
            "pwm": [
              [0.413224, 0.013092, 0.097302, 0.476382], 
              [0.019342, 0.001710, 0.970131, 0.008816], 
              [0.005307, 0.012236, 0.973640, 0.008816], 
              [0.001799, 0.008728, 0.987675, 0.001799], 
              [0.031579, 0.284211, 0.000000, 0.684211], 
              [0.003509, 0.000000, 0.996491, 0.000000], 
              [0.014035, 0.010526, 0.287719, 0.687719], 
              [0.101754, 0.010526, 0.852632, 0.035088], 
              [0.091228, 0.080702, 0.761404, 0.066667], 
              [0.073684, 0.561404, 0.070175, 0.294737], 
              [0.140351, 0.368421, 0.133333, 0.357895]
            ],
            "tomtom_matches": [
              {
                "db": 0,
                "id": "MA0039.2",
                "alt": "Klf4"
              }, {
                "db": 0,
                "id": "MA0270.1",
                "alt": "AFT2"
              }, {
                "db": 0,
                "id": "MA0079.1",
                "alt": "SP1"
              }
            ],
            "centrimo_total_sites": 719,
            "centrimo_sites": [
              0, 0, 0, 0, 0, 1, 2, 1, 2, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 2, 1,
              0, 1, 0, 2, 0, 1, 1, 1, 1, 1, 0, 0, 1, 2, 0, 0, 0, 1, 1, 0, 1,
              2, 0, 0, 0, 0, 1, 1, 1, 1, 0, 3, 2, 0, 1, 0, 2, 0, 0, 0, 0, 0,
              1, 0, 0, 1, 2, 1, 2, 0, 2, 1, 0, 1, 2, 2, 1, 0, 0, 2, 2, 0, 0,
              0, 1, 2, 0, 0, 0, 0, 0, 1, 1, 0, 2, 1, 0, 1, 0, 1, 0, 0, 1, 2,
              0, 0, 1, 0, 2, 2, 3, 0, 0, 0, 1, 0, 1, 1, 0, 2, 2, 1, 1, 2, 0,
              1, 0, 2, 2, 1, 1, 0, 0, 4, 0, 0, 3, 0, 1, 3, 1, 0, 1, 1, 2, 0,
              3, 0, 2, 1, 2, 0, 2, 1, 0, 1, 3, 3, 0, 3, 1, 1, 2, 1, 4, 2, 1,
              1, 0, 0, 3, 1, 4, 1, 2, 1, 2, 1, 0, 0, 3, 0, 4, 1, 0, 1, 1, 1,
              2, 3, 2, 1, 4, 2, 1, 3, 2, 1, 3, 1, 4, 2, 0, 0, 2, 3, 5, 2, 2,
              5, 4, 2, 2, 1, 3, 1, 4, 5, 6, 5, 2, 6, 4, 4, 3, 5, 6, 4, 3, 6,
              5, 5, 3, 4, 7, 3, 9, 6, 1, 2, 10, 2, 9, 5, 4, 4, 10, 3, 6, 4, 5,
              2, 7, 3, 2, 3, 2, 7, 5, 4, 4, 5, 5, 2, 6, 3, 2, 4, 5, 2, 3, 6,
              4, 3, 3, 6, 4, 2, 4, 5, 2, 1, 3, 4, 2, 2, 3, 4, 0, 5, 3, 3, 5,
              2, 1, 4, 0, 3, 2, 2, 0, 3, 1, 0, 3, 1, 3, 1, 2, 0, 0, 2, 1, 3,
              0, 1, 1, 2, 1, 1, 1, 0, 1, 2, 1, 3, 0, 2, 1, 0, 0, 3, 0, 1, 3,
              3, 2, 1, 0, 2, 0, 1, 1, 1, 0, 1, 3, 0, 1, 0, 1, 3, 4, 1, 2, 1,
              2, 1, 0, 0, 1, 2, 0, 1, 1, 1, 0, 1, 0, 0, 4, 1, 1, 0, 1, 2, 0,
              1, 1, 3, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 0,
              0, 1, 0, 0, 0, 0, 3, 0, 1, 1, 1, 0, 0, 0, 0, 2, 1, 0, 0, 0, 0,
              1, 0, 0, 0, 0, 0, 2, 0, 1, 0, 0, 0, 0, 3, 0, 0, 1, 0, 0, 0, 1,
              0, 0, 2, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0,
              0, 0, 1, 2, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 2, 1, 2, 0,
              0, 1, 0, 0, 2, 2, 0
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0039.2",
            "alt": "Klf4",
            "len": 10,
            "evalue": "0.0e-000",
            "sites": 4340,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0039.2&rm=present&collection=CORE",
            "sig": "2.1e-063",
            "pwm": [
              [0.338559, 0.0186862, 0.235701, 0.407054], 
              [0.0202814, 0.00207957, 0.97625, 0.00138787], 
              [0.00322883, 0.00299855, 0.990775, 0.00299884], 
              [0.00322683, 0.00828742, 0.9848, 0.00368682], 
              [0.0636974, 0.441936, 0.00253456, 0.491832], 
              [0.00506979, 0.00345854, 0.983639, 0.00783273], 
              [0.00967668, 0.0184252, 0.501721, 0.470177], 
              [0.0608765, 0.0106114, 0.899685, 0.0288272], 
              [0.0284053, 0.0300209, 0.874841, 0.0667324], 
              [0.0587466, 0.660952, 0.0647591, 0.215542]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 712,
            "centrimo_sites": [
              0, 0, 0, 0, 0, 0, 2, 1, 0, 0, 0, 0, 0, 2, 1, 0, 1, 0, 1, 0, 2,
              0, 0, 2, 1, 2, 1, 1, 1, 2, 0, 1, 1, 1, 1, 3, 0, 0, 0, 1, 0, 1,
              4, 0, 1, 0, 0, 3, 2, 0, 0, 0, 2, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0,
              1, 1, 0, 0, 0, 1, 1, 0, 0, 3, 0, 0, 2, 1, 0, 2, 1, 0, 2, 2, 0,
              0, 1, 2, 2, 0, 0, 1, 2, 1, 1, 0, 2, 0, 1, 0, 1, 1, 0, 0, 1, 2,
              1, 0, 0, 0, 0, 1, 1, 3, 0, 0, 0, 0, 1, 1, 0, 0, 2, 3, 0, 1, 3,
              1, 2, 0, 4, 0, 2, 1, 1, 0, 2, 0, 2, 1, 0, 2, 0, 0, 1, 1, 1, 1,
              0, 2, 0, 3, 0, 1, 2, 1, 2, 1, 0, 5, 1, 1, 0, 1, 3, 2, 2, 1, 2,
              2, 0, 0, 5, 0, 2, 3, 1, 3, 1, 2, 1, 0, 3, 2, 0, 5, 1, 1, 2, 0,
              0, 4, 2, 0, 2, 2, 1, 5, 0, 1, 3, 2, 3, 1, 0, 0, 1, 3, 3, 3, 3,
              3, 5, 3, 3, 0, 4, 1, 4, 5, 7, 4, 3, 5, 3, 3, 4, 3, 7, 6, 0, 4,
              6, 4, 2, 4, 6, 2, 6, 7, 3, 0, 10, 3, 4, 6, 4, 4, 6, 7, 5, 5, 5,
              3, 3, 7, 2, 3, 1, 5, 6, 5, 2, 4, 7, 2, 4, 4, 2, 5, 4, 5, 2, 4,
              6, 3, 3, 5, 4, 2, 6, 0, 3, 2, 2, 1, 3, 3, 2, 2, 3, 1, 5, 3, 3,
              4, 3, 3, 2, 2, 3, 2, 1, 2, 2, 1, 0, 4, 2, 3, 0, 1, 0, 1, 0, 1,
              3, 0, 0, 3, 2, 0, 2, 0, 1, 2, 0, 2, 2, 0, 1, 2, 0, 2, 4, 0, 2,
              2, 3, 3, 0, 0, 1, 1, 1, 1, 1, 1, 1, 2, 2, 0, 1, 3, 2, 2, 1, 1,
              2, 0, 0, 1, 0, 2, 1, 0, 2, 0, 0, 0, 1, 0, 2, 3, 0, 0, 0, 2, 1,
              0, 2, 0, 3, 1, 1, 1, 0, 0, 0, 0, 0, 2, 0, 1, 0, 1, 0, 0, 0, 0,
              1, 0, 1, 0, 0, 0, 2, 1, 0, 1, 0, 1, 0, 0, 0, 2, 1, 0, 1, 1, 2,
              1, 0, 0, 0, 0, 0, 1, 2, 0, 1, 0, 0, 0, 0, 3, 0, 0, 2, 0, 0, 0,
              0, 0, 0, 1, 0, 0, 0, 0, 2, 0, 1, 1, 0, 0, 0, 0, 2, 0, 0, 0, 1,
              0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 2, 4, 2, 1,
              0, 0, 1, 0, 0, 2, 0, 0
            ]
          }, {
            "prog": "dreme",
            "db": -2,
            "id": "MCRCCCW",
            "len": 7,
            "evalue": "2.2e-063",
            "sites": 474,
            "sig": "2.2e-063",
            "pwm": [
              [0.632911, 0.367089, 0.000000, 0.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [0.710970, 0.000000, 0.289030, 0.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [0.508439, 0.000000, 0.000000, 0.491561]
            ],
            "tomtom_matches": [
              {
                "db": 0,
                "id": "MA0039.2",
                "alt": "Klf4"
              }, {
                "db": 0,
                "id": "MA0162.1",
                "alt": "Egr1"
              }, {
                "db": 0,
                "id": "MA0270.1",
                "alt": "AFT2"
              }
            ],
            "centrimo_total_sites": 602,
            "centrimo_sites": [
              1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0,
              0, 0, 0, 2, 0, 0, 2, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0,
              0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 2, 0, 0, 0, 0, 1, 0, 0,
              1, 1, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 2, 1, 1, 1, 0, 0, 1, 1, 0,
              0, 2, 0, 0, 1, 2, 0, 0, 0, 2, 0, 0, 2, 1, 0, 1, 2, 0, 0, 0, 1,
              1, 1, 1, 2, 0, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 2, 2,
              0, 0, 3, 0, 1, 1, 1, 0, 1, 1, 0, 1, 1, 3, 2, 2, 0, 1, 0, 0, 0,
              0, 0, 2, 0, 1, 1, 3, 1, 0, 4, 2, 2, 0, 0, 0, 2, 2, 1, 1, 0, 0,
              1, 1, 2, 3, 0, 0, 1, 1, 1, 0, 2, 1, 1, 1, 0, 0, 1, 1, 1, 2, 0,
              0, 3, 1, 1, 4, 0, 1, 1, 1, 1, 4, 2, 2, 4, 1, 0, 2, 2, 2, 1, 0,
              2, 5, 0, 3, 1, 5, 1, 1, 4, 3, 1, 2, 6, 3, 2, 4, 4, 5, 3, 2, 3,
              5, 3, 4, 4, 9, 1, 6, 3, 2, 1, 8, 3, 3, 4, 3, 4, 3, 4, 2, 2, 10,
              3, 5, 6, 1, 3, 7, 4, 2, 3, 0, 5, 4, 3, 4, 3, 3, 5, 2, 6, 2, 4,
              7, 0, 4, 6, 1, 7, 5, 1, 2, 4, 2, 2, 4, 1, 3, 4, 1, 1, 3, 2, 1,
              5, 3, 2, 2, 2, 1, 3, 1, 4, 0, 3, 2, 2, 1, 2, 4, 1, 3, 1, 3, 1,
              1, 1, 2, 3, 0, 1, 1, 0, 2, 1, 0, 1, 1, 0, 0, 3, 1, 2, 0, 0, 0,
              4, 1, 1, 1, 0, 0, 2, 0, 1, 0, 0, 1, 1, 0, 0, 2, 2, 3, 1, 0, 2,
              2, 2, 0, 1, 1, 0, 1, 1, 1, 1, 0, 2, 0, 1, 1, 0, 1, 0, 2, 1, 1,
              1, 1, 0, 2, 1, 2, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0,
              0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 2, 1, 1, 2, 1, 1, 1, 1, 0, 0, 0,
              0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 2, 1, 0, 0, 1, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 2, 0, 1, 0, 0, 0, 0, 3, 2, 0,
              1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0,
              1, 2, 0, 1, 0, 1, 0, 0, 0, 0, 0
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0140.1",
            "alt": "Tal1::Gata1",
            "len": 18,
            "evalue": "0.0e-000",
            "sites": 2945,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0140.1&rm=present&collection=CORE",
            "sig": "1.3e-045",
            "pwm": [
              [0.135966, 0.451727, 0.210062, 0.202245], 
              [0.0887207, 0.150921, 0.176753, 0.583606], 
              [0.0445042, 0.0618272, 0.6525, 0.241169], 
              [0.0899886, 0.253311, 0.416972, 0.239729], 
              [0.227166, 0.215621, 0.263157, 0.294057], 
              [0.238032, 0.233277, 0.306619, 0.222072], 
              [0.225391, 0.252885, 0.318395, 0.203329], 
              [0.241941, 0.23719, 0.302339, 0.218528], 
              [0.248898, 0.224484, 0.2923, 0.234318], 
              [0.338083, 0.138157, 0.319074, 0.204686], 
              [0.17895, 0.397958, 0.30594, 0.117153], 
              [0.66473, 0.0105269, 0.0125628, 0.31218], 
              [0.00102667, 0.00238419, 0.99658, 8.70259e-06], 
              [0.993528, 0.00238319, 0.000687252, 0.00340159], 
              [0.00544152, 0.00883697, 0.0101949, 0.975528], 
              [0.941193, 0.00204721, 0.00782301, 0.048937], 
              [0.809359, 0.0173367, 0.127765, 0.0455392], 
              [0.186056, 0.187077, 0.544548, 0.0823189]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 693,
            "centrimo_sites": [
              0, 2, 2, 0, 1, 0, 1, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 1, 1, 1,
              1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0,
              0, 2, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 2,
              1, 4, 0, 2, 0, 1, 2, 0, 0, 0, 1, 0, 0, 0, 2, 1, 1, 2, 0, 1, 0,
              1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0,
              1, 0, 2, 1, 2, 1, 1, 0, 0, 1, 0, 0, 0, 3, 1, 0, 0, 1, 3, 1, 1,
              1, 0, 1, 0, 1, 2, 0, 0, 2, 0, 3, 2, 0, 3, 1, 2, 2, 1, 1, 2, 0,
              1, 1, 0, 0, 1, 1, 3, 1, 2, 4, 1, 1, 0, 2, 1, 1, 2, 3, 3, 4, 4,
              1, 0, 2, 2, 0, 3, 1, 0, 2, 1, 2, 2, 1, 1, 2, 1, 1, 2, 1, 6, 4,
              4, 2, 1, 1, 1, 2, 4, 3, 2, 2, 2, 6, 2, 1, 2, 2.5, 7, 2, 4, 0, 9,
              3, 4, 2, 3, 5, 2, 5, 4, 4, 0, 2, 5, 4, 4, 4, 1, 4, 3, 2, 1, 3,
              2, 1, 3, 1, 3, 4, 4, 4, 1, 1, 5, 4, 4, 2, 4, 7, 1, 2, 4, 2, 1,
              3, 2, 0, 2, 3, 6, 4, 6, 4, 1, 0, 1, 2, 2, 2, 7, 3, 3, 5, 3, 4,
              2, 2, 6, 1, 3, 2, 2, 3, 1, 1, 0, 3, 2, 8, 1, 2, 5, 1, 3, 5, 2,
              2, 1, 4, 2, 2, 3, 2, 4, 1, 2, 3, 3, 4, 2, 2, 4, 3, 0, 2, 2, 1,
              4, 1, 1, 0, 1, 3, 0, 7, 1, 1, 2, 0, 6, 2, 1, 0, 1, 2, 1, 0, 2,
              3, 2, 1, 2, 1, 0, 1, 1, 1, 0, 0, 0.5, 3, 0, 0, 1, 1, 0, 0, 0, 0,
              0, 0, 1, 1, 0, 0, 1, 2, 2, 3, 3, 1, 3, 3, 0, 1, 1, 2, 0, 2, 0,
              1, 4, 0, 2, 0, 1, 1, 1, 1, 0, 1, 2, 0, 2, 1.5, 0, 1, 1, 0, 0, 0,
              2, 0, 1, 0, 0, 0, 2, 0, 0, 3, 1, 1, 0, 2, 2, 2, 1, 0, 0, 0, 2,
              0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0,
              0, 0, 2, 2, 0, 3, 3, 1, 0, 1, 3.5, 1, 1, 2, 0, 0, 0, 1, 2, 1, 2,
              1, 1, 0, 0, 1, 0, 0, 2, 1, 1, 0, 1, 1, 0, 1, 2, 0, 0, 1, 1, 0
            ]
          }, {
            "prog": "dreme",
            "db": -2,
            "id": "TTATCW",
            "len": 6,
            "evalue": "1.9e-037",
            "sites": 285,
            "sig": "1.9e-037",
            "pwm": [
              [0.000000, 0.000000, 0.000000, 1.000000], 
              [0.000000, 0.000000, 0.000000, 1.000000], 
              [1.000000, 0.000000, 0.000000, 0.000000], 
              [0.000000, 0.000000, 0.000000, 1.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [0.424561, 0.000000, 0.000000, 0.575439]
            ],
            "tomtom_matches": [
              {
                "db": 0,
                "id": "MA0035.2",
                "alt": "Gata1"
              }, {
                "db": 0,
                "id": "MA0140.1",
                "alt": "Tal1::Gata1"
              }, {
                "db": 0,
                "id": "MA0307.1",
                "alt": "GLN3"
              }, {
                "db": 0,
                "id": "MA0029.1",
                "alt": "Evi1"
              }, {
                "db": 0,
                "id": "MA0309.1",
                "alt": "GZF3"
              }, {
                "db": 0,
                "id": "MA0300.1",
                "alt": "GAT1"
              }
            ],
            "centrimo_total_sites": 497,
            "centrimo_sites": [
              0, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1, 0,
              0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0,
              0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 0, 2, 0, 0, 1, 0, 1, 1, 2, 0, 0, 0, 0, 0, 1, 1, 0, 1, 2, 0,
              0, 0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0,
              1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 2, 2, 1, 0, 1, 0, 0,
              1, 1, 0, 1, 0, 0, 1, 0, 2, 0, 0, 3, 1, 0, 0, 0, 0, 2, 0, 0, 0,
              0, 0, 1, 1, 0, 2, 1, 2, 0, 1, 0, 0, 1, 2, 0, 1, 1, 3, 1, 1, 4,
              0, 0, 1, 2, 2, 0, 3, 1, 1, 0, 2, 2, 1, 0, 0, 2, 3, 0, 0, 1, 4,
              2, 4, 1, 0, 1, 0, 2, 1, 1, 4, 2, 2, 3, 0, 1, 1, 1, 5, 2, 1, 2,
              4, 2, 3, 3, 1, 3, 4, 1, 3, 2, 2, 2, 2, 1, 3, 3, 2, 3, 2, 2, 0,
              3, 4, 1, 0, 2, 3, 3, 4, 3, 1, 2, 3, 1, 4, 2, 4, 1, 1, 3, 4, 1,
              4, 3, 2, 0, 1, 5, 5, 3, 0, 4, 1, 0, 1, 2, 4, 2, 4, 4, 3, 1, 1,
              1, 3, 3, 0, 2, 3, 1, 2, 6, 1, 2, 0, 1, 5, 2, 1, 1, 3, 2, 3, 3,
              2, 3, 2, 3, 0, 2, 6, 1, 2, 2, 0, 0, 0, 3, 2, 1, 0, 0, 0, 1, 1,
              2, 3, 1, 3, 1, 3, 2, 0, 0, 1, 0, 0, 1, 2, 0, 1, 0, 1, 4, 1, 0,
              1, 0, 4, 3, 0, 0, 0, 3, 2, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 2, 1,
              0, 0, 2, 2, 0, 2, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 3, 1, 1,
              1, 0, 2, 0, 0, 0, 0, 1, 1, 0, 0, 3, 2, 0, 0, 1, 3, 1, 1, 3, 0,
              0, 2, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
              0, 0, 1, 1, 0, 1, 2, 0, 0, 1, 1, 0, 1, 0, 1, 1, 3, 0, 1, 1, 0,
              0, 0, 0, 2, 0, 0, 1, 1, 0, 1, 1, 1, 2, 0, 2, 0, 0, 0, 1, 0, 1,
              2, 2, 0, 1, 0, 0, 1, 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1,
              0, 2, 0, 0, 0, 1, 1, 0, 1, 2, 1, 0
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0300.1",
            "alt": "GAT1",
            "len": 8,
            "evalue": "0.0e-000",
            "sites": 100,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0300.1&rm=present&collection=CORE",
            "sig": "2.2e-037",
            "pwm": [
              [0.12884, 0.435452, 0.188175, 0.247534], 
              [0.170086, 0.419824, 0.0501935, 0.359896], 
              [0.000256044, 0.000243457, 0.999244, 0.000256044], 
              [0.999257, 0.000243457, 0.000243457, 0.000256044], 
              [0.000256044, 0.000243457, 0.000243457, 0.999257], 
              [0.999257, 0.000243457, 0.000243457, 0.000256044], 
              [0.999257, 0.000243457, 0.000243457, 0.000256044], 
              [0.0305288, 0.0910616, 0.847881, 0.0305288]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 530,
            "centrimo_sites": [
              0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0,
              1, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1,
              0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 2, 1, 1, 0, 1, 1, 0, 0, 1,
              0, 3, 0, 0, 1, 0, 0, 1, 2, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 0,
              0, 0, 2, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1,
              0, 0, 0, 1, 0, 0, 1, 0, 1, 1, 1, 0, 0, 1, 4, 1, 0, 1, 1, 0, 1,
              1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 2, 1, 0, 0, 1, 1, 2, 1, 0, 0, 0,
              0, 1, 1, 0, 1, 0, 1, 0, 2, 1, 0, 1, 1, 0, 2, 1, 4, 1, 1, 3, 0,
              1, 1, 2, 1, 0, 1, 1, 1, 1, 0, 2, 1, 0, 1, 1, 4, 2, 0, 0, 2, 2,
              4, 1, 0, 1, 0, 2, 2, 1, 3, 4, 2, 5, 0, 0, 4, 1, 3, 2, 2, 1, 4,
              2, 3, 3, 0, 2, 5, 2, 3, 1, 3, 1, 1, 1, 5, 0, 2, 3, 2, 3, 1, 4,
              7, 2, 2, 1, 4, 4, 4, 1, 1, 2, 3, 2, 4, 4, 4, 3, 1, 2, 3, 1, 3,
              4, 1, 1, 2, 4, 4, 2, 0, 2, 1, 0, 1, 1, 3, 1, 3, 3, 3, 3, 1, 2,
              3, 4, 0, 1, 4, 2, 2, 5, 0, 2, 0, 1, 5, 2, 1, 0, 3, 2, 3, 1, 1,
              3, 2, 4, 2, 3, 6, 1, 3, 3, 1, 2, 1, 4, 2, 1, 1, 1, 0, 2, 1, 3,
              2, 2, 2, 1, 3, 2, 0, 1, 1, 1, 0, 1, 3, 0, 1, 0, 1, 4, 2, 0, 2,
              1, 4, 2, 0, 0, 0, 4, 2, 0, 0, 3, 0, 0, 1, 0, 0, 0, 0, 2, 1, 0,
              0, 2, 1, 0, 2, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 2, 2, 3, 1, 2, 1,
              0, 2, 0, 1, 0, 0, 2, 1, 1, 1, 1, 2, 0, 0, 1, 2, 3, 1, 1, 0, 0,
              2, 0, 2, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0,
              1, 0, 2, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 2, 0, 1, 0, 0, 0,
              0, 0, 1, 0, 0, 0, 2, 0, 0, 0, 1, 2, 1, 0, 0, 0, 0, 1, 0, 2, 1,
              0, 1, 1, 0, 0, 0, 0, 2, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0,
              2, 0, 0, 0, 1, 0, 0, 0, 1, 2
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0035.2",
            "alt": "Gata1",
            "len": 11,
            "evalue": "0.0e-000",
            "sites": 4000,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0035.2&rm=present&collection=CORE",
            "sig": "8.8e-037",
            "pwm": [
              [0.355748, 0.140003, 0.310498, 0.193752], 
              [0.177002, 0.408246, 0.308748, 0.106004], 
              [0.695489, 0.0077559, 0.00250603, 0.294249], 
              [6.40734e-06, 6.09235e-06, 0.999981, 6.40734e-06], 
              [0.999981, 6.09235e-06, 6.09235e-06, 6.40734e-06], 
              [0.00675624, 0.00725591, 0.0272554, 0.958732], 
              [0.971732, 6.09235e-06, 0.00150605, 0.0267557], 
              [0.887484, 0.00100607, 0.0957537, 0.015756], 
              [0.199751, 0.170252, 0.573992, 0.056005], 
              [0.357997, 0.22425, 0.339998, 0.0777545], 
              [0.371747, 0.207251, 0.274749, 0.146253]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 756,
            "centrimo_sites": [
              3, 0, 0, 0, 1, 2, 0, 1, 1, 2, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1,
              1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 2, 1, 2, 0, 1, 1, 1,
              0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 3,
              0, 0, 0, 1, 0, 0, 1, 0, 2, 2, 0, 0, 1, 0, 2, 4, 1, 2, 0, 1, 0,
              0, 2, 0, 1, 1, 2, 1, 0, 0, 1, 0, 0, 0, 2, 2, 1, 2, 0, 0, 0, 1,
              1, 1, 0, 3, 1, 1, 0, 0, 3, 1, 0, 3, 0, 3, 1, 2, 0, 1, 1, 2, 0,
              0, 3, 0, 2, 0, 0, 2, 3, 2, 2, 1, 0, 0, 1, 3, 0, 0, 1, 1, 0, 2,
              1, 2, 2, 3, 1, 1, 2, 1, 0, 1, 3, 2, 1, 2, 2, 3, 0, 4, 5, 0, 0,
              3, 1, 1, 4, 1, 2, 2, 4, 2, 1, 0, 0, 4, 1, 4, 0, 1, 4, 3, 5, 0,
              2, 2, 2, 2, 4, 3, 2, 4, 6, 4, 1, 1, 2, 0, 3, 5, 2, 0, 6, 2, 7,
              5, 2, 5, 4, 6, 4, 3, 0, 3, 3, 4, 4, 3, 3, 4, 4, 3, 1, 4, 4, 2,
              2, 1, 5, 4, 6, 6, 1, 1, 3, 4, 3, 6, 4, 3, 2, 1, 4, 5, 1, 4, 6,
              1, 0, 3, 8, 4, 2, 2, 2, 1, 0, 3, 4, 2, 4, 4, 7, 3, 2, 0, 2, 1,
              2, 2, 2, 5, 2, 3, 4, 3, 3, 1, 3, 7, 0, 1, 2, 3, 2, 3, 1, 2, 2,
              0, 5, 1, 6, 3, 3, 2, 2, 2, 2, 1, 2, 3, 1, 1, 1, 4, 1, 4, 3, 3,
              1, 2, 1, 3, 2, 2, 1, 1, 0, 0, 2, 2, 0, 1, 2, 1, 3, 2, 2, 1, 2,
              6, 0, 2, 0, 3, 3, 1, 0, 1, 1, 1, 0, 2, 0, 0, 0, 1, 0, 1, 1, 0,
              5, 0, 1, 1, 0, 2, 1, 1, 1, 1, 1, 0, 1, 2, 1, 1, 2, 1, 1, 1, 2,
              1, 0, 0, 0, 2, 2, 2, 2, 1, 1, 1, 0, 2, 1, 3, 2, 1, 2, 0, 1, 1,
              1, 2, 1, 0, 1, 0, 0, 1, 2, 0, 0, 1, 1, 0, 0, 1, 1, 1, 1, 0, 2,
              1, 0, 1, 3, 1, 0, 1, 0, 1, 0, 2, 0, 1, 2, 1, 0, 0, 0, 2, 0, 1,
              5, 1, 0, 1, 2, 1, 2, 2, 1, 1, 2, 1, 1, 0, 0, 1, 2, 3, 3, 0, 0,
              0, 1, 2, 0, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 2, 0, 2, 1, 2, 0, 2,
              3, 0, 0, 1, 0, 0, 1
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0289.1",
            "alt": "DAL80",
            "len": 7,
            "evalue": "0.0e-000",
            "sites": 100,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0289.1&rm=present&collection=CORE",
            "sig": "9.4e-036",
            "pwm": [
              [0.109058, 0.662947, 0.0595901, 0.168405], 
              [0.000256044, 0.000243457, 0.999244, 0.000256044], 
              [0.999257, 0.000243457, 0.000243457, 0.000256044], 
              [0.000256044, 0.000243457, 0.000243457, 0.999257], 
              [0.999257, 0.000243457, 0.000243457, 0.000256044], 
              [0.908439, 0.0103344, 0.0103344, 0.0708924], 
              [0.0302261, 0.190054, 0.749494, 0.0302261]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 581,
            "centrimo_sites": [
              1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1, 1, 1, 0, 0, 0, 1, 0,
              0, 1, 0, 0, 0, 1, 0, 2, 0, 0, 0, 0, 0, 3, 0, 0, 0, 1, 1, 0, 0,
              1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 2, 0, 1, 1, 1, 0, 0, 0,
              2, 2, 1, 0, 0, 1, 0, 0, 3, 0, 0, 1, 0, 1, 1, 0, 1, 2, 1, 0, 0,
              1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0,
              0, 0, 0, 0, 2, 0, 0, 2, 1, 1, 0, 2, 0, 1, 1, 3, 1, 1, 0, 2, 1,
              1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 2, 1, 0, 0, 1, 2, 2, 1, 1, 0, 0,
              0, 2, 0, 1, 0, 1, 0, 1, 0, 2, 1, 0, 1, 1, 1, 1, 2, 3, 0, 1, 2,
              0, 0, 3, 0, 1, 2, 0, 1, 1, 1, 2, 1, 2, 0, 1, 1, 3, 1, 0, 2, 1,
              3, 1, 2, 0, 2, 0, 2, 3, 3, 3, 5, 5, 0, 0, 4, 0, 2, 2, 3, 0, 4,
              0, 4, 2, 2, 2, 1, 4, 3, 1, 1, 4, 2, 1, 3, 3, 2, 2, 3, 3, 2, 3,
              4, 3, 2, 1, 5, 2, 6, 1, 1, 0, 3, 2, 4, 4, 4, 5, 2, 1, 2, 3, 0,
              7, 3, 0, 1, 2, 6, 2, 2, 2, 4, 2, 0, 2, 0, 2, 3, 2, 3, 5, 2, 2,
              3, 3, 3, 0, 6, 4, 2, 3, 6, 2, 1, 1, 2, 6, 0, 1, 3, 2, 3, 2, 2,
              1, 3, 2, 3, 2, 5, 3, 2, 2, 4, 0, 1, 2, 2, 3, 2, 2, 0, 3, 0, 3,
              3, 1, 0, 1, 2, 2, 2, 2, 0, 2, 1, 0, 3, 0, 0, 0, 1, 0, 4, 1, 1,
              1, 2, 4, 3, 1, 0, 2, 3, 2, 0, 1, 2, 0, 0, 1, 0, 0, 0, 1, 1, 1,
              0, 0, 3, 0, 1, 1, 0, 2, 0, 1, 2, 0, 0, 0, 2, 1, 1, 3, 2, 1, 0,
              1, 1, 3, 0, 1, 0, 1, 3, 1, 0, 2, 2, 0, 0, 1, 0, 4, 2, 0, 2, 1,
              1, 1, 1, 1, 2, 0, 0, 0, 0, 0, 0, 0, 1, 2, 2, 0, 0, 2, 0, 0, 0,
              1, 1, 0, 2, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1,
              0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 1, 2, 0, 1, 0, 0, 0, 1, 2, 1,
              1, 1, 0, 1, 0, 1, 0, 2, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1,
              1, 1, 0, 0, 0, 1, 0, 0, 0, 2, 1
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0309.1",
            "alt": "GZF3",
            "len": 8,
            "evalue": "0.0e-000",
            "sites": 100,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0309.1&rm=present&collection=CORE",
            "sig": "2.7e-032",
            "pwm": [
              [0.180076, 0.389854, 0.0202235, 0.409846], 
              [0.000256044, 0.000243457, 0.999244, 0.000256044], 
              [0.999257, 0.000243457, 0.000243457, 0.000256044], 
              [0.000256044, 0.000243457, 0.000243457, 0.999257], 
              [0.999257, 0.000243457, 0.000243457, 0.000256044], 
              [0.729527, 0.0901535, 0.000243457, 0.180076], 
              [0.0398205, 0.376106, 0.583818, 0.000256044], 
              [0.389866, 0.180064, 0.269974, 0.160096]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 570,
            "centrimo_sites": [
              0, 2, 1, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0,
              1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 2, 0, 1, 0,
              1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 2, 1, 0, 0, 1, 0,
              2, 0, 1, 0, 0, 1, 0, 1, 1, 0, 0, 0, 0, 2, 0, 0, 2, 2, 1, 0, 1,
              0, 1, 1, 2, 0, 1, 0, 1, 0, 0, 0, 2, 0, 1, 0, 0, 1, 0, 0, 0, 0,
              0, 0, 0, 0, 2, 2, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 2, 0, 1, 3, 2,
              0, 0, 0, 0, 1, 1, 0, 0, 1, 2, 2, 0, 0, 2, 0, 3, 1, 0, 0, 0, 0,
              1, 0, 0, 1, 0, 0, 0, 0, 0, 2, 1, 0, 1, 1, 1, 1, 1, 1, 0, 2, 3,
              0, 2, 1, 1, 4, 1, 0, 1, 2, 1, 0, 1, 2, 0, 1, 2, 3, 2, 2, 1, 4,
              0, 2, 1, 0, 1, 2, 3, 2, 3, 4, 6, 1, 0, 2, 0, 0, 2, 3, 1, 2, 0,
              3, 4, 0, 4, 2, 1, 5, 1, 1, 0, 3, 2, 2, 1, 3, 4, 2, 3, 2, 5, 4,
              0, 3, 2, 3, 3, 4, 3, 1, 1, 2, 2, 3, 3, 4, 3, 2, 2, 1, 1, 2, 4,
              6, 2, 2, 1, 4, 5, 3, 3, 1, 2, 0, 1, 1, 0, 3, 3, 2, 3, 6, 2, 2,
              2, 1, 4, 2, 3, 3, 3, 2, 7, 0, 3, 2, 3, 4, 0, 3, 2, 3, 2, 2, 2,
              1, 1, 1, 3, 5, 1, 4, 0, 2, 2, 1, 3, 0, 2, 4, 3, 0, 2, 0, 2, 4,
              3, 0, 1, 2, 1, 2, 3, 0, 0, 1, 1, 1, 1, 2, 0, 2, 1, 0, 3, 3, 2,
              2, 2, 2, 2, 1, 2, 1, 3, 2, 1, 0, 2, 0, 0, 1, 0, 0, 1, 0, 1, 0,
              0, 1, 2, 1, 0, 2, 1, 0, 1, 1, 1, 0, 1, 1, 3, 1, 1, 2, 1, 0, 0,
              1, 1, 1, 0, 1, 1, 1, 3, 0, 2, 1, 0, 1, 1, 0, 2, 3, 1, 0, 3, 2,
              0, 2, 0, 2, 1, 0, 0, 0, 0, 1, 0, 1, 2, 1, 1, 0, 1, 1, 1, 0, 1,
              0, 0, 0, 2, 0, 1, 0, 1, 0, 0, 1, 0, 1, 1, 2, 1, 2, 0, 0, 0, 1,
              0, 2, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 3, 0, 1,
              0, 0, 0, 2, 0, 0, 2, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 2,
              1, 2, 0, 0, 1, 1, 0, 0, 1, 1
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0270.1",
            "alt": "AFT2",
            "len": 8,
            "evalue": "0.0e-000",
            "sites": 100,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0270.1&rm=present&collection=CORE",
            "sig": "6.5e-031",
            "pwm": [
              [0.0801761, 0.449794, 0.269974, 0.200056], 
              [0.699557, 0.000243457, 0.299944, 0.000256044], 
              [0.000256044, 0.999244, 0.000243457, 0.000256044], 
              [0.999257, 0.000243457, 0.000243457, 0.000256044], 
              [0.000256044, 0.999244, 0.000243457, 0.000256044], 
              [0.000256044, 0.999244, 0.000243457, 0.000256044], 
              [0.000256044, 0.999244, 0.000243457, 0.000256044], 
              [0.0910742, 0.424062, 0.272698, 0.212165]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 470,
            "centrimo_sites": [
              0, 0, 2, 0, 0, 0, 3, 0, 0, 2, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1,
              0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 2, 0, 0, 0, 1, 0, 0,
              0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 2, 1,
              0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 2, 1, 1, 1, 0, 2, 2, 1, 1,
              2, 0, 0, 1, 0, 1, 2, 0, 2, 0, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1,
              1, 2, 0, 0, 0, 2, 0, 1, 0, 1, 2, 0, 0, 1, 1, 1, 1, 0, 1, 2, 1,
              1, 0, 1, 2, 0, 1, 0, 0, 1, 0, 1, 3, 0, 0, 2, 0, 2, 0, 0, 1, 2,
              0, 0, 0, 0, 0, 1, 2, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0,
              0, 1, 1, 0, 0, 0, 0, 1, 1, 2, 0, 0, 2, 1, 0, 2, 2, 0, 2, 1, 0,
              1, 4, 0, 2, 3, 2, 1, 2, 1, 3, 0, 1, 1, 2, 0, 0, 1, 2, 1, 1, 1,
              3, 1, 0, 1, 1, 2, 0, 1, 3, 2, 1, 2, 2, 3, 1, 5, 2, 7, 1, 1, 2,
              3, 2, 3, 2, 6, 2, 1, 4, 3, 1, 4, 1, 5, 3, 3, 2, 1, 3, 1, 4, 2,
              6, 4, 3, 0, 4, 0, 1, 3, 1, 2, 6, 2, 2, 4, 4, 2, 2, 2, 2, 1, 3,
              1, 1, 2, 3, 3, 3, 0, 1, 0, 2, 5, 2, 0, 1, 2, 0, 1, 0, 2, 1, 1,
              0, 2, 2, 2, 1, 3, 1, 2, 2, 2, 2, 1, 1, 1, 5, 3, 3, 0, 0, 1, 0,
              0, 1, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1,
              0, 2, 0, 1, 1, 3, 0, 0, 1, 0, 2, 0, 0, 2, 1, 0, 3, 3, 0, 1, 0,
              2, 2, 1, 0, 0, 4, 1, 0, 0, 1, 0, 0, 1, 2, 0, 0, 0, 0, 1, 0, 3,
              0, 2, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0,
              0, 0, 0, 0, 2, 1, 2, 0, 0, 1, 1, 0, 0, 0, 1, 0, 0, 1, 1, 0, 1,
              0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 1,
              0, 1, 1, 2, 1, 1, 1, 0, 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 2, 0, 2,
              0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 1, 2, 0,
              1, 2, 1, 0, 0, 0, 1, 0, 0, 0
            ]
          }, {
            "prog": "meme",
            "db": -1,
            "id": "2",
            "len": 8,
            "evalue": "3.2e-026",
            "sites": 176,
            "sig": "3.2e-026",
            "pwm": [
              [0.008594, 0.542542, 0.184588, 0.264276], 
              [0.001456, 0.001385, 0.001385, 0.995774], 
              [0.000000, 0.000000, 0.000000, 1.000000], 
              [1.000000, 0.000000, 0.000000, 0.000000], 
              [0.000000, 0.000000, 0.000000, 1.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [0.397727, 0.000000, 0.011364, 0.590909], 
              [0.120774, 0.279794, 0.387748, 0.211684]
            ],
            "tomtom_matches": [
              {
                "db": 0,
                "id": "MA0035.2",
                "alt": "Gata1"
              }, {
                "db": 0,
                "id": "MA0140.1",
                "alt": "Tal1::Gata1"
              }, {
                "db": 0,
                "id": "MA0300.1",
                "alt": "GAT1"
              }, {
                "db": 0,
                "id": "MA0309.1",
                "alt": "GZF3"
              }, {
                "db": 0,
                "id": "MA0029.1",
                "alt": "Evi1"
              }, {
                "db": 0,
                "id": "MA0307.1",
                "alt": "GLN3"
              }, {
                "db": 0,
                "id": "MA0289.1",
                "alt": "DAL80"
              }
            ],
            "centrimo_total_sites": 504,
            "centrimo_sites": [
              0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0,
              1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 1,
              0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 3, 0, 0, 1, 0, 1, 1, 2, 0, 0, 1, 0, 0, 1, 1, 1, 2, 0, 0, 0,
              0, 0, 2, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1,
              0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 2, 2, 1, 0, 1, 1, 0, 1,
              1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 3, 2, 0, 0, 0, 1, 2, 0, 0, 0, 0,
              0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 2, 1, 1, 1, 4, 1, 0, 4, 0,
              1, 1, 3, 1, 0, 3, 1, 1, 1, 2, 3, 2, 0, 1, 2, 4, 1, 0, 1, 3, 1,
              4, 1, 0, 1, 0, 3, 2, 2, 3, 4, 2, 4, 0, 0, 0, 1, 4, 1, 0, 1, 5,
              2, 3, 3, 0, 3, 5, 1, 3, 2, 3, 1, 1, 1, 4, 1, 2, 3, 2, 3, 0, 5,
              5, 2, 1, 1, 2, 4, 5, 3, 1, 2, 3, 2, 4, 4, 4, 2, 1, 3, 4, 1, 3,
              4, 2, 0, 2, 4, 5, 2, 0, 4, 1, 0, 1, 1, 3, 1, 4, 5, 3, 2, 1, 0,
              3, 4, 0, 2, 4, 2, 2, 6, 0, 2, 0, 1, 5, 2, 0, 0, 4, 2, 3, 1, 1,
              3, 2, 3, 1, 2, 6, 1, 3, 3, 0, 1, 1, 4, 2, 1, 1, 1, 0, 1, 1, 2,
              2, 2, 3, 1, 2, 1, 0, 0, 1, 0, 0, 1, 2, 0, 0, 0, 1, 4, 1, 1, 2,
              0, 4, 1, 0, 0, 0, 4, 2, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0,
              0, 2, 2, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 1, 0, 2, 1, 3, 1, 1, 1,
              0, 2, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 0, 0, 1, 1, 2, 1, 2, 0, 0,
              2, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0,
              0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 2, 0, 1, 0, 0, 0,
              0, 0, 2, 0, 0, 0, 2, 0, 0, 0, 1, 2, 0, 1, 0, 0, 0, 1, 1, 1, 2,
              0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0,
              2, 0, 0, 0, 1, 0, 0, 0, 1, 1
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0307.1",
            "alt": "GLN3",
            "len": 5,
            "evalue": "0.0e-000",
            "sites": 100,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0307.1&rm=present&collection=CORE",
            "sig": "4.6e-025",
            "pwm": [
              [0.000256044, 0.000243457, 0.999244, 0.000256044], 
              [0.999257, 0.000243457, 0.000243457, 0.000256044], 
              [0.000256044, 0.000243457, 0.000243457, 0.999257], 
              [0.739517, 0.000243457, 0.000243457, 0.259996], 
              [0.609647, 0.000243457, 0.269974, 0.120136]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 805,
            "centrimo_sites": [
              3, 0, 2, 2, 1, 1, 0, 0, 1, 0, 1, 0, 4, 0, 0, 2, 0, 0, 1, 1, 0,
              0, 1, 0, 1, 0, 0, 2, 0, 3, 1, 0, 0, 0, 2, 3, 0, 2, 0, 0, 1, 0,
              0, 0, 1, 0, 0, 0, 0, 2, 0, 0, 0, 1, 1, 2, 2, 0, 3, 1, 0, 0, 1,
              4, 3, 1, 1, 2, 0, 1, 1, 0, 3, 0, 0, 0, 0, 0, 1, 0, 2, 2, 2, 1,
              0, 0, 0, 1, 1, 0, 2, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0, 1, 1, 0,
              1, 1, 1, 2, 1, 1, 1, 0, 3, 2, 0, 2, 0, 0, 0, 0, 2, 2, 2, 2, 0,
              1, 2, 0, 0, 3, 0, 1, 0, 1, 2, 0, 2, 0, 0, 0, 1, 1, 3, 1, 0, 1,
              1, 0, 0, 0, 3, 2, 2, 0, 2, 4, 1, 3, 1, 2, 2, 1, 2, 1, 2, 2, 2,
              3, 0, 1, 2, 0, 1, 5, 1, 1, 1, 1, 1, 1, 0, 1, 1, 2, 3, 1, 0, 1,
              2, 4, 1, 1, 1, 2, 3, 1, 2, 2, 3, 4, 5, 1, 1, 2, 1, 5, 4, 2, 3,
              5, 2, 9, 4, 4, 2, 1, 6, 3, 2, 0, 2, 4, 2, 3, 2, 3, 4, 4, 4, 4,
              4, 5, 4, 3, 0, 5, 2, 2, 1, 0, 0, 4, 2, 5, 7, 3, 3, 3, 1, 2, 5,
              1, 5, 7, 0, 1, 3, 7, 3, 3, 0, 2, 1, 0, 3, 4, 4, 3, 4, 4, 4, 4,
              2, 3, 2, 2, 1, 5, 3, 1, 2, 7, 3, 1, 0, 0, 9, 0, 3, 3, 1, 3, 4,
              3, 0, 3, 2, 4, 1, 7, 3, 3, 1, 7, 0, 2, 1, 3, 3, 2, 0, 0, 3, 0,
              3, 5, 3, 1, 2, 2, 2, 3, 1, 0, 3, 1, 1, 4, 2, 1, 5, 3, 0, 4, 2,
              2, 4, 3, 3, 2, 1, 1, 2, 3, 2, 1, 1, 3, 0, 0, 2, 0, 2, 1, 4, 2,
              1, 2, 1, 7, 0, 1, 2, 1, 1, 0, 2, 2, 1, 2, 0, 1, 1, 1, 3, 2, 2,
              1, 3, 2, 2, 1, 1, 0, 1, 4, 1, 0, 3, 2, 1, 0, 2, 1, 7, 3, 3, 3,
              1, 2, 2, 1, 3, 3, 0, 1, 1, 0, 1, 0, 0, 1, 1, 3, 1, 0, 1, 0, 0,
              1, 1, 2, 0, 3, 0, 2, 2, 0, 1, 1, 1, 0, 1, 0, 1, 2, 1, 1, 1, 1,
              0, 0, 3, 3, 0, 1, 1, 3, 0, 2, 2, 2, 1, 4, 0, 4, 0, 0, 0, 3, 2,
              2, 1, 2, 0, 1, 0, 1, 0, 3, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 0,
              1, 0, 2, 1, 1, 0, 2, 1, 1, 1, 4, 2, 2
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0037.1",
            "alt": "GATA3",
            "len": 6,
            "evalue": "0.0e-000",
            "sites": 63,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0037.1&rm=present&collection=CORE",
            "sig": "1.9e-015",
            "pwm": [
              [0.396602, 0.222256, 0.0637776, 0.317363], 
              [0.000406181, 0.0162341, 0.982954, 0.000406181], 
              [0.967126, 0.000386212, 0.0162341, 0.016254], 
              [0.000406181, 0.000386212, 0.0796254, 0.919582], 
              [0.618473, 0.0162341, 0.0637776, 0.301515], 
              [0.238124, 0.0479297, 0.586757, 0.127189]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 858,
            "centrimo_sites": [
              3, 3, 1, 1, 2, 1, 2, 0, 3, 2, 0, 2, 0, 0, 2, 2, 0, 3, 2, 0, 1,
              0, 1, 3, 0, 3, 0, 1, 1, 2, 1, 2, 1, 1, 2, 1, 0, 2, 0, 2, 1, 3,
              0, 1, 2, 1, 1, 1, 1, 0, 4, 1, 0, 2, 2, 2, 0, 3, 2, 1, 0, 1, 1,
              5, 2, 2, 0, 2, 2, 0, 1, 0, 0, 2, 0, 2, 1, 0, 0, 1, 1, 4, 3, 1,
              1, 0, 0, 0, 0, 0, 3, 1, 2, 2, 1, 1, 0, 1, 0, 2, 0, 1, 0, 0, 0,
              2, 4, 5, 2, 1, 2, 4, 1, 1, 4, 2, 2, 2, 3, 1, 1, 1, 1, 3, 2, 3,
              3, 1, 0, 2, 1, 2, 2, 1, 6, 0, 4, 5, 1, 0, 0, 2, 0, 1, 2, 0, 2,
              2, 1, 2, 2, 2, 3, 1, 1, 1, 2, 3, 0, 1, 1, 3, 1, 1, 4, 3, 2, 3,
              1, 0, 3, 1, 3, 3, 3, 2, 1, 0, 0, 1, 0, 2, 1, 3, 3, 3, 3, 2, 2,
              3, 2, 3, 1, 3, 0, 5, 0, 0, 4, 3, 4, 2, 4, 1, 2, 2, 3, 3, 3, 2,
              5, 2, 3, 8, 0, 4, 3, 2, 8, 2, 0, 3, 4, 3, 3, 0, 3, 4, 6, 0, 1,
              1, 5, 2, 1, 5, 0, 2, 4, 3, 2, 2, 8, 4, 5, 4, 5, 0, 1, 3, 3, 2,
              3, 1, 5, 1, 5, 3, 6, 2, 1, 1, 1, 2, 1, 6, 4, 4, 6, 3, 1, 6, 1,
              3, 2, 0, 2, 2, 2, 1, 1, 3, 4, 2, 1, 2, 3, 3, 1, 1, 1, 1, 3, 4,
              1, 2, 3, 2, 3, 3, 7, 3, 4, 1, 4, 0, 0, 5, 1, 2, 3, 2, 2, 1, 1,
              3, 7, 4, 2, 2, 1, 5, 0, 3, 3, 2, 0, 2, 1, 2, 4, 1, 1, 2, 1, 1,
              2, 0, 2, 1, 1, 2, 1, 4, 1, 2, 1, 3, 1, 0, 2, 0, 1, 0, 2, 1, 1,
              0, 2, 1, 2, 0, 3, 3, 0, 1, 0, 1, 1, 1, 0, 2, 1, 0, 2, 0, 1, 0,
              4, 0, 3, 2, 0, 0, 1, 2, 1, 2, 2, 2, 0, 1, 0, 1, 2, 2, 0, 4, 2,
              0, 2, 0, 2, 4, 0, 0, 1, 0, 1, 1, 1, 2, 2, 2, 1, 1, 2, 1, 1, 1,
              0, 2, 0, 2, 3, 2, 1, 0, 3, 3, 1, 1, 0, 0, 1, 0, 2, 0, 1, 4, 1,
              2, 1, 3, 1, 1, 1, 3, 1, 2, 1, 0, 1, 3, 1, 0, 1, 0, 0, 1, 0, 2,
              1, 1, 1, 3, 2, 1, 1, 0, 2, 0, 2, 2, 1, 0, 1, 0, 0, 0, 1, 2, 1,
              2, 1, 2, 2, 1, 0, 1, 0, 2, 2, 1, 2
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0450.1",
            "alt": "hkb",
            "len": 9,
            "evalue": "0.0e-000",
            "sites": 32,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0450.1&rm=present&collection=CORE",
            "sig": "4.0e-015",
            "pwm": [
              [0.0942564, 0.00075919, 0.561507, 0.343478], 
              [0.25002, 0.00075919, 0.748423, 0.000798442], 
              [0.000798442, 0.00075919, 0.997644, 0.000798442], 
              [0.000798442, 0.00075919, 0.997644, 0.000798442], 
              [0.000798442, 0.997644, 0.00075919, 0.000798442], 
              [0.000798442, 0.00075919, 0.997644, 0.000798442], 
              [0.000798442, 0.00075919, 0.0942171, 0.904225], 
              [0.000798442, 0.00075919, 0.966491, 0.0319511], 
              [0.748462, 0.0942171, 0.0630645, 0.0942564]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 308,
            "centrimo_sites": [
              0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1,
              2, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1,
              1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0,
              1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 1, 0, 1, 0, 1, 0, 1, 1, 0,
              0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 1, 0, 0,
              1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 2, 0, 0,
              1, 0, 1, 2, 1, 1, 1, 1, 0, 1, 0, 1, 1, 2, 0, 1, 0, 0, 1, 0, 0,
              0, 0, 0, 3, 1, 0, 0, 0, 1, 1, 0, 2, 0, 0, 1, 1, 0, 1, 0, 0, 1,
              1, 0, 0, 0, 1, 1, 0, 1, 0, 2, 0, 2, 0, 0, 0, 0, 0, 3, 1, 0, 0,
              0, 0, 1, 1, 1, 0, 1, 1, 1, 2, 0, 0, 1, 2, 1, 0, 2, 0, 1, 0, 1,
              3, 0, 2, 3, 0, 0, 1, 0, 0, 3, 0, 1, 3, 0, 0, 2, 2, 0, 4, 0, 3,
              0, 3, 1, 1, 2, 0, 2, 1, 4, 0, 2, 3, 3, 2, 5, 2, 2, 1, 2, 3, 1,
              3, 0, 1, 2, 2, 1, 0, 1, 2, 2, 1, 1, 0, 0, 0, 1, 3, 2, 1, 2, 1,
              2, 2, 1, 2, 0, 1, 3, 1, 0, 1, 0, 1, 2, 0, 2, 2, 1, 2, 0, 3, 1,
              1, 1, 0, 1, 1, 0, 0, 2, 1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0,
              1, 2, 0, 1, 1, 0, 0, 0, 1, 3, 3, 2, 1, 0, 2, 1, 0, 2, 0, 1, 1,
              0, 3, 3, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1,
              2, 1, 0, 0, 0, 2, 1, 2, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0,
              0, 0, 0, 1, 1, 0, 1, 0, 2, 0, 0, 0, 0, 1, 0, 1, 0, 0, 2, 0, 0,
              0, 0, 1, 0, 0, 0, 2, 1, 1, 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 1, 0, 0, 0, 1, 2, 2, 0, 1, 0, 0, 2, 0, 0, 0, 0, 0, 0, 2, 1,
              0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0,
              0, 0, 0, 2, 0, 0, 1, 0, 0
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0199.1",
            "alt": "Optix",
            "len": 5,
            "evalue": "0.0e-000",
            "sites": 27,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0199.1&rm=present&collection=CORE",
            "sig": "5.4e-010",
            "pwm": [
              [0.000945756, 0.185401, 0.000899262, 0.812754], 
              [0.000945756, 0.000899262, 0.997209, 0.000945756], 
              [0.997256, 0.000899262, 0.000899262, 0.000945756], 
              [0.000945756, 0.000899262, 0.000899262, 0.997256], 
              [0.960355, 0.000899262, 0.0377996, 0.000945756]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 509,
            "centrimo_sites": [
              0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 2, 0, 0, 0, 0, 0, 0, 0,
              0, 1, 0, 2, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0,
              0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 2, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0,
              1, 1, 0, 2, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0,
              0, 1, 1, 0, 2, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 2, 0, 0, 0, 0, 0,
              0, 0, 3, 0, 3, 0, 3, 3, 0, 0, 0, 2, 0, 0, 0, 1, 0, 1, 1, 1, 0,
              1, 2, 0, 0, 0, 3, 0, 0, 1, 0, 0, 0, 1, 1, 1, 2, 3, 0, 1, 1, 0,
              1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0,
              2, 1, 0, 1, 3, 0, 0, 1, 1, 1, 0, 1, 2, 0, 0, 1, 0, 0, 2, 2, 1,
              3, 0, 2, 0, 2, 0, 1, 0, 0, 1, 3, 0, 1, 3, 0, 1, 2, 0, 1, 2, 1,
              1, 6, 2, 4, 3, 2, 0, 1, 1, 4, 2, 1, 0, 2, 1, 4, 1, 2, 2, 1, 3,
              2, 3, 1, 0, 2, 0, 5, 2, 2, 0, 0, 1, 3, 1, 1, 4, 1, 0, 1, 1, 1,
              3, 2, 2, 1, 1, 4, 2, 0, 4, 1, 1, 2, 2, 1, 4, 2, 2, 2, 3, 0, 2,
              1, 1, 4, 1, 0, 1, 0, 2, 5, 3, 2, 2, 1, 2, 2, 1, 1, 1, 1, 3, 1,
              2, 1, 1, 0, 2, 1, 4, 0, 0, 1, 1, 2, 0, 3, 4, 1, 1, 3, 2, 1, 3,
              2, 2, 4, 1, 2, 2, 3, 0, 1, 2, 1, 0, 1, 2, 3, 1, 2, 1, 2, 4, 1,
              5, 0, 0, 2, 2, 0, 2, 2, 2, 0, 0, 4, 1, 1, 2, 0, 0, 1, 0, 1, 2,
              0, 1, 4, 0, 1, 1, 2, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 2, 0, 2,
              3, 0, 2, 1, 1, 0, 0, 1, 2, 1, 2, 1, 2, 0, 0, 0, 1, 1, 1, 0, 0,
              0, 2, 1, 2, 2, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 3, 1, 0, 0,
              1, 1, 0, 5, 0, 1, 1, 1, 2, 1, 2, 1, 1, 0, 0, 1, 1, 2, 0, 1, 2,
              0, 1, 0, 3, 3, 1, 3, 2, 2, 1, 0, 0, 0, 0, 1, 1, 1, 0, 1, 1, 2,
              1, 2, 3, 3, 0, 1, 0, 0, 2, 1, 1, 0, 1, 1, 2, 2, 0, 0, 0, 0, 0,
              0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 3, 0
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0334.1",
            "alt": "MET32",
            "len": 7,
            "evalue": "0.0e-000",
            "sites": 100,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0334.1&rm=present&collection=CORE",
            "sig": "2.8e-006",
            "pwm": [
              [0.339916, 0.459784, 0.100144, 0.100156], 
              [0.110146, 0.0501935, 0.769474, 0.0701861], 
              [0.000256044, 0.999244, 0.000243457, 0.000256044], 
              [0.000256044, 0.999244, 0.000243457, 0.000256044], 
              [0.938712, 0.0305162, 0.000243457, 0.0305288], 
              [0.000256044, 0.989254, 0.000243457, 0.0102461], 
              [0.639617, 0.150094, 0.120124, 0.0901661]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 804,
            "centrimo_sites": [
              0, 1, 0, 0, 0, 1, 2, 2, 2, 2, 1, 3, 1, 1, 1, 0, 3, 0, 1, 2, 3,
              4, 1, 2, 0, 1, 0, 1, 1, 0, 5, 0, 0, 1, 1, 0, 1, 2, 1, 0, 0, 3,
              0, 2, 1, 0, 1, 1, 0, 2, 4, 0, 0, 0, 1, 1, 2, 1, 3, 1, 1, 1, 1,
              0, 0, 2, 1, 0, 2, 2, 1, 1, 0, 3, 2, 1, 1, 1, 1, 0, 4, 3, 0, 2,
              2, 2, 3, 3, 2, 3, 2, 1, 1, 2, 1, 2, 1, 0, 2, 1, 0, 1, 0, 2, 1,
              2, 1, 2, 1, 0, 1, 0, 0, 3, 2, 1, 3, 0, 0, 1, 1, 2, 0, 0, 1, 2,
              2, 0, 2, 0, 2, 2, 1, 2, 1, 2, 0, 1, 3, 3, 1, 3, 0, 1, 1, 3, 1,
              1, 0, 2, 2, 3, 0, 0, 1, 1, 1, 4, 0, 2, 1, 0, 2, 3, 5, 2, 2, 3,
              2, 1, 0, 1, 1, 4, 1, 0, 3, 2, 0, 1, 1, 0, 1, 1, 1, 1, 1, 2, 0,
              0, 2, 2, 1, 0, 5, 2, 1, 1, 3, 4, 3, 3, 1, 0, 4, 2, 1, 3, 2, 2,
              2, 1, 1, 1, 3, 0, 2, 1, 1, 2, 2, 0, 3, 2, 6, 0, 1, 2, 1, 4, 2,
              5, 1, 3, 2, 1, 2, 2, 7, 3, 3, 3, 3, 4, 1, 3, 3, 5, 2, 6, 2, 2,
              0, 5, 2, 3, 5, 5, 2, 1, 2, 4, 2, 0, 3, 5, 2, 2, 2, 4, 1, 1, 2,
              3, 4, 1, 4, 2, 2, 1, 5, 0, 2, 3, 4, 2, 3, 3, 3, 1, 4, 0, 3, 2,
              0, 3, 2, 2, 0, 3, 3, 1, 3, 4, 0, 1, 3, 4, 3, 1, 1, 1, 1, 1, 0,
              1, 1, 2, 2, 0, 1, 1, 1, 0, 2, 1, 2, 1, 1, 2, 1, 1, 3, 1, 1, 2,
              2, 2, 1, 0, 3, 2, 1, 2, 2, 1, 1, 6, 0, 1, 0, 1, 5, 2, 1, 1, 0,
              1, 2, 0, 3, 0, 2, 1, 2, 1, 1, 3, 2, 1, 0, 3, 4, 2, 0, 4, 1, 2,
              2, 0, 1, 1, 4, 5, 4, 0, 1, 0, 1, 2, 4, 2, 1, 2, 1, 1, 1, 3, 1,
              2, 1, 1, 0, 4, 2, 3, 2, 1, 2, 1, 3, 3, 1, 0, 0, 1, 2, 1, 0, 0,
              0, 0, 0, 0, 1, 2, 2, 3, 0, 0, 4, 0, 0, 3, 0, 2, 1, 0, 2, 0, 0,
              3, 0, 6, 2, 2, 1, 1, 0, 1, 2, 2, 2, 0, 1, 4, 0, 2, 1, 2, 2, 1,
              2, 1, 1, 1, 3, 1, 1, 1, 0, 1, 3, 1, 1, 1, 1, 1, 3, 2, 1, 2, 1,
              7, 2, 2, 2, 1, 4, 3, 2, 2, 2, 1
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0079.1",
            "alt": "SP1",
            "len": 10,
            "evalue": "0.0e-000",
            "sites": 8,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0079.1&rm=present&collection=CORE",
            "sig": "5.5e-006",
            "pwm": [
              [0.126621, 0.126465, 0.496836, 0.250078], 
              [0.250078, 0.126465, 0.496836, 0.126621], 
              [0.0031642, 0.00300864, 0.990663, 0.0031642], 
              [0.0031642, 0.00300864, 0.990663, 0.0031642], 
              [0.0031642, 0.620293, 0.249922, 0.126621], 
              [0.250078, 0.00300864, 0.496836, 0.250078], 
              [0.0031642, 0.126465, 0.620293, 0.250078], 
              [0.0031642, 0.00300864, 0.743749, 0.250078], 
              [0.126621, 0.126465, 0.743749, 0.0031642], 
              [0.250078, 0.00300864, 0.00300864, 0.743905]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 780,
            "centrimo_sites": [
              0, 1, 0, 3, 2, 2, 2, 1, 1, 2, 1, 0, 0, 0, 1, 1, 2, 0, 0, 0, 2,
              2, 2, 1, 0, 1, 2, 3, 3, 0, 1, 2, 1, 2, 2, 2, 1, 0, 0, 1, 2, 1,
              4, 0, 1, 0, 1, 1, 2, 1, 1, 2, 1, 1, 0, 1, 0, 1, 1, 4, 1, 2, 0,
              0, 2, 3, 0, 2, 4, 3, 2, 2, 5, 2, 1, 1, 0, 1, 1, 1, 0, 1, 2, 0,
              4, 1, 2, 2, 0, 1, 3, 2, 3, 0, 1, 0, 1, 1, 1, 1, 6, 0, 0, 1, 2,
              4, 1, 2, 1, 0, 3, 1, 1, 1, 0, 1, 1, 0, 1, 0, 3, 2, 3, 1, 1, 1,
              0, 1, 2, 1, 5, 2, 4, 0, 3, 0, 1, 2, 3, 0, 3, 1, 1, 2, 2, 3, 2,
              1, 0, 2, 1, 0, 0, 2, 1, 1, 0, 3, 2, 2, 1, 0, 2, 2, 4, 0, 2, 2,
              4, 2, 2, 0, 2, 3, 1, 2, 3, 2, 1, 3, 4, 2, 3, 1, 0, 2, 0, 1, 3,
              0, 3, 1, 1, 3, 2, 2, 1, 2, 2, 2, 2, 3, 6, 0, 3, 0, 3, 2, 2, 0,
              2, 3, 1, 2, 1, 4, 0, 4, 2, 2, 1, 2, 3, 5, 4, 4, 1, 3, 1, 1, 4,
              1, 1, 4, 1, 2, 0, 2, 3, 5, 2, 4, 3, 2, 4, 4, 2, 4, 2, 2, 5, 6,
              4, 3, 2, 3, 2, 2, 2, 3, 2, 2, 4, 2, 2, 2, 3, 0, 2, 2, 1, 1, 1,
              4, 1, 1, 1, 5, 1, 4, 1, 2, 1, 3, 4, 2, 2, 2, 3, 3, 0, 3, 2, 1,
              3, 2, 2, 3, 1, 2, 0, 1, 0, 1, 2, 1, 0, 1, 0, 1, 0, 2, 1, 0, 1,
              3, 2, 3, 0, 2, 1, 0, 1, 2, 1, 0, 2, 0, 1, 3, 1, 2, 1, 2, 2, 4,
              2, 3, 1, 1, 0, 3, 1, 1, 0, 2, 1, 2, 1, 2, 2, 2, 2, 4, 2, 1, 3,
              4, 2, 1, 1, 0, 0, 5, 1, 1, 0, 1, 2, 3, 0, 4, 2, 2, 1, 2, 1, 1,
              1, 1, 1, 1, 0, 2, 2, 0, 1, 0, 0, 1, 1, 2, 1, 0, 1, 1, 2, 2, 1,
              1, 0, 1, 3, 0, 1, 3, 3, 2, 1, 2, 1, 0, 0, 2, 1, 1, 0, 1, 2, 1,
              4, 0, 1, 1, 1, 0, 0, 2, 0, 4, 2, 2, 1, 2, 0, 0, 1, 2, 2, 4, 3,
              1, 1, 1, 2, 2, 0, 1, 0, 1, 0, 1, 3, 0, 0, 0, 4, 1, 1, 0, 2, 0,
              1, 1, 1, 2, 0, 3, 0, 3, 1, 1, 1, 1, 1, 2, 2, 4, 1, 0, 4, 2, 0,
              1, 0, 1, 1, 0, 2, 1, 1
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0036.1",
            "alt": "GATA2",
            "len": 5,
            "evalue": "0.0e-000",
            "sites": 53,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0036.1&rm=present&collection=CORE",
            "sig": "2.0e-005",
            "pwm": [
              [0.245304, 0.24528, 0.339442, 0.169974], 
              [0.000482674, 0.0946213, 0.904413, 0.000482674], 
              [0.979767, 0.000458945, 0.0192914, 0.000482674], 
              [0.000482674, 0.000458945, 0.000458945, 0.998599], 
              [0.471292, 0.132285, 0.282945, 0.113477]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 866,
            "centrimo_sites": [
              2, 4, 1, 2, 1, 6, 1, 0, 2, 1, 0, 2, 3, 5, 0, 3, 3, 2, 1, 1, 2,
              0, 1, 3, 2, 2, 1, 0, 3, 0, 2, 1, 2, 1, 2, 3, 4, 2, 3, 4, 1, 4,
              1, 1, 1, 0, 0, 0, 3, 0, 1, 5, 1, 1, 0, 4, 1, 3, 1, 1, 2, 1, 0,
              3, 2, 1, 2, 1, 0, 2, 1, 3, 1, 1, 3, 0, 5, 1, 0, 2, 2, 3, 2, 3,
              1, 2, 1, 2, 1, 0, 0, 3, 0, 1, 2, 0, 2, 3, 3, 2, 2, 0, 1, 1, 3,
              0, 0, 1, 2, 2, 1, 2, 1, 2, 5, 3, 1, 1, 3, 3, 4, 2, 2, 2, 3, 0,
              2, 1, 1, 4, 2, 1, 1, 2, 3, 1, 0, 2, 1, 0, 0, 2, 2, 2, 2, 3, 1,
              1, 0, 1, 1, 2, 2, 1, 1, 0, 2, 3, 2, 2, 3, 1, 3, 1, 1, 4, 2, 1,
              2, 2, 1, 1, 2, 4, 4, 2, 0, 0, 1, 2, 4, 1, 1, 1, 4, 1, 3, 2, 1,
              3, 1, 6, 3, 1, 4, 3, 2, 2, 3, 3, 4, 3, 2, 4, 3, 7, 3, 2, 2, 2,
              2, 3, 3, 5, 2, 0, 5, 0, 5, 2, 3, 5, 2, 5, 3, 4, 3, 4, 1, 4, 2,
              1, 2, 3, 1, 3, 1, 6, 0, 1, 2, 2, 0, 4, 5, 3, 1, 3, 5, 1, 0, 2,
              2, 3, 3, 2, 2, 3, 0, 4, 0, 2, 0, 1, 3, 0, 4, 3, 2, 1, 2, 3, 1,
              0, 3, 3, 1, 4, 4, 3, 0, 4, 5, 1, 1, 1, 1, 1, 1, 0, 0, 2, 3, 3,
              2, 2, 1, 3, 4, 2, 2, 2, 2, 1, 0, 2, 0, 3, 0, 0, 4, 3, 3, 0, 3,
              3, 3, 2, 1, 0, 1, 2, 2, 2, 3, 2, 3, 2, 1, 3, 3, 3, 2, 5, 2, 2,
              3, 2, 1, 2, 4, 1, 1, 1, 3, 3, 2, 1, 1, 1, 1, 1, 1, 0, 2, 3, 1,
              2, 2, 2, 1, 1, 2, 2, 0, 1, 0, 3, 0, 0, 1, 2, 0, 0, 2, 1, 1, 2,
              0, 0, 1, 2, 3, 1, 0, 3, 1, 1, 1, 1, 2, 0, 0, 1, 3, 2, 0, 2, 2,
              2, 3, 0, 2, 1, 0, 0, 3, 0, 0, 0, 1, 2, 1, 3, 1, 2, 1, 1, 1, 1,
              1, 2, 3, 2, 1, 3, 2, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 2, 0, 1, 1,
              0, 1, 2, 4, 2, 1, 1, 1, 1, 0, 2, 3, 2, 0, 2, 1, 1, 0, 3, 0, 1,
              1, 1, 0, 2, 1, 0, 1, 1, 0, 3, 1, 0, 0, 0, 1, 0, 4, 1, 2, 0, 2,
              2, 1, 2, 0, 3, 0, 1, 2, 0, 2, 1, 3, 0
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0443.1",
            "alt": "btd",
            "len": 10,
            "evalue": "0.0e-000",
            "sites": 30,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0443.1&rm=present&collection=CORE",
            "sig": "6.0e-005",
            "pwm": [
              [0.465968, 0.100477, 0.233367, 0.200187], 
              [0.333077, 0.000809635, 0.665262, 0.000851495], 
              [0.133742, 0.000809635, 0.598816, 0.266633], 
              [0.067297, 0.000809635, 0.931042, 0.000851495], 
              [0.000851495, 0.000809635, 0.997487, 0.000851495], 
              [0.000851495, 0.000809635, 0.997487, 0.000851495], 
              [0.067297, 0.931042, 0.000809635, 0.000851495], 
              [0.000851495, 0.000809635, 0.997487, 0.000851495], 
              [0.000851495, 0.000809635, 0.665262, 0.333077], 
              [0.49919, 0.0340319, 0.333035, 0.133742]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 458,
            "centrimo_sites": [
              0, 0, 0, 0, 1, 0, 0, 0, 0, 2, 0, 1, 0, 0, 0, 2, 2, 1, 0, 1, 0,
              1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 2, 1, 1, 0, 1, 1, 0, 0, 1, 3,
              0, 0, 2, 0, 1, 1, 1, 0, 0, 2, 1, 0, 0, 0, 0, 0, 2, 1, 1, 0, 1,
              0, 1, 0, 1, 0, 0, 1, 1, 0, 3, 2, 1, 2, 0, 1, 0, 0, 1, 0, 1, 0,
              1, 0, 0, 0, 2, 2, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 2, 1, 0, 1, 0,
              2, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1, 2, 1, 1, 1, 2, 0,
              1, 1, 0, 2, 2, 2, 0, 0, 1, 0, 0, 0, 1, 1, 2, 3, 0, 1, 1, 3, 0,
              0, 2, 2, 0, 1, 1, 1, 0, 1, 2, 3, 0, 2, 0, 0, 1, 1, 2, 1, 0, 1,
              1, 0, 2, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 0, 4, 2, 1, 2, 0, 0,
              1, 0, 1, 1, 0, 1, 2, 1, 0, 1, 2, 3, 1, 3, 2, 1, 2, 2, 1, 4, 0,
              0, 0, 1, 1, 1, 0, 1, 3, 0, 3, 2, 0, 2, 1, 1, 1, 4, 2, 2, 2, 2,
              1, 0, 0, 4, 4, 1, 0, 1, 1, 2, 4, 0, 3, 2, 1, 3, 2, 1, 0, 3, 4,
              0, 4, 0, 1, 2, 0, 1, 1, 0, 1, 0, 3, 1, 1, 2, 1, 4, 1, 1, 1, 1,
              2, 3, 0, 0, 1, 3, 0, 1, 0, 3, 4, 0, 2, 1, 1, 3, 2, 1, 0, 3, 1,
              1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 4, 0, 0, 2, 2, 2, 1, 0, 0, 0,
              0, 0, 1, 1, 3, 0, 0, 1, 1, 2, 1, 2, 1, 2, 0, 1, 0, 1, 0, 0, 1,
              2, 1, 3, 1, 0, 0, 1, 0, 0, 0, 2, 1, 1, 1, 0, 2, 1, 2, 0, 1, 3,
              2, 2, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 2, 2, 0, 1, 0, 2, 1, 0, 0,
              0, 3, 1, 1, 2, 2, 0, 2, 1, 2, 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0,
              3, 1, 0, 0, 3, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1,
              0, 1, 2, 2, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 2,
              0, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 2, 0, 1, 4, 1, 1, 0,
              1, 2, 1, 0, 0, 1, 1, 0, 2, 0, 0, 1, 3, 0, 2, 0, 1, 2, 2, 2, 0,
              0, 0, 0, 1, 2, 1, 0, 1
            ]
          }, {
            "prog": "dreme",
            "db": -2,
            "id": "ARATA",
            "len": 5,
            "evalue": "5.0e-003",
            "sites": 259,
            "sig": "5.0e-003",
            "pwm": [
              [1.000000, 0.000000, 0.000000, 0.000000], 
              [0.436293, 0.000000, 0.563707, 0.000000], 
              [1.000000, 0.000000, 0.000000, 0.000000], 
              [0.000000, 0.000000, 0.000000, 1.000000], 
              [1.000000, 0.000000, 0.000000, 0.000000]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 738,
            "centrimo_sites": [
              0, 4, 2, 3, 3, 6, 3, 2, 3, 1, 0, 3, 3, 3, 1, 2, 3, 3, 3, 2, 1,
              0, 2, 2, 0, 4, 1, 1, 1, 0, 3, 1, 2, 0, 3, 1, 2, 2, 1, 2, 2, 6,
              1, 0, 1, 0, 1, 1, 1, 0, 1, 4, 1, 1, 0, 1, 3, 2, 1, 0, 1, 2, 2,
              3, 2, 0, 2, 0, 5, 0, 1, 2, 0, 0, 1, 2, 3, 1, 0, 2, 4, 1, 3, 3,
              1, 1, 2, 1, 1, 0, 1, 1, 3, 2, 0, 3, 0, 1, 2, 1, 1, 2, 0, 1, 1,
              2, 3, 0, 1, 1, 3, 2, 1, 2, 2, 1, 0, 0, 2, 2, 5, 2, 3, 1, 2, 1,
              2, 0, 2, 2, 1, 2, 0, 2, 2, 0, 1, 2, 2, 2, 1, 1, 0, 1, 0, 1, 2,
              1, 1, 0, 1, 2, 2, 1, 3, 1, 2, 1, 2, 3, 2, 4, 1, 0, 4, 4, 4, 3,
              3, 0, 1, 1, 1, 2, 1, 3, 0, 1, 1, 2, 3, 1, 0, 0, 6, 2, 3, 2, 1,
              5, 1, 3, 4, 3, 4, 1, 0, 2, 4, 2, 6, 1, 2, 1, 4, 2, 0, 2, 3, 4,
              2, 4, 0, 4, 1, 1, 6, 0, 5, 3, 5, 3, 1, 3, 2, 3, 1, 4, 1, 4, 2,
              0, 1, 4, 0, 2, 1, 2, 2, 1, 6, 3, 1, 3, 4, 5, 2, 1, 2, 0, 1, 3,
              2, 4, 3, 2, 3, 4, 0, 6, 0, 2, 0, 0, 3, 2, 2, 3, 2, 4, 4, 1, 3,
              0, 3, 3, 0, 2, 2, 2, 1, 0, 2, 1, 2, 0, 1, 0, 2, 1, 1, 4, 2, 2,
              1, 3, 1, 2, 1, 3, 1, 5, 3, 3, 0, 1, 0, 0, 0, 0, 2, 3, 3, 1, 2,
              2, 2, 1, 0, 0, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 1, 4, 1, 1,
              3, 1, 2, 1, 0, 4, 1, 1, 2, 2, 0, 0, 0, 2, 0, 1, 0, 0, 1, 1, 1,
              1, 1, 4, 0, 2, 0, 2, 1, 0, 0, 1, 2, 0, 1, 1, 2, 1, 1, 1, 1, 0,
              0, 1, 2, 2, 0, 0, 1, 2, 1, 2, 0, 5, 2, 0, 0, 0, 0, 1, 1, 5, 2,
              1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 1, 1,
              1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 2, 0, 0, 2, 0, 1, 0, 2,
              0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 3, 1, 3, 0, 1, 0, 0, 1, 1,
              2, 2, 0, 1, 1, 0, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 2, 3, 0, 1,
              0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0
            ]
          }, {
            "prog": "dreme",
            "db": -2,
            "id": "CCMCACCC",
            "len": 8,
            "evalue": "5.7e-003",
            "sites": 29,
            "sig": "5.7e-003",
            "pwm": [
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [0.517241, 0.482759, 0.000000, 0.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [1.000000, 0.000000, 0.000000, 0.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000]
            ],
            "tomtom_matches": [
              {
                "db": 0,
                "id": "MA0039.2",
                "alt": "Klf4"
              }, {
                "db": 0,
                "id": "MA0436.1",
                "alt": "YPR022C"
              }, {
                "db": 0,
                "id": "MA0270.1",
                "alt": "AFT2"
              }, {
                "db": 0,
                "id": "MA0079.1",
                "alt": "SP1"
              }, {
                "db": 0,
                "id": "MA0079.2",
                "alt": "SP1"
              }, {
                "db": 0,
                "id": "MA0073.1",
                "alt": "RREB1"
              }, {
                "db": 0,
                "id": "MA0338.1",
                "alt": "MIG2"
              }
            ],
            "centrimo_total_sites": 449,
            "centrimo_sites": [
              0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 2, 0,
              0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0,
              0, 3, 0, 0, 0, 0, 2, 1, 0, 0, 0, 2, 1, 0, 0, 0, 1, 0, 0, 1, 0,
              1, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 2, 0, 0, 0, 0, 1, 0,
              0, 0, 0, 0, 2, 0, 0, 2, 1, 0, 1, 0, 1, 0, 0, 0, 1, 2, 1, 0, 0,
              0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 2, 0, 0, 1, 2, 0, 0,
              1, 1, 0, 1, 2, 0, 2, 0, 1, 1, 1, 1, 2, 0, 1, 1, 1, 0, 2, 0, 1,
              2, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 3, 1, 0, 1, 0, 0, 0, 0, 1,
              0, 1, 0, 0, 1, 0, 0, 1, 1, 2, 0, 1, 1, 0, 0, 0, 0, 3, 1, 0, 1,
              0, 0, 3, 1, 0, 1, 1, 0, 2, 0, 0, 1, 1, 3, 3, 0, 0, 0, 1, 0, 1,
              1, 1, 2, 2, 4, 1, 1, 0, 2, 5, 3, 1, 3, 3, 2, 2, 4, 3, 4, 5, 0,
              3, 3, 2, 1, 4, 4, 3, 4, 3, 2, 0, 5, 4, 3, 3, 2, 1, 4, 3, 2, 4,
              1, 3, 0, 6, 1, 1, 2, 3, 2, 3, 1, 3, 3, 1, 4, 4, 1, 4, 2, 3, 1,
              2, 4, 2, 2, 2, 2, 2, 3, 1, 1, 3, 1, 1, 4, 1, 2, 1, 1, 0, 4, 2,
              2, 3, 1, 2, 2, 2, 2, 0, 0, 2, 1, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0,
              0, 1, 1, 0, 2, 1, 0, 3, 0, 0, 1, 0, 3, 0, 0, 2, 0, 0, 1, 4, 0,
              2, 0, 2, 0, 1, 0, 0, 2, 0, 0, 1, 1, 1, 1, 0, 1, 1, 3, 1, 1, 0,
              1, 2, 0, 0, 1, 0, 2, 0, 0, 1, 0, 0, 1, 2, 0, 0, 0, 0, 1, 0, 0,
              2, 0, 1, 0, 3, 0, 1, 1, 0, 0, 0, 0, 0, 4, 1, 1, 0, 1, 0, 0, 0,
              0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1,
              1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 2, 1, 0, 1, 0, 0,
              1, 0, 0, 0, 1, 0, 0, 0, 1, 2, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 0,
              0, 0, 0, 0, 2, 0, 0, 0, 2, 1, 1, 2, 0, 0, 0, 0, 0, 1, 2, 2, 1,
              2, 0, 0, 0, 0, 1, 1, 0, 0, 0
            ]
          }, {
            "prog": "dreme",
            "db": -2,
            "id": "ACAGMTG",
            "len": 7,
            "evalue": "8.2e-003",
            "sites": 66,
            "sig": "8.2e-003",
            "pwm": [
              [1.000000, 0.000000, 0.000000, 0.000000], 
              [0.000000, 1.000000, 0.000000, 0.000000], 
              [1.000000, 0.000000, 0.000000, 0.000000], 
              [0.000000, 0.000000, 1.000000, 0.000000], 
              [0.409091, 0.590909, 0.000000, 0.000000], 
              [0.000000, 0.000000, 0.000000, 1.000000], 
              [0.000000, 0.000000, 1.000000, 0.000000]
            ],
            "tomtom_matches": [
              {
                "db": 0,
                "id": "MA0091.1",
                "alt": "TAL1::TCF3"
              }
            ],
            "centrimo_total_sites": 173,
            "centrimo_sites": [
              0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 2, 0, 1, 0, 0, 0, 0, 0,
              0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
              1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0,
              0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 1,
              0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 2, 0, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0,
              0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0,
              1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 2, 2, 1, 1, 0, 0, 0, 0, 0, 1, 1,
              0, 0, 0, 0, 0, 0, 1, 0, 2, 0, 0, 0, 0, 1, 0, 2, 0, 1, 1, 1, 1,
              1, 0, 1, 0, 0, 0, 0, 0, 3, 0, 1, 0, 0, 2, 0, 0, 0, 0, 3, 0, 3,
              0, 1, 1, 1, 1, 1, 2, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 2, 0, 1, 0,
              0, 1, 0, 0, 0, 0, 0, 1, 2, 2, 1, 1, 0, 0, 0, 1, 2, 0, 0, 0, 0,
              1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 2, 2, 3, 0, 1, 0, 1, 0, 0, 1,
              0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 2, 0, 0, 0, 0, 0, 0, 1,
              1, 1, 1, 0, 0, 0, 2, 1, 0, 0, 0, 1, 0, 2, 0, 0, 1, 1, 0, 0, 0,
              0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0,
              0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
              0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0,
              1, 0, 0, 1, 1, 0, 0, 0, 2, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0,
              1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 2, 0,
              0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0,
              1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0,
              0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0333.1",
            "alt": "MET31",
            "len": 9,
            "evalue": "0.0e-000",
            "sites": 100,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0333.1&rm=present&collection=CORE",
            "sig": "9.2e-003",
            "pwm": [
              [0.376118, 0.0991545, 0.376106, 0.148623], 
              [0.204134, 0.285672, 0.30606, 0.204134], 
              [0.138732, 0.138719, 0.178283, 0.544266], 
              [0.000256044, 0.000243457, 0.999244, 0.000256044], 
              [0.000256044, 0.000243457, 0.000243457, 0.999257], 
              [0.000256044, 0.000243457, 0.999244, 0.000256044], 
              [0.000256044, 0.000243457, 0.999244, 0.000256044], 
              [0.000256044, 0.999244, 0.000243457, 0.000256044], 
              [0.101165, 0.000243457, 0.696517, 0.202074]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 423,
            "centrimo_sites": [
              0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 3, 0, 0,
              2, 0, 0, 0, 1, 0, 0, 4, 1, 0, 0, 1, 0, 0, 0, 2, 1, 1, 0, 0, 0,
              1, 0, 1, 0, 0, 2, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1,
              0, 2, 0, 1, 0, 2, 0, 0, 4, 1, 2, 1, 0, 0, 1, 1, 0, 2, 1, 0, 2,
              1, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 2, 0,
              0, 1, 1, 1, 0, 0, 0, 0, 0, 2, 1, 0, 1, 2, 0, 1, 0, 0, 1, 1, 0,
              1, 0, 1, 1, 0, 0, 0, 2, 0, 0, 1, 2, 0, 1, 0, 0, 0, 1, 0, 1, 0,
              0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 3, 0, 0, 2, 0, 1, 2, 2, 0, 1, 0,
              2, 2, 0, 2, 0, 0, 2, 3, 1, 0, 1, 1, 2, 0, 1, 1, 2, 3, 0, 2, 1,
              1, 0, 0, 1, 0, 0, 1, 2, 1, 0, 4, 3, 1, 0, 1, 0, 1, 1, 1, 1, 1,
              0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 2, 2, 3, 1, 0, 2, 2, 1, 1, 2,
              1, 1, 1, 2, 0, 3, 3, 2, 0, 3, 3, 2, 1, 3, 0, 0, 3, 0, 1, 1, 2,
              0, 6, 4, 0, 1, 1, 4, 1, 1, 1, 2, 0, 0, 5, 2, 2, 0, 1, 0, 0, 3,
              1, 2, 1, 2, 1, 2, 0, 0, 1, 1, 2, 3, 1, 1, 0, 1, 0, 2, 0, 1, 1,
              1, 1, 2, 1, 1, 2, 0, 0, 1, 1, 1, 1, 3, 1, 0, 1, 1, 0, 1, 0, 1,
              0, 2, 1, 1, 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 1, 1, 1, 0,
              1, 1, 0, 1, 2, 0, 2, 2, 1, 3, 0, 3, 0, 3, 1, 2, 3, 1, 0, 0, 0,
              0, 2, 2, 0, 0, 2, 1, 2, 1, 1, 0, 0, 0, 0, 2, 2, 0, 0, 1, 1, 1,
              2, 0, 0, 2, 1, 1, 2, 0, 0, 0, 1, 0, 1, 1, 1, 1, 1, 2, 0, 2, 0,
              1, 1, 1, 0, 1, 0, 2, 0, 1, 0, 1, 1, 1, 0, 1, 2, 0, 2, 0, 0, 0,
              2, 1, 0, 1, 1, 1, 2, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0,
              1, 0, 4, 0, 0, 0, 0, 2, 1, 1, 1, 0, 2, 0, 0, 0, 3, 2, 1, 0, 0,
              1, 0, 1, 2, 0, 0, 1, 0, 2, 0, 1, 1, 1, 0, 0, 2, 2, 1, 0, 1, 0,
              0, 1, 1, 1, 0, 2, 1, 1, 2
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0425.1",
            "alt": "YGR067C",
            "len": 14,
            "evalue": "0.0e-000",
            "sites": 100,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0425.1&rm=present&collection=CORE",
            "sig": "2.3e-002",
            "pwm": [
              [0.356336, 0.23763, 0.267303, 0.138732], 
              [0.000256044, 0.999244, 0.000243457, 0.000256044], 
              [0.000256044, 0.989254, 0.000243457, 0.0102461], 
              [0.000256044, 0.999244, 0.000243457, 0.000256044], 
              [0.0102461, 0.989254, 0.000243457, 0.000256044], 
              [0.409846, 0.000243457, 0.309934, 0.279976], 
              [0.000256044, 0.979264, 0.0102335, 0.0102461], 
              [0.267316, 0.257412, 0.168392, 0.30688], 
              [0.230026, 0.259984, 0.200044, 0.309946], 
              [0.240016, 0.259984, 0.200044, 0.299956], 
              [0.250006, 0.240004, 0.249994, 0.259996], 
              [0.250006, 0.220024, 0.259984, 0.269986], 
              [0.220036, 0.259984, 0.259984, 0.259996], 
              [0.257425, 0.23763, 0.257412, 0.247534]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 527,
            "centrimo_sites": [
              0, 3, 1, 2, 0, 0, 0, 1, 1, 1, 1, 0, 1, 1, 2, 1, 2, 1, 0, 0, 1,
              1, 0, 2, 1, 0, 0, 2, 1, 0, 1, 3, 0, 1, 1, 3, 0, 0, 2, 1, 0, 1,
              1, 2, 2, 0, 0, 0, 2, 1, 1, 0, 0, 0, 3, 1, 1, 1, 1, 4, 1, 2, 1,
              2, 0, 2, 1, 1, 1, 2, 1, 2, 0, 1, 1, 2, 1, 1, 2, 0, 0, 4, 0, 3,
              1, 0, 0, 2, 0, 3, 1, 5, 2, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1,
              1, 0, 0, 0, 1, 1, 0, 1, 1, 1, 3, 2, 1, 2, 1, 0, 0, 2, 2, 1, 0,
              0, 2, 1, 1, 3, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 2, 1, 2, 0, 1,
              0, 0, 2, 2, 2, 0, 5, 3, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0,
              2, 0, 1, 0, 1, 0, 2, 1, 0, 3, 0, 1, 2, 0, 1, 0, 2, 1, 0, 2, 0,
              3, 3, 0, 3, 2, 5, 1, 0, 1, 1, 2, 2, 0, 0, 0, 0, 1, 2, 0, 0, 2,
              0, 2, 2, 2, 1, 0, 4, 1, 3, 0, 1, 1, 2, 1, 2, 0, 4, 0, 2, 2, 1,
              1, 0, 4, 0, 0, 2, 1, 1, 7, 2, 0, 1, 2, 3, 2, 1, 2, 1, 1, 3, 2,
              2, 0, 2, 2, 1, 4, 1, 1, 2, 2, 0, 3, 3, 4, 1, 1, 1, 1, 0, 1, 0,
              2, 2, 3, 4, 1, 1, 4, 0, 3, 3, 1, 0, 2, 3, 0, 0, 2, 1, 2, 1, 0,
              3, 2, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 2, 1, 0, 0, 0, 2, 1, 2, 3,
              1, 0, 1, 2, 0, 0, 0, 2, 2, 0, 0, 1, 0, 0, 2, 0, 1, 0, 0, 1, 1,
              1, 1, 3, 0, 0, 1, 1, 1, 1, 3, 1, 1, 0, 0, 1, 3, 0, 1, 2, 0, 1,
              0, 0, 1, 0, 3, 1, 2, 0, 0, 0, 0, 0, 2, 0, 1, 1, 0, 2, 1, 1, 2,
              1, 2, 0, 3, 0, 1, 3, 0, 2, 2, 1, 3, 1, 0, 0, 1, 3, 1, 0, 0, 3,
              0, 0, 1, 0, 1, 1, 2, 0, 0, 0, 1, 0, 2, 1, 1, 1, 2, 1, 0, 1, 0,
              1, 1, 1, 2, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 3, 1, 1, 0,
              1, 3, 0, 0, 0, 0, 2, 1, 1, 0, 3, 3, 1, 1, 0, 0, 1, 0, 0, 0, 2,
              0, 1, 2, 4, 0, 1, 0, 0, 1, 0, 1, 0, 1, 1, 3, 1, 1, 2, 0, 1, 2,
              1, 1, 0, 1
            ]
          }, {
            "prog": "centrimo",
            "db": 0,
            "id": "MA0204.1",
            "alt": "Six4",
            "len": 6,
            "evalue": "0.0e-000",
            "sites": 20,
            "url": "http:\/\/jaspar.genereg.net\/cgi-bin\/jaspar_db.pl?ID=MA0204.1&rm=present&collection=CORE",
            "sig": "3.5e-002",
            "pwm": [
              [0.00127512, 0.00121244, 0.00121244, 0.9963], 
              [0.00127512, 0.00121244, 0.996237, 0.00127512], 
              [0.9963, 0.00121244, 0.00121244, 0.00127512], 
              [0.00127512, 0.349471, 0.200217, 0.449036], 
              [0.9963, 0.00121244, 0.00121244, 0.00127512], 
              [0.0510264, 0.946486, 0.00121244, 0.00127512]
            ],
            "tomtom_matches": [],
            "centrimo_total_sites": 670,
            "centrimo_sites": [
              0, 2, 0, 1, 1, 0, 1, 3, 1, 4, 0, 1, 2, 1, 1, 1, 1, 1, 1, 0, 2,
              0, 1, 1, 1, 0, 1, 3, 1, 1, 0, 0, 1, 0, 2, 2, 0, 1, 0, 0, 0, 3,
              2, 0, 2, 1, 2, 2, 1, 2, 1, 1, 1, 1, 0, 2, 0, 1, 0, 2, 1, 0, 1,
              1, 0, 0, 1, 3, 0, 0, 2, 2, 2, 0, 3, 2, 0, 1, 1, 1, 2, 1, 0, 3,
              1, 0, 2, 1, 2, 1, 1, 0, 1, 2, 2, 0, 2, 1, 6, 0, 1, 0, 1, 3, 1,
              0, 1, 1, 0, 3, 0, 1, 2, 0, 0, 3, 1, 2, 1, 1, 3, 0, 1, 0, 1, 0,
              4, 0, 1, 1, 1, 1, 2, 2, 1, 0, 1, 0, 0, 1, 2, 0, 1, 1, 1, 3, 0,
              2, 0, 1, 0, 0, 1, 2, 0, 1, 0, 1, 0, 1, 1, 0, 1, 2, 3, 3, 1, 1,
              3, 0, 1, 1, 0, 0, 1, 3, 2, 5, 2, 0, 3, 0, 0, 1, 3, 2, 1, 1, 3,
              1, 3, 0, 1, 0, 1, 1, 0, 1, 2, 1, 3, 0, 2, 1, 1, 3, 2, 2, 1, 2,
              3, 4, 2, 3, 0, 2, 2, 1, 2, 0, 2, 0, 3, 1, 1, 1, 2, 1, 0, 1, 0,
              3, 1, 1, 1, 2, 5, 3, 1, 0, 1, 1, 1, 2, 1, 3, 2, 2, 1, 1, 3, 3,
              4, 1, 2, 1, 2, 4, 1, 2, 3, 1, 3, 1, 3, 6, 0, 0, 2, 5, 3, 0, 1,
              2, 0, 2, 1, 3, 2, 2, 0, 2, 1, 2, 2, 3, 2, 1, 0, 4, 1, 1, 2, 0,
              2, 3, 2, 0, 3, 3, 2, 2, 2, 2, 0, 2, 6, 6, 1, 3, 3, 1, 2, 3, 1,
              0, 1, 1, 2, 2, 3, 1, 1, 2, 5, 1, 1, 0, 0, 1, 2, 1, 0, 2, 1, 2,
              1, 1, 2, 1, 2, 1, 1, 3, 0, 2, 1, 3, 0, 1, 1, 1, 1, 0, 1, 2, 1,
              0, 0, 0, 0, 1, 1, 0, 4, 1, 1, 1, 1, 4, 1, 3, 1, 1, 2, 0, 2, 5,
              0, 0, 0, 0, 1, 1, 4, 2, 0, 3, 1, 0, 1, 1, 0, 1, 1, 2, 1, 2, 2,
              2, 3, 1, 2, 1, 2, 1, 0, 2, 1, 1, 1, 1, 0, 2, 0, 2, 2, 2, 2, 1,
              0, 1, 3, 2, 1, 2, 2, 1, 0, 2, 1, 0, 2, 1, 0, 3, 2, 0, 1, 5, 2,
              1, 0, 1, 2, 0, 0, 1, 1, 1, 0, 2, 1, 1, 2, 5, 2, 0, 0, 2, 0, 2,
              1, 2, 1, 2, 0, 2, 2, 0, 0, 1, 0, 0, 3, 2, 2, 0, 2, 1, 0, 0, 1,
              1, 1, 1, 1, 2, 3, 0, 1, 2, 1, 3, 2
            ]
          }, {
            "prog": "meme",
            "db": -1,
            "id": "3",
            "len": 15,
            "evalue": "1.7e-001",
            "sites": 30,
            "sig": "1.7e-001",
            "pwm": [
              [0.000000, 0.966667, 0.033333, 0.000000], 
              [0.133333, 0.033333, 0.033333, 0.800000], 
              [0.000000, 0.866667, 0.033333, 0.100000], 
              [0.100000, 0.633333, 0.033333, 0.233333], 
              [0.033333, 0.966667, 0.000000, 0.000000], 
              [0.000000, 0.600000, 0.066667, 0.333333], 
              [0.200000, 0.333333, 0.233333, 0.233333], 
              [0.000000, 0.333333, 0.166667, 0.500000], 
              [0.000000, 0.966667, 0.033333, 0.000000], 
              [0.033333, 0.533333, 0.000000, 0.433333], 
              [0.100000, 0.833333, 0.066667, 0.000000], 
              [0.000000, 0.200000, 0.000000, 0.800000], 
              [0.000000, 0.533333, 0.366667, 0.100000], 
              [0.066667, 0.933333, 0.000000, 0.000000], 
              [0.000000, 0.766667, 0.000000, 0.233333]
            ],
            "tomtom_matches": [
              {
                "db": 0,
                "id": "MA0079.2",
                "alt": "SP1"
              }, {
                "db": 0,
                "id": "MA0068.1",
                "alt": "Pax4"
              }, {
                "db": 0,
                "id": "MA0079.1",
                "alt": "SP1"
              }, {
                "db": 0,
                "id": "MA0057.1",
                "alt": "MZF1_5-13"
              }
            ],
            "centrimo_total_sites": 518,
            "centrimo_sites": [
              1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 2, 0, 2, 1, 1, 2, 0, 0, 2, 1,
              0, 1, 1, 1, 2, 2, 0, 3, 0, 1, 0, 0, 2, 1, 2, 1, 0, 1, 0, 2, 2,
              0, 0, 1, 1, 0, 0, 0, 2, 1, 1, 0, 1, 1, 1, 0, 4, 1, 0, 2, 0, 1,
              0, 2, 0, 2, 1, 1, 1, 1, 2, 1, 0, 4, 2, 0, 0, 0, 4, 1, 4, 0, 2,
              2, 2, 1, 1, 1, 0, 0, 1, 2, 0, 1, 1, 0, 2, 0, 0, 1, 1, 0, 0, 1,
              0, 0, 0, 0, 2, 2, 0, 0, 1, 0, 0, 0, 1, 1, 0, 2, 2, 2, 0, 1, 1,
              3, 0, 1, 0, 0, 2, 1, 2, 1, 1, 0, 3, 3, 0, 3, 3, 0, 3, 0, 3, 0,
              2, 2, 1, 1, 3, 2, 0, 2, 0, 3, 1, 0, 1, 0, 0, 2, 1, 0, 3, 1, 1,
              1, 1, 0, 0, 1, 0, 0, 2, 0, 0, 1, 0, 2, 4, 0, 1, 1, 0, 2, 0, 3,
              0, 2, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 2, 1, 1, 2, 3, 0, 1, 3, 1,
              3, 0, 0, 1, 1, 1, 3, 0, 1, 1, 0, 2, 1, 2, 0, 0, 2, 2, 2, 4, 1,
              2, 1, 2, 2, 3, 2, 2, 0, 1, 3, 2, 1, 0, 3, 2, 0, 2, 2, 1, 2, 2,
              1, 3, 2, 1, 6, 1, 1, 2, 1, 0, 1, 3, 1, 1, 0, 0, 2, 0, 1, 0, 0,
              0, 4, 3, 3, 1, 2, 1, 0, 2, 1, 3, 3, 1, 1, 0, 0, 2, 0, 0, 1, 1,
              0, 2, 1, 1, 2, 0, 0, 1, 1, 0, 2, 1, 0, 2, 0, 1, 2, 2, 2, 0, 1,
              1, 1, 3, 0, 0, 1, 0, 1, 0, 1, 1, 2, 0, 0, 0, 2, 1, 1, 2, 2, 1,
              1, 1, 3, 4, 0, 0, 0, 3, 2, 0, 0, 3, 1, 1, 0, 0, 0, 0, 0, 0, 1,
              2, 2, 0, 1, 2, 0, 2, 2, 2, 2, 1, 0, 1, 0, 1, 1, 1, 0, 2, 1, 0,
              3, 0, 0, 1, 0, 1, 0, 0, 2, 0, 1, 0, 1, 0, 1, 1, 2, 0, 2, 2, 1,
              1, 2, 0, 0, 0, 1, 1, 1, 0, 3, 1, 1, 1, 0, 0, 3, 0, 0, 1, 4, 0,
              2, 1, 1, 1, 1, 1, 0, 3, 1, 0, 1, 0, 1, 0, 0, 2, 1, 0, 0, 2, 0,
              1, 2, 1, 0, 1, 2, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 2, 1,
              2, 0, 0, 2, 2, 1, 2, 0, 1, 1, 5, 2, 1, 3, 2, 1, 0, 0, 0, 2, 1,
              1, 1, 2
            ]
          }
        ],
        "groups": [
          [
            {
              "motif": 0,
              "rc": false,
              "offset": 4
            }, {
              "motif": 1,
              "rc": false,
              "offset": 4
            }, {
              "motif": 2,
              "rc": true,
              "offset": 4
            }, {
              "motif": 9,
              "rc": true,
              "offset": 4
            }, {
              "motif": 13,
              "rc": false,
              "offset": 4
            }, {
              "motif": 15,
              "rc": true,
              "offset": 8
            }, {
              "motif": 16,
              "rc": false,
              "offset": 4
            }, {
              "motif": 18,
              "rc": false,
              "offset": 2
            }, {
              "motif": 20,
              "rc": true,
              "offset": 5
            }, {
              "motif": 22,
              "rc": false,
              "offset": 6
            }, {
              "motif": 23,
              "rc": true,
              "offset": 0
            }
          ], [
            {
              "motif": 3,
              "rc": false,
              "offset": 0
            }, {
              "motif": 4,
              "rc": true,
              "offset": 11
            }, {
              "motif": 5,
              "rc": false,
              "offset": 10
            }, {
              "motif": 6,
              "rc": false,
              "offset": 9
            }, {
              "motif": 7,
              "rc": false,
              "offset": 11
            }, {
              "motif": 8,
              "rc": false,
              "offset": 11
            }, {
              "motif": 10,
              "rc": true,
              "offset": 10
            }, {
              "motif": 11,
              "rc": false,
              "offset": 12
            }, {
              "motif": 12,
              "rc": false,
              "offset": 11
            }, {
              "motif": 14,
              "rc": false,
              "offset": 11
            }, {
              "motif": 17,
              "rc": false,
              "offset": 11
            }, {
              "motif": 19,
              "rc": false,
              "offset": 11
            }, {
              "motif": 24,
              "rc": false,
              "offset": 11
            }
          ], [
            {
              "motif": 21,
              "rc": false,
              "offset": 0
            }
          ], [
            {
              "motif": 25,
              "rc": false,
              "offset": 0
            }
          ]
        ]
      };
    </script>
    <script>
var site_url = "http://vm2.ucsd.edu:8080/meme";
</script>
    <script>
//======================================================================
// start Alphabet object
//======================================================================
var Alphabet = function (alphabet, bg) {
  "use strict";
  var is_letter, is_prob, pos, letter, parts, i, freq;
  //variable prototype
  this.freqs = new Array();
  this.alphabet = new Array();
  this.letter_count = 0;
  //construct
  is_letter = /^\w$/;
  is_prob = /^((1(\.0+)?)|(0(\.\d+)?))$/;
  for (pos = 0; pos < alphabet.length; pos++) {
    letter = alphabet.charAt(pos);
    if (is_letter.test(letter)) {
      this.alphabet[this.letter_count] = letter.toUpperCase();
      this.freqs[this.letter_count] = -1;
      this.letter_count++;
    }
  }
  if (typeof bg !== "undefined") {
    parts = bg.split(/\s+/);
    for (i = 0, pos = 0; (i + 1) < parts.length; i += 2) {
      letter = parts[i];
      freq = parts[i+1];
      if (is_letter.test(letter) && is_prob.test(freq)) {
        letter = letter.toUpperCase();          //find the letter it matches
        for (;pos < this.letter_count; pos++) {
          if (this.alphabet[pos] == letter) {
            break;
          }
        }
        if (pos >= this.letter_count) {
          throw new Error("NOT_IN_ALPHABET");
        }
        this.freqs[pos] = (+freq);
      }
    }
  } else {
    //assume uniform background
    freq = 1.0 / this.letter_count;
    for (pos = 0; pos < this.letter_count; pos++) {
      this.freqs[pos] = freq;
    }
  }
};


Alphabet.prototype.get_ic = function() {
  "use strict";
  if (this.is_nucleotide()) {
    return 2;
  } else {
    return Math.log(20) / Math.LN2;
  }
};

Alphabet.prototype.get_size = function() {
  "use strict";
  return this.letter_count;
};

Alphabet.prototype.get_letter = function(alph_index) {
  "use strict";
  if (alph_index < 0 || alph_index >= this.letter_count) {
    throw new Error("BAD_ALPHABET_INDEX");
  }
  return this.alphabet[alph_index];
};

Alphabet.prototype.get_bg_freq = function(alph_index) {
  "use strict";
  if (alph_index < 0 || alph_index >= this.letter_count) {
    throw new Error("BAD_ALPHABET_INDEX");
  }
  if (this.freqs[alph_index] == -1) {
    throw new Error("BG_FREQ_NOT_SET");
  }
  return this.freqs[alph_index];
};

Alphabet.prototype.get_colour = function(alph_index) {
  "use strict";
  var red, blue, orange, green, yellow, purple, magenta, pink, turquoise;
  red = "rgb(204,0,0)";
  blue = "rgb(0,0,204)";
  orange = "rgb(255,179,0)";
  green = "rgb(0,128,0)";
  yellow = "rgb(255,255,0)";
  purple = "rgb(204,0,204)";
  magenta = "rgb(255,0,255)";
  pink = "rgb(255,204,204)";
  turquoise = "rgb(51,230,204)";
  if (alph_index < 0 || alph_index >= this.letter_count) {
    throw new Error("BAD_ALPHABET_INDEX");
  }
  if (this.is_nucleotide()) {
    switch (this.alphabet[alph_index]) {
      case "A":
        return red;
      case "C":
        return blue;
      case "G":
        return orange;
      case "T":
        return green;
      default:
        throw new Error("Invalid nucleotide letter");
    }
  } else {
    switch (this.alphabet[alph_index]) {
      case "A":
      case "C":
      case "F":
      case "I":
      case "L":
      case "V":
      case "W":
      case "M":
        return blue;
      case "N":
      case "Q":
      case "S":
      case "T":
        return green;
      case "D":
      case "E":
        return magenta;
      case "K":
      case "R":
        return red;
      case "H":
        return pink;
      case "G":
        return orange;
      case "P":
        return yellow;
      case "Y":
        return turquoise;
      default:
        throw new Error("Invalid protein letter");
    }
  }
  return "black";
};

Alphabet.prototype.is_ambig = function(alph_index) {
  "use strict";
  if (alph_index < 0 || alph_index >= this.letter_count) {
    throw new Error("BAD_ALPHABET_INDEX");
  }
  if (this.is_nucleotide()) {
    return ("ACGT".indexOf(this.alphabet[alph_index]) == -1);
  } else {
    return ("ACDEFGHIKLMNPQRSTVWY".indexOf(this.alphabet[alph_index]) == -1);
  }
};

Alphabet.prototype.get_index = function(letter) {
  "use strict";
  var i;
  for (i = 0; i < this.letter_count; i++) {
    if (this.alphabet[i] == letter.toUpperCase()) {
      return i;
    }
  }
  throw new Error("UNKNOWN_LETTER");
};

Alphabet.prototype.is_nucleotide = function() {
  "use strict";
  //TODO basic method, make better
  if (this.letter_count < 20) {
    return true;
  }
  return false;
};

Alphabet.prototype.toString = function() {
  "use strict";
  return (this.is_nucleotide() ? "Nucleotide" : "Protein") + 
    " Alphabet " + (this.alphabet.join(""));
};

//======================================================================
// end Alphabet object
//======================================================================

//======================================================================
// start Symbol object
//======================================================================
var Symbol = function(alph_index, scale, alphabet) {
  "use strict";
  //variable prototype
  this.symbol = alphabet.get_letter(alph_index);
  this.scale = scale;
  this.colour = alphabet.get_colour(alph_index);
};

Symbol.prototype.get_symbol = function() {
  "use strict";
  return this.symbol;
};

Symbol.prototype.get_scale = function() {
  "use strict";
  return this.scale;
};

Symbol.prototype.get_colour = function() {
  "use strict";
  return this.colour;
};

Symbol.prototype.toString = function() {
  "use strict";
  return this.symbol + " " + (Math.round(this.scale*1000)/10) + "%";
};

function compare_symbol(sym1, sym2) {
  "use strict";
  if (sym1.get_scale() < sym2.get_scale()) {
    return -1;
  } else if (sym1.get_scale() > sym2.get_scale()) {
    return 1;
  } else {
    return 0;
  }
}
//======================================================================
// end Symbol object
//======================================================================

//======================================================================
// start Pspm object
//======================================================================
var Pspm = function(matrix, name, ltrim, rtrim, nsites, evalue) {
  "use strict";
  var row, col, data, row_sum, delta, evalue_re;
  if (typeof name !== "string") {
    name = "";
  }
  this.name = name;
  //construct
  if (matrix instanceof Pspm) {
    // copy constructor
    this.alph_length = matrix.alph_length;
    this.motif_length = matrix.motif_length;
    this.name = matrix.name;
    this.nsites = matrix.nsites;
    this.evalue = matrix.evalue;
    this.ltrim = matrix.ltrim;
    this.rtrim = matrix.rtrim;
    this.pspm = [];
    for (row = 0; row < matrix.motif_length; row++) {
      this.pspm[row] = [];
      for (col = 0; col < matrix.alph_length; col++) {
        this.pspm[row][col] = matrix.pspm[row][col];
      }
    }
  } else {
    // check parameters
    if (typeof ltrim === "undefined") {
      ltrim = 0;
    } else if (typeof ltrim !== "number" || ltrim % 1 !== 0 || ltrim < 0) {
      throw new Error("ltrim must be a non-negative integer, got: " + ltrim);
    }
    if (typeof rtrim === "undefined") {
      rtrim = 0;
    } else if (typeof rtrim !== "number" || rtrim % 1 !== 0 || rtrim < 0) {
      throw new Error("rtrim must be a non-negative integer, got: " + rtrim);
    }
    if (typeof nsites !== "undefined") {
      if (typeof nsites !== "number" || nsites <= 0) {
        throw new Error("nsites must be a positive number, got: " + nsites);
      }
    }
    if (typeof evalue !== "undefined") {
      if (typeof evalue === "number") {
        if (evalue < 0) {
          throw new Error("evalue must be a non-negative number, got: " + evalue);
        }
      } else if (typeof evalue === "string") {
        evalue_re = /^((?:[+]?[0-9]*\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|inf)$/;
        if (!evalue_re.test(evalue)) {
          throw new Error("evalue must be a non-negative number, got: " + evalue);
        }
      } else {
        throw new Error("evalue must be a non-negative number, got: " + evalue);
      }
    }
    // set properties
    this.name = name;
    this.nsites = nsites;
    this.evalue = evalue;
    this.ltrim = ltrim;
    this.rtrim = rtrim;
    if (typeof matrix === "string") {
      // string constructor
      data = parse_pspm_string(matrix);
      this.alph_length = data["alph_length"];
      this.motif_length = data["motif_length"];
      this.pspm = data["pspm"];
      if (typeof this.evalue === "undefined") {
        if (typeof data["evalue"] !== "undefined") {
          this.evalue = data["evalue"];
        } else {
          this.evalue = 0;
        }
      }
      if (typeof this.nsites === "undefined") {
        if (typeof data["nsites"] === "number") {
          this.nsites = data["nsites"];
        } else {
          this.nsites = 20;
        }
      }
    } else {
      // assume pspm is a nested array
      this.motif_length = matrix.length;
      this.alph_length = (matrix.length > 0 ? matrix[0].length : 0);
      if (typeof this.nsites === "undefined") {
        this.nsites = 20;
      }
      if (typeof this.evalue === "undefined") {
        this.evalue = 0;
      }
      this.pspm = [];
      // copy pspm and check
      for (row = 0; row < this.motif_length; row++) {
        if (this.alph_length != matrix[row].length) {
          throw new Error("COLUMN_MISMATCH");
        }
        this.pspm[row] = [];
        row_sum = 0;
        for (col = 0; col < this.alph_length; col++) {
          this.pspm[row][col] = matrix[row][col];
          row_sum += this.pspm[row][col];
        }
        delta = 0.1;
        if (isNaN(row_sum) || (row_sum > 1 && (row_sum - 1) > delta) || 
            (row_sum < 1 && (1 - row_sum) > delta)) {
          throw new Error("INVALID_SUM");
        }
      }
    }
  }
};

Pspm.prototype.copy = function() {
  "use strict";
  return new Pspm(this);
};

Pspm.prototype.reverse_complement = function(alphabet) {
  "use strict";
  var x, y, temp, a_index, c_index, g_index, t_index, i, row, temp_trim;
  if (this.alph_length != alphabet.get_size()) {
    throw new Error("ALPHABET_MISMATCH");
  }
  if (!alphabet.is_nucleotide()) {
    throw new Error("NO_PROTEIN_RC");
  }
  //reverse
  x = 0;
  y = this.motif_length-1;
  while (x < y) {
    temp = this.pspm[x];
    this.pspm[x] = this.pspm[y];
    this.pspm[y] = temp;
    x++;
    y--;
  }
  //complement
  a_index = alphabet.get_index("A");
  c_index = alphabet.get_index("C");
  g_index = alphabet.get_index("G");
  t_index = alphabet.get_index("T");
  for (i = 0; i < this.motif_length; i++) {
    row = this.pspm[i];
    //swap A and T
    temp = row[a_index];
    row[a_index] = row[t_index];
    row[t_index] = temp;
    //swap C and G
    temp = row[c_index];
    row[c_index] = row[g_index];
    row[g_index] = temp;
  }
  //swap triming
  temp_trim = this.ltrim;
  this.ltrim = this.rtrim;
  this.rtrim = temp_trim;
  //note that ambigs are ignored because they don't effect motifs
  return this; //allow function chaining...
};

Pspm.prototype.get_stack = function(position, alphabet) {
  "use strict";
  var row, stack_ic, alphabet_ic, stack, i, sym;
  if (this.alph_length != alphabet.get_size()) {
    throw new Error("ALPHABET_MISMATCH");
  }
  row = this.pspm[position];
  stack_ic = this.get_stack_ic(position, alphabet);
  alphabet_ic = alphabet.get_ic();
  stack = [];
  for (i = 0; i < this.alph_length; i++) {
    if (alphabet.is_ambig(i)) {
      continue;
    }
    sym = new Symbol(i, row[i]*stack_ic/alphabet_ic, alphabet);
    if (sym.get_scale() <= 0) {
      continue;
    }
    stack.push(sym);
  }
  stack.sort(compare_symbol);
  return stack;
};

Pspm.prototype.get_stack_ic = function(position, alphabet) {
  "use strict";
  var row, H, i;
  if (this.alph_length != alphabet.get_size()) {
    throw new Error("ALPHABET_MISMATCH");
  }
  row = this.pspm[position];
  H = 0;
  for (i = 0; i < this.alph_length; i++) {
    if (alphabet.is_ambig(i)) {
      continue;
    }
    if (row[i] === 0) {
      continue;
    }
    H -= (row[i] * (Math.log(row[i]) / Math.LN2));
  }
  return alphabet.get_ic() - H;
};

Pspm.prototype.get_error = function(alphabet) {
  "use strict";
  var asize;
  if (this.nsites === 0) {
    return 0;
  }
  if (alphabet.is_nucleotide()) {
    asize = 4;
  } else {
    asize = 20;
  }
  return (asize-1) / (2 * Math.log(2)*this.nsites);
};

Pspm.prototype.get_motif_length = function() {
  "use strict";
  return this.motif_length;
};

Pspm.prototype.get_alph_length = function() {
  "use strict";
  return this.alph_length;
};

Pspm.prototype.get_left_trim = function() {
  "use strict";
  return this.ltrim;
};

Pspm.prototype.get_right_trim = function() {
  "use strict";
  return this.rtrim;
};

Pspm.prototype.as_pspm = function() {
  "use strict";
  var out, row, col;
  out = "letter-probability matrix: alength= " + this.alph_length + 
      " w= " + this.motif_length + " nsites= " + this.nsites + 
      " E= " + (typeof this.evalue === "number" ? 
          this.evalue.toExponential() : this.evalue) + "\n";
  for (row = 0; row < this.motif_length; row++) {
    for (col = 0; col < this.alph_length; col++) {
      if (col !== 0) {
        out += " ";
      }
      out += this.pspm[row][col].toFixed(6);
    }
    out += "\n";
  }
  return out;
};

Pspm.prototype.as_pssm = function(alphabet, pseudo) {
  "use strict";
  var out, log2, total, row, col, p, bg, p2, score;
  if (typeof pseudo === "undefined") {
    pseudo = 0.1;
  } else if (typeof pseudo !== "number") {
    throw new Error("Expected number for pseudocount");
  }
  out = "log-odds matrix: alength= " + this.alph_length + 
      " w= " + this.motif_length + 
      " E= " + (typeof this.evalue == "number" ? 
          this.evalue.toExponential() : this.evalue) + "\n";
  log2 = Math.log(2);
  total = this.nsites + pseudo;
  for (row = 0; row < this.motif_length; row++) {
    for (col = 0; col < this.alph_length; col++) {
      if (col !== 0) {
        out += " ";
      }
      p = this.pspm[row][col];
      // to avoid log of zero we add a pseudo count
      bg = alphabet.get_bg_freq(col);
      p2 = (p * this.nsites + bg * pseudo) / total;
      // now calculate the score
      score = -10000;
      if (p2 > 0) {
        score = Math.round((Math.log(p2 / bg) / log2) * 100);
      }
      out += score;
    }
    out += "\n";
  }
  return out;
};

Pspm.prototype.toString = function() {
  "use strict";
  var str, i, row;
  str = "";
  for (i = 0; i < this.pspm.length; i++) {
    row = this.pspm[i];
    str += row.join("\t") + "\n";
  }
  return str;
};

function parse_pspm_properties(str) {
  "use strict";
  var parts, i, eqpos, before, after, properties, prop, num, num_re;
  num_re = /^((?:[+]?[0-9]*\.?[0-9]+(?:[eE][-+]?[0-9]+)?)|inf)$/;
  parts = trim(str).split(/\s+/);
  // split up words containing =
  for (i = 0; i < parts.length;) {
    eqpos = parts[i].indexOf("=");
    if (eqpos != -1) {
      before = parts[i].substr(0, eqpos);
      after = parts[i].substr(eqpos+1);
      if (before.length > 0 && after.length > 0) {
        parts.splice(i, 1, before, "=", after);
        i += 3;
      } else if (before.length > 0) {
        parts.splice(i, 1, before, "=");
        i += 2;
      } else if (after.length > 0) {
        parts.splice(i, 1, "=", after);
        i += 2;
      } else {
        parts.splice(i, 1, "=");
        i++;
      }
    } else {
      i++;
    }
  }
  properties = {};
  for (i = 0; i < parts.length; i += 3) {
    if (parts.length - i < 3) {
      throw new Error("Expected PSPM property was incomplete. "+
          "Remaing parts are: " + parts.slice(i).join(" "));
    }
    if (parts[i+1] !== "=") {
      throw new Error("Expected '=' in PSPM property between key and " +
          "value but got " + parts[i+1]); 
    }
    prop = parts[i].toLowerCase();
    num = parts[i+2];
    if (!num_re.test(num)) {
      throw new Error("Expected numeric value for PSPM property '" + 
          prop + "' but got '" + num + "'");
    }
    properties[prop] = num;
  }
  return properties;
}

function parse_pspm_string(pspm_string) {
  "use strict";
  var header_re, lines, first_line, line_num, col_num, alph_length, 
      motif_length, nsites, evalue, pspm, i, line, match, props, parts,
      j, prob;
  header_re = /^letter-probability\s+matrix:(.*)$/i;
  lines = pspm_string.split(/\n/);
  first_line = true;
  line_num = 0;
  col_num = 0;
  alph_length;
  motif_length;
  nsites;
  evalue;
  pspm = [];
  for (i = 0; i < lines.length; i++) {
    line = trim(lines[i]);
    if (line.length === 0) { 
      continue;
    }
    // check the first line for a header though allow matrices without it
    if (first_line) {
      first_line = false;
      match = header_re.exec(line);
      if (match !== null) {
        props = parse_pspm_properties(match[1]);
        if (props.hasOwnProperty("alength")) {
          alph_length = parseFloat(props["alength"]);
          if (alph_length != 4 && alph_length != 20) {
            throw new Error("PSPM property alength should be 4 or 20" +
                " but got " + alph_length);
          }
        }
        if (props.hasOwnProperty("w")) {
          motif_length = parseFloat(props["w"]);
          if (motif_length % 1 !== 0 || motif_length < 1) {
            throw new Error("PSPM property w should be an integer larger " +
                "than zero but got " + motif_length);
          }
        }
        if (props.hasOwnProperty("nsites")) {
          nsites = parseFloat(props["nsites"]);
          if (nsites <= 0) {
            throw new Error("PSPM property nsites should be larger than " +
                "zero but got " + nsites);
          }
        }
        if (props.hasOwnProperty("e")) {
          evalue = props["e"];
          if (evalue < 0) {
            throw new Error("PSPM property evalue should be " +
                "non-negative but got " + evalue);
          }
        }
        continue;
      }
    }
    pspm[line_num] = [];
    col_num = 0;
    parts = line.split(/\s+/);
    for (j = 0; j < parts.length; j++) {
      prob = parseFloat(parts[j]);
      if (prob != parts[j] || prob < 0 || prob > 1) {
        throw new Error("Expected probability but got '" + parts[j] + "'"); 
      }
      pspm[line_num][col_num] = prob;
      col_num++;
    }
    line_num++;
  }
  if (typeof motif_length === "number") {
    if (pspm.length != motif_length) {
      throw new Error("Expected PSPM to have a motif length of " + 
          motif_length + " but it was actually " + pspm.length);
    }
  } else {
    motif_length = pspm.length;
  }
  if (typeof alph_length !== "number") {
    alph_length = pspm[0].length;
    if (alph_length != 4 && alph_length != 20) {
      throw new Error("Expected length of first row in the PSPM to be " +
          "either 4 or 20 but got " + alph_length);
    }
  }
  for (i = 0; i < pspm.length; i++) {
    if (pspm[i].length != alph_length) {
      throw new Error("Expected PSPM row " + i + " to have a length of " + 
          alph_length + " but the length was " + pspm[i].length);
    }
  }
  return {"pspm": pspm, "motif_length": motif_length, 
    "alph_length": alph_length, "nsites": nsites, "evalue": evalue};
}
//======================================================================
// end Pspm object
//======================================================================

//======================================================================
// start Logo object
//======================================================================

var Logo = function(alphabet, fine_text) {
  "use strict";
  this.alphabet = alphabet;
  this.fine_text = fine_text;
  this.pspm_list = [];
  this.pspm_column = [];
  this.rows = 0;
  this.columns = 0;
};

Logo.prototype.add_pspm = function(pspm, column) {
  "use strict";
  var col;
  if (typeof column === "undefined") {
    column = 0;
  } else if (column < 0) {
    throw new Error("Column index out of bounds.");
  }
  this.pspm_list[this.rows] = pspm;
  this.pspm_column[this.rows] = column;
  this.rows++;
  col = column + pspm.get_motif_length();
  if (col > this.columns) {
    this.columns = col;
  }
};

Logo.prototype.get_columns = function() {
  "use strict";
  return this.columns;
};

Logo.prototype.get_rows = function() {
  "use strict";
  return this.rows;
};

Logo.prototype.get_pspm = function(row_index) {
  "use strict";
  if (row_index < 0 || row_index >= this.rows) {
    throw new Error("INDEX_OUT_OF_BOUNDS");
  }
  return this.pspm_list[row_index];
};

Logo.prototype.get_offset = function(row_index) {
  "use strict";
  if (row_index < 0 || row_index >= this.rows) {
    throw new Error("INDEX_OUT_OF_BOUNDS");
  }
  return this.pspm_column[row_index];
};

//======================================================================
// end Logo object
//======================================================================

//======================================================================
// start RasterizedAlphabet
//======================================================================

// Rasterize Alphabet
// 1) Measure width of text at default font for all symbols in alphabet
// 2) sort in width ascending
// 3) Drop the top and bottom 10% (designed to ignore outliers like 'W' and 'I')
// 4) Calculate the average as the maximum scaling factor (designed to stop I becoming a rectangular blob).
// 5) Assume scale of zero would result in width of zero, interpolate scale required to make perfect width font
// 6) Draw text onto temp canvas at calculated scale
// 7) Find bounds of drawn text
// 8) Paint on to another canvas at the desired height (but only scaling width to fit if larger).
var RasterizedAlphabet = function(alphabet, font, target_width) {
  "use strict";
  var default_size, safety_pad, canvas, ctx, middle, baseline, widths, count,
      letters, i, letter, size, tenpercent, avg_width, scale, 
      target_height, raster;
  //variable prototypes
  this.lookup = []; //a map of letter to index
  this.rasters = []; //a list of rasters
  this.dimensions = []; //a list of dimensions

  //construct
  default_size = 60; // size of square to assume as the default width
  safety_pad = 20; // pixels to pad around so we don't miss the edges
  // create a canvas to do our rasterizing on
  canvas = document.createElement("canvas");
  // assume the default font would fit in a canvas of 100 by 100
  canvas.width = default_size + 2 * safety_pad;
  canvas.height = default_size + 2 * safety_pad;
  // check for canvas support before attempting anything
  if (!canvas.getContext) {
    throw new Error("NO_CANVAS_SUPPORT");
  }
  ctx = canvas.getContext('2d');
  // check for html5 text drawing support
  if (!supports_text(ctx)) {
    throw new Error("NO_CANVAS_TEXT_SUPPORT");
  }
  // calculate the middle
  middle = Math.round(canvas.width / 2);
  // calculate the baseline
  baseline = Math.round(canvas.height - safety_pad);
  // list of widths
  widths = [];
  count = 0;
  letters = [];
  //now measure each letter in the alphabet
  for (i = 0; i < alphabet.get_size(); ++i) {
    if (alphabet.is_ambig(i)) {
      continue; //skip ambigs as they're never rendered
    }
    letter = alphabet.get_letter(i);
    letters.push(letter);
    this.lookup[letter] = count;
    //clear the canvas
    canvas.width = canvas.width;
    // get the context and prepare to draw our width test
    ctx = canvas.getContext('2d');
    ctx.font = font;
    ctx.fillStyle = alphabet.get_colour(i);
    ctx.textAlign = "center";
    ctx.translate(middle, baseline);
    // draw the test text
    ctx.fillText(letter, 0, 0);
    //measure
    size = canvas_bounds(ctx, canvas.width, canvas.height);
    if (size.width === 0) {
      throw new Error("INVISIBLE_LETTER"); //maybe the fill was white on white?
    }
    widths.push(size.width);
    this.dimensions[count] = size;
    count++;
  }
  //sort the widths
  widths.sort(function(a,b) {return a - b;});
  //drop 10% of the items off each end
  tenpercent = Math.floor(widths.length / 10);
  for (i = 0; i < tenpercent; ++i) {
    widths.pop();
    widths.shift();
  }
  //calculate average width
  avg_width = 0;
  for (i = 0; i < widths.length; ++i) {
    avg_width += widths[i];
  }
  avg_width /= widths.length;
  // calculate scales
  for (i = 0; i < this.dimensions.length; ++i) {
    size = this.dimensions[i];
    // calculate scale
    scale = target_width / Math.max(avg_width, size.width);
    // estimate scaled height
    target_height = size.height * scale;
    // create an approprately sized canvas
    raster = document.createElement("canvas");
    raster.width = target_width; // if it goes over the edge too bad...
    raster.height = target_height + safety_pad * 2;
    // calculate the middle
    middle = Math.round(raster.width / 2);
    // calculate the baseline
    baseline = Math.round(raster.height - safety_pad);
    // get the context and prepare to draw the rasterized text
    ctx = raster.getContext('2d');
    ctx.font = font;
    ctx.fillStyle = alphabet.get_colour(i);
    ctx.textAlign = "center";
    ctx.translate(middle, baseline);
    ctx.save();
    ctx.scale(scale, scale);
    // draw the rasterized text
    ctx.fillText(letters[i], 0, 0);
    ctx.restore();
    this.rasters[i] = raster;
    this.dimensions[i] = canvas_bounds(ctx, raster.width, raster.height);
  }
};

function canvas_bounds(ctx, cwidth, cheight) {
  "use strict";
  var data, r, c, top_line, bottom_line, left_line, right_line, 
      txt_width, txt_height;
  data = ctx.getImageData(0, 0, cwidth, cheight).data;
  r = 0; c = 0; // r: row, c: column
  top_line = -1; bottom_line = -1; left_line = -1; right_line = -1;
  txt_width = 0; txt_height = 0;
  // Find the top-most line with a non-white pixel
  for (r = 0; r < cheight; r++) {
    for (c = 0; c < cwidth; c++) {
      if (data[r * cwidth * 4 + c * 4 + 3]) {
        top_line = r;
        break;
      }
    }
    if (top_line != -1) {
      break;
    }
  }
  
  //find the last line with a non-white pixel
  if (top_line != -1) {
    for (r = cheight-1; r >= top_line; r--) {
      for(c = 0; c < cwidth; c++) {
        if(data[r * cwidth * 4 + c * 4 + 3]) {
          bottom_line = r;
          break;
        }
      }
      if (bottom_line != -1) {
        break;
      }
    }
    txt_height = bottom_line - top_line + 1;
  }

  // Find the left-most line with a non-white pixel
  for (c = 0; c < cwidth; c++) {
    for (r = 0; r < cheight; r++) {
      if (data[r * cwidth * 4 + c * 4 + 3]) {
        left_line = c;
        break;
      }
    }
    if (left_line != -1) {
      break;
    }
  }

  //find the right most line with a non-white pixel
  if (left_line != -1) {
    for (c = cwidth-1; c >= left_line; c--) {
      for(r = 0; r < cheight; r++) {
        if(data[r * cwidth * 4 + c * 4 + 3]) {
          right_line = c;
          break;
        }
      }
      if (right_line != -1) {
        break;
      }
    }
    txt_width = right_line - left_line + 1;
  }

  //return the bounds
  return {bound_top: top_line, bound_bottom: bottom_line, 
    bound_left: left_line, bound_right: right_line, width: txt_width, 
    height: txt_height};
}

RasterizedAlphabet.prototype.draw = function(ctx, letter, dx, dy, dWidth, dHeight) {
  "use strict";
  var index, raster, size;
  index = this.lookup[letter];
  raster = this.rasters[index];
  size = this.dimensions[index];
  ctx.drawImage(raster, 0, size.bound_top -1, raster.width, size.height+1, dx, dy, dWidth, dHeight);
};

//======================================================================
// end RasterizedAlphabet
//======================================================================

//======================================================================
// start LogoMetrics object
//======================================================================

var LogoMetrics = function(ctx, logo_columns, logo_rows, allow_space_for_names) {
  "use strict";
  var i, row_height;
  if (typeof allow_space_for_names === "undefined") {
    allow_space_for_names = false;
  }
  //variable prototypes
  this.pad_top = 5;
  this.pad_left = 10;
  this.pad_right = 5;
  this.pad_bottom = 0;
  this.pad_middle = 20;
  this.name_height = 14;
  this.name_font = "bold " + this.name_height + "px Times, sans-serif";
  this.name_spacer = 0;
  this.y_label = "bits";
  this.y_label_height = 12;
  this.y_label_font = "bold " + this.y_label_height + "px Helvetica, sans-serif";
  this.y_label_spacer = 3;
  this.y_num_height = 12;
  this.y_num_width = 0;
  this.y_num_font = "bold " + this.y_num_height + "px Helvetica, sans-serif";
  this.y_tic_width = 5;
  this.stack_pad_left = 0;
  this.stack_font = "bold 25px Helvetica, sans-serif";
  this.stack_height = 90;
  this.stack_width = 26;
  this.stacks_pad_right = 5;
  this.x_num_above = 2;
  this.x_num_height = 12;
  this.x_num_width = 0;
  this.x_num_font = "bold " + this.x_num_height + "px Helvetica, sans-serif";
  this.fine_txt_height = 6;
  this.fine_txt_above = 2;
  this.fine_txt_font = "normal " + this.fine_txt_height + "px Helvetica, sans-serif";
  this.letter_metrics = new Array();
  this.summed_width = 0;
  this.summed_height = 0;
  //calculate the width of the y axis numbers
  ctx.font = this.y_num_font;
  for (i = 0; i <= 2; i++) {
    this.y_num_width = Math.max(this.y_num_width, ctx.measureText("" + i).width);
  }
  //calculate the width of the x axis numbers (but they are rotated so it becomes height)
  ctx.font = this.x_num_font;
  for (i = 1; i <= logo_columns; i++) {
    this.x_num_width = Math.max(this.x_num_width, ctx.measureText("" + i).width);
  }
  
  //calculate how much vertical space we want to draw this
  //first we add the padding at the top and bottom since that's always there
  this.summed_height += this.pad_top + this.pad_bottom;
  //all except the last row have the same amount of space allocated to them
  if (logo_rows > 1) {
    row_height = this.stack_height + this.pad_middle;
    if (allow_space_for_names) {
      row_height += this.name_height;
      //the label is allowed to overlap into the spacer
      row_height += Math.max(this.y_num_height/2, this.name_spacer); 
      //the label is allowed to overlap the space used by the other label
      row_height += Math.max(this.y_num_height/2, this.x_num_height + this.x_num_above); 
    } else {
      row_height += this.y_num_height/2; 
      //the label is allowed to overlap the space used by the other label
      row_height += Math.max(this.y_num_height/2, this.x_num_height + this.x_num_above); 
    }
    this.summed_height += row_height * (logo_rows - 1);
  }
  //the last row has the name and fine text below it but no padding
  this.summed_height += this.stack_height + this.y_num_height/2;
  if (allow_space_for_names) {
    this.summed_height += this.fine_txt_height + this.fine_txt_above + this.name_height;
    this.summed_height += Math.max(this.y_num_height/2, 
        this.x_num_height + this.x_num_above + this.name_spacer);
  } else {
    this.summed_height += Math.max(this.y_num_height/2, 
        this.x_num_height + this.x_num_above + this.fine_txt_height + this.fine_txt_above);
  }

  //calculate how much horizontal space we want to draw this
  //first add the padding at the left and right since that's always there
  this.summed_width += this.pad_left + this.pad_right;
  //add on the space for the y-axis label
  this.summed_width += this.y_label_height + this.y_label_spacer;
  //add on the space for the y-axis
  this.summed_width += this.y_num_width + this.y_tic_width;
  //add on the space for the stacks
  this.summed_width += (this.stack_pad_left + this.stack_width) * logo_columns;
  //add on the padding after the stacks (an offset from the fine text)
  this.summed_width += this.stacks_pad_right;

};

//======================================================================
// end LogoMetrics object
//======================================================================

//found this trick at http://talideon.com/weblog/2005/02/detecting-broken-images-js.cfm
function image_ok(img) {
  "use strict";
  // During the onload event, IE correctly identifies any images that
  // weren't downloaded as not complete. Others should too. Gecko-based
  // browsers act like NS4 in that they report this incorrectly.
  if (!img.complete) {
    return false;
  }
  // However, they do have two very useful properties: naturalWidth and
  // naturalHeight. These give the true size of the image. If it failed
  // to load, either of these should be zero.
  if (typeof img.naturalWidth !== "undefined" && img.naturalWidth === 0) {
    return false;
  }
  // No other way of checking: assume it's ok.
  return true;
}
  
function supports_text(ctx) {
  "use strict";
  if (!ctx.fillText) {
    return false;
  }
  if (!ctx.measureText) {
    return false;
  }
  return true;
}

//draws the scale, returns the width
function draw_scale(ctx, metrics, alphabet_ic) {
  "use strict";
  var tic_height, i;
  tic_height = metrics.stack_height / alphabet_ic;
  ctx.save();
  ctx.lineWidth = 1.5;
  ctx.translate(metrics.y_label_height, metrics.y_num_height/2);
  //draw the axis label
  ctx.save();
  ctx.font = metrics.y_label_font;
  ctx.translate(0, metrics.stack_height/2);
  ctx.save();
  ctx.rotate(-(Math.PI / 2));
  ctx.textAlign = "center";
  ctx.fillText("bits", 0, 0);
  ctx.restore();
  ctx.restore();

  ctx.translate(metrics.y_label_spacer + metrics.y_num_width, 0);

  //draw the axis tics
  ctx.save();
  ctx.translate(0, metrics.stack_height);
  ctx.font = metrics.y_num_font;
  ctx.textAlign = "right";
  ctx.textBaseline = "middle";
  for (i = 0; i <= alphabet_ic; i++) {
    //draw the number
    ctx.fillText("" + i, 0, 0);
    //draw the tic
    ctx.beginPath();
    ctx.moveTo(0, 0);
    ctx.lineTo(metrics.y_tic_width, 0);
    ctx.stroke();
    //prepare for next tic
    ctx.translate(0, -tic_height);
  }
  ctx.restore();

  ctx.translate(metrics.y_tic_width, 0);

  ctx.beginPath();
  ctx.moveTo(0, 0);
  ctx.lineTo(0, metrics.stack_height);
  ctx.stroke();

  ctx.restore();
}

function draw_stack_num(ctx, metrics, row_index) {
  "use strict";
  ctx.save();
  ctx.font = metrics.x_num_font;
  ctx.translate(metrics.stack_width / 2, metrics.stack_height + metrics.x_num_above);
  ctx.save();
  ctx.rotate(-(Math.PI / 2));
  ctx.textBaseline = "middle";
  ctx.textAlign = "right";
  ctx.fillText("" + (row_index + 1), 0, 0);
  ctx.restore();
  ctx.restore();
}

function draw_stack(ctx, metrics, symbols, raster) {
  "use strict";
  var preferred_pad, sym_min, i, sym, sym_height, pad;
  preferred_pad = 0;
  sym_min = 5;

  ctx.save();//1
  ctx.translate(0, metrics.stack_height);
  for (i = 0; i < symbols.length; i++) {
    sym = symbols[i];
    sym_height = metrics.stack_height * sym.get_scale();
    
    pad = preferred_pad;
    if (sym_height - pad < sym_min) {
      pad = Math.min(pad, Math.max(0, sym_height - sym_min));
    }
    sym_height -= pad;

    //translate to the correct position
    ctx.translate(0, -(pad/2 + sym_height));
    //draw
    raster.draw(ctx, sym.get_symbol(), 0, 0, metrics.stack_width, sym_height);
    //translate past the padding
    ctx.translate(0, -(pad/2));
  }
  ctx.restore();//1
}

function draw_dashed_line(ctx, pattern, start, x1, y1, x2, y2) {
  "use strict";
  var x, y, len, i, dx, dy, tlen, theta, mulx, muly, lx, ly;
  dx = x2 - x1;
  dy = y2 - y1;
  tlen = Math.pow(dx*dx + dy*dy, 0.5);
  theta = Math.atan2(dy,dx);
  mulx = Math.cos(theta);
  muly = Math.sin(theta);
  lx = [];
  ly = [];
  for (i = 0; i < pattern; ++i) {
    lx.push(pattern[i] * mulx);
    ly.push(pattern[i] * muly);
  }
  i = start;
  x = x1;
  y = y1;
  len = 0;
  ctx.beginPath();
  while (len + pattern[i] < tlen) {
    ctx.moveTo(x, y);
    x += lx[i];
    y += ly[i];
    ctx.lineTo(x, y);
    len += pattern[i];
    i = (i + 1) % pattern.length;
    x += lx[i];
    y += ly[i];
    len += pattern[i];
    i = (i + 1) % pattern.length;
  }
  if (len < tlen) {
    ctx.moveTo(x, y);
    x += mulx * (tlen - len);
    y += muly * (tlen - len);
    ctx.lineTo(x, y);
  }
  ctx.stroke();
}

function draw_trim_background(ctx, metrics, pspm, offset) {
  "use strict";
  var lwidth, rwidth, mwidth, rstart;
  lwidth = metrics.stack_width * pspm.get_left_trim();
  rwidth = metrics.stack_width * pspm.get_right_trim();
  mwidth = metrics.stack_width * pspm.get_motif_length();
  rstart = mwidth - rwidth;
  ctx.save();//s8
  ctx.translate(offset * metrics.stack_width, 0);
  ctx.fillStyle = "rgb(240, 240, 240)";
  if (pspm.get_left_trim() > 0) {
    ctx.fillRect(0, 0, lwidth, metrics.stack_height);
  }
  if (pspm.get_right_trim() > 0) {
    ctx.fillRect(rstart, 0, rwidth, metrics.stack_height);
  }
  ctx.fillStyle = "rgb(51, 51, 51)";
  if (pspm.get_left_trim() > 0) {
    draw_dashed_line(ctx, [3], 0, lwidth-0.5, 0, lwidth-0.5,  metrics.stack_height);
  }
  if (pspm.get_right_trim() > 0) {
    draw_dashed_line(ctx, [3], 0, rstart+0.5, 0, rstart+0.5,  metrics.stack_height);
  }
  ctx.restore();//s8
}

function size_logo_on_canvas(logo, canvas, show_names, scale) {
  "use strict";
  var draw_name, metrics;
  draw_name = (typeof show_names === "boolean" ? show_names : (logo.get_rows() > 1));
  if (canvas.width !== 0 && canvas.height !== 0) {
    return;
  }
  metrics = new LogoMetrics(canvas.getContext('2d'), 
      logo.get_columns(), logo.get_rows(), draw_name);
  if (typeof scale == "number") {
    //resize the canvas to fit the scaled logo
    canvas.width = metrics.summed_width * scale;
    canvas.height = metrics.summed_height * scale;
  } else {
    if (canvas.width === 0 && canvas.height === 0) {
      canvas.width = metrics.summed_width;
      canvas.height = metrics.summed_height;
    } else if (canvas.width === 0) {
      canvas.width = metrics.summed_width * (canvas.height / metrics.summed_height);
    } else if (canvas.height === 0) {
      canvas.height = metrics.summed_height * (canvas.width / metrics.summed_width);
    }
  }
}

function draw_logo_on_canvas(logo, canvas, show_names, scale) {
  "use strict";
  var draw_name, ctx, metrics, raster, pspm_i, pspm, 
      offset, col_index, motif_position;
  draw_name = (typeof show_names === "boolean" ? show_names : (logo.get_rows() > 1));
  ctx = canvas.getContext('2d');
  //assume that the user wants the canvas scaled equally so calculate what the best width for this image should be
  metrics = new LogoMetrics(ctx, logo.get_columns(), logo.get_rows(), draw_name);
  if (typeof scale == "number") {
    //resize the canvas to fit the scaled logo
    canvas.width = metrics.summed_width * scale;
    canvas.height = metrics.summed_height * scale;
  } else {
    if (canvas.width === 0 && canvas.height === 0) {
      scale = 1;
      canvas.width = metrics.summed_width;
      canvas.height = metrics.summed_height;
    } else if (canvas.width === 0) {
      scale = canvas.height / metrics.summed_height;
      canvas.width = metrics.summed_width * scale;
    } else if (canvas.height === 0) {
      scale = canvas.width / metrics.summed_width;
      canvas.height = metrics.summed_height * scale;
    } else {
      scale = Math.min(canvas.width / metrics.summed_width, canvas.height / metrics.summed_height);
    }
  }
  // cache the raster based on the assumption that we will be drawing a lot
  // of logos the same size
  if (typeof draw_logo_on_canvas.raster_scale === "number" && 
      Math.abs(draw_logo_on_canvas.raster_scale - scale) < 0.1) {
    raster = draw_logo_on_canvas.raster_cache;
  } else {
    raster = new RasterizedAlphabet(logo.alphabet, metrics.stack_font, metrics.stack_width * scale * 2);
    draw_logo_on_canvas.raster_cache = raster;
    draw_logo_on_canvas.raster_scale = scale;
  }
  ctx = canvas.getContext('2d');
  ctx.save();//s1
  ctx.scale(scale, scale);
  ctx.save();//s2
  ctx.save();//s7
  //create margin
  ctx.translate(metrics.pad_left, metrics.pad_top);
  for (pspm_i = 0; pspm_i < logo.get_rows(); ++pspm_i) {
    pspm = logo.get_pspm(pspm_i);
    offset = logo.get_offset(pspm_i);
    //optionally draw name if this isn't the last row or is the only row 
    if (draw_name && (logo.get_rows() == 1 || pspm_i != (logo.get_rows()-1))) {
      ctx.save();//s4
      ctx.translate(metrics.summed_width/2, metrics.name_height);
      ctx.font = metrics.name_font;
      ctx.textAlign = "center";
      ctx.fillText(pspm.name, 0, 0);
      ctx.restore();//s4
      ctx.translate(0, metrics.name_height + 
          Math.min(0, metrics.name_spacer - metrics.y_num_height/2));
    }
    //draw scale
    draw_scale(ctx, metrics, logo.alphabet.get_ic());
    ctx.save();//s5
    //translate across past the scale
    ctx.translate(metrics.y_label_height + metrics.y_label_spacer + 
        metrics.y_num_width + metrics.y_tic_width, 0);
    //draw the trimming background
    if (pspm.get_left_trim() > 0 || pspm.get_right_trim() > 0) {
      draw_trim_background(ctx, metrics, pspm, offset);
    }
    //draw letters
    ctx.translate(0, metrics.y_num_height / 2);
    for (col_index = 0; col_index < logo.get_columns(); col_index++) {
      ctx.translate(metrics.stack_pad_left,0);
      if (col_index >= offset && col_index < (offset + pspm.get_motif_length())) {
        motif_position = col_index - offset;
        draw_stack_num(ctx, metrics, motif_position);
        draw_stack(ctx, metrics, pspm.get_stack(motif_position, logo.alphabet), raster);
      }
      ctx.translate(metrics.stack_width, 0);
    }
    ctx.restore();//s5
    ////optionally draw name if this is the last row but isn't the only row 
    if (draw_name && (logo.get_rows() != 1 && pspm_i == (logo.get_rows()-1))) {
      //translate vertically past the stack and axis's        
      ctx.translate(0, metrics.y_num_height/2 + metrics.stack_height + 
          Math.max(metrics.y_num_height/2, metrics.x_num_above + metrics.x_num_width + metrics.name_spacer));

      ctx.save();//s6
      ctx.translate(metrics.summed_width/2, metrics.name_height);
      ctx.font = metrics.name_font;
      ctx.textAlign = "center";
      ctx.fillText(pspm.name, 0, 0);
      ctx.restore();//s6
      ctx.translate(0, metrics.name_height);
    } else {
      //translate vertically past the stack and axis's        
      ctx.translate(0, metrics.y_num_height/2 + metrics.stack_height + 
          Math.max(metrics.y_num_height/2, metrics.x_num_above + metrics.x_num_width));
    }
    //if not the last row then add middle padding
    if (pspm_i != (logo.get_rows() -1)) {
      ctx.translate(0, metrics.pad_middle);
    }
  }
  ctx.restore();//s7
  ctx.translate(metrics.summed_width - metrics.pad_right, metrics.summed_height - metrics.pad_bottom);
  ctx.font = metrics.fine_txt_font;
  ctx.textAlign = "right";
  ctx.fillText(logo.fine_text, 0,0);
  ctx.restore();//s2
  ctx.restore();//s1
}

function create_canvas(c_width, c_height, c_id, c_title, c_display) {
  "use strict";
  var canvas = document.createElement("canvas");
  //check for canvas support before attempting anything
  if (!canvas.getContext) {
    return null;
  }
  var ctx = canvas.getContext('2d');
  //check for html5 text drawing support
  if (!supports_text(ctx)) {
    return null;
  }
  //size the canvas
  canvas.width = c_width;
  canvas.height = c_height;
  canvas.id = c_id;
  canvas.title = c_title;
  canvas.style.display = c_display;
  return canvas;
}

function logo_1(alphabet, fine_text, pspm) {
  "use strict";
  var logo = new Logo(alphabet, fine_text);
  logo.add_pspm(pspm);
  return logo;
}

function logo_2(alphabet, fine_text, target, query, query_offset) {
  "use strict";
  var logo = new Logo(alphabet, fine_text);
  if (query_offset < 0) {
    logo.add_pspm(target, -query_offset);
    logo.add_pspm(query);
  } else {
    logo.add_pspm(target);
    logo.add_pspm(query, query_offset);
  }      
  return logo;
}

/*
 * Specifies an alternate source for an image.
 * If the image with the image_id specified has
 * not loaded then a generated logo will be used 
 * to replace it.
 *
 * Note that the image must either have dimensions
 * or a scale must be set.
 */
function alternate_logo(logo, image_id, scale) {
  "use strict";
  var image = document.getElementById(image_id);
  if (!image) {
    alert("Can't find specified image id (" +  image_id + ")");
    return;
  }
  //if the image has loaded then there is no reason to use the canvas
  if (image_ok(image)) {
    return;
  }
  //the image has failed to load so replace it with a canvas if we can.
  var canvas = create_canvas(image.width, image.height, image_id, image.title, image.style.display);
  if (canvas === null) {
    return;
  }
  //draw the logo on the canvas
  draw_logo_on_canvas(logo, canvas, null, scale);
  //replace the image with the canvas
  image.parentNode.replaceChild(canvas, image);
}

/*
 * Specifes that the element with the specified id
 * should be replaced with a generated logo.
 */
function replace_logo(logo, replace_id, scale, title_txt, display_style) {
  "use strict";
  var element = document.getElementById(replace_id);
  if (!replace_id) {
    alert("Can't find specified id (" + replace_id + ")");
    return;
  }
  //found the element!
  var canvas = create_canvas(50, 120, replace_id, title_txt, display_style);
  if (canvas === null) {
    return;
  }
  //draw the logo on the canvas
  draw_logo_on_canvas(logo, canvas, null, scale);
  //replace the element with the canvas
  element.parentNode.replaceChild(canvas, element);
}

/*
 * Fast string trimming implementation found at
 * http://blog.stevenlevithan.com/archives/faster-trim-javascript
 *
 * Note that regex is good at removing leading space but
 * bad at removing trailing space as it has to first go through
 * the whole string.
 */
function trim (str) {
  "use strict";
  var ws, i;
  str = str.replace(/^\s\s*/, '');
  ws = /\s/; i = str.length;
  while (ws.test(str.charAt(--i)));
  return str.slice(0, i + 1);
}
</script>
    <script>
var LEGEND_LINE = 16;
var LEGEND_FONT = "Helvetica";
var LEGEND_PAD = 5;

var Dasher = function(ctx, start_x, start_y, pattern) {
  if (typeof pattern === "undefined") pattern = [];
  this.ctx = ctx;
  this.x = start_x;
  this.y = start_y;
  this.pattern = pattern;
  this.index = 0;     // where in the pattern are we up to?
  this.fragment = 0;  // how much of the current pattern have we drawn
  this.on = true;     // pen on paper?
  ctx.moveTo(start_x, start_y);
};

Dasher.prototype.dashTo = function(x, y) {
  var dx = x - this.x;
  var dy = y - this.y;
  var d = Math.pow(dx * dx + dy * dy, 0.5);
  if (this.pattern.length == 0) {
    // when no pattern is specified this just draws lines
    this.ctx.lineTo(x, y);
  } else {
    // calculate distance to complete dash
    var dc = this.pattern[this.index] - this.fragment;
    while (dc <= d) {
      // calculate the fraction of the line needed
      var f = dc / d;
      this.x += dx * f;
      this.y += dy * f;
      if (this.on) {
        this.ctx.lineTo(this.x, this.y);
      } else {
        this.ctx.moveTo(this.x, this.y);
      }
      // move to the next dash
      this.fragment = 0;
      // skip empty dashes, just toggling on state
      do {
        this.index = (this.index + 1) % this.pattern.length;
        this.on = !this.on;
      } while (this.pattern[this.index] <= 0);
      // update variables
      dc = this.pattern[this.index];
      dx = x - this.x;
      dy = y - this.y;
      d = Math.pow(dx * dx + dy * dy, 0.5);
    }
    this.fragment += d;
    this.x = x;
    this.y = y;
    if (this.on) {
      this.ctx.lineTo(this.x, this.y);
    } else {
      this.ctx.moveTo(this.x, this.y);
    }
  }
}

var CentrimoResult = function(name, sig, colour, motif_length, 
    total_sites, site_counts, neg_total_sites, neg_site_counts) {
  "use strict";
  if (typeof name === "undefined") {
    name = "";
  }
  if (typeof sig === "undefined") {
    sig = "";
  }
  if (typeof colour == "undefined") {
    colour = "#000000";
  }
  this.name = name;
  this.sig = sig;
  this.colour = colour;
  this.motif_length = motif_length;
  this.total_sites = total_sites;
  this.site_counts = site_counts;
  this.has_neg = (typeof neg_total_sites === "number" && 
      typeof neg_site_counts === "object" && neg_site_counts instanceof Array);
  this.neg_total_sites = neg_total_sites;
  this.neg_site_counts = neg_site_counts;
};

/*
 * CentrimoRSet
 * Construct a centrimo result set.
 */
var CentrimoRSet = function(sequence_length) {
  "use strict";
  this.sequence_length = sequence_length;
  this.results = [];
};

/*
 * seq_len
 * Get the sequence length of the result set.
 */
CentrimoRSet.prototype.seq_len = function() {
  "use strict";
  return this.sequence_length;
};

/*
 * add
 * Add a centrimo result to the set
 */
CentrimoRSet.prototype.add = function(name, sig, colour, motif_length, 
    total_sites, site_counts, neg_total_sites, neg_site_counts) {
  "use strict";
  this.results.push(new CentrimoResult(name, sig, colour, motif_length, 
    total_sites, site_counts, neg_total_sites, neg_site_counts));
};

/*
 * count
 * Return the count of centrimo results.
 */
CentrimoRSet.prototype.count = function() {
  "use strict";
  return this.results.length;
};

/*
 *  get
 *  Get an entry in the result set.
 */
CentrimoRSet.prototype.get = function(index) {
  "use strict";
  return this.results[index];
};

/*
 * CentrimoLine
 */
var CentrimoLine = function(name, sig, colour, dash, thickness, show_on_legend, xlist, ylist) {
  "use strict";
  if (xlist.length != ylist.length) {
    throw new Error("The list of x and y points must be the same length.");
  }
  this.xlist = xlist;
  this.ylist = ylist;
  this.name = name;
  this.sig = sig;
  this.colour = colour;
  this.dash = dash;
  this.thickness = thickness;
  this.show_on_legend = show_on_legend;
  this.max_prob = -1;
};

/*
 * trim
 *
 * Removes points from the ends so the lines are the same length.
 */
CentrimoLine.prototype.trim = function(left, right) {
  "use strict";
  var lefti, righti, gradient, gap, left_y, right_y;
  if (typeof left !== "number"|| isNaN(left)) {
    throw new Error("left trim is not a number");
  }
  if (typeof right !== "number" || isNaN(right)) {
    throw new Error("right trim is not a number");
  }
  for (lefti = 0; lefti < this.xlist.length; lefti++) {
    if (this.xlist[lefti] >= left) {
      break;
    }
  }
  if (lefti === 0 && this.xlist[0] !== left) {
    throw new Error("Attempt to undertrim line.");
  }
  for (righti = this.xlist.length - 1; righti >= 0; righti--) {
    if (this.xlist[righti] <= right) {
      break;
    }
  }
  if (righti === (this.xlist.length - 1) && this.xlist[righti] !== right) {
    throw new Error("Attempt to undertrim line.");
  }
  if (lefti == this.xlist.length || righti == -1) {
    // all points outside of drawable region
    this.xlist = [];
    this.ylist = [];
    return;
  }
  if (this.xlist[lefti] != left) {
    // create a new point that is exactly at left by interpolating
    gradient = (this.ylist[lefti] - this.ylist[lefti-1]) / 
      (this.xlist[lefti] - this.xlist[lefti-1]);
    gap = left - this.xlist[lefti-1];
    left_y = this.ylist[lefti-1] + gradient * gap;
    this.xlist.splice(0, lefti, left);
    this.ylist.splice(0, lefti, left_y);
    righti = righti - lefti + 1;
  } else {
    this.xlist.splice(0, lefti);
    this.ylist.splice(0, lefti);
    righti -= lefti;
  }
  if (this.xlist[righti] != right) {
    // create a new point that is exactly at right by interpolating
    gradient = (this.ylist[righti + 1] - this.ylist[righti]) /
      (this.xlist[righti + 1] - this.xlist[righti]);
    gap = right - this.xlist[righti];
    right_y = this.ylist[righti] + gradient * gap;
    // truncate the lists
    this.xlist.length = righti + 1;
    this.ylist.length = righti + 1;
    // push the new item on the end of the lists
    this.xlist.push(right);
    this.ylist.push(right_y);
  } else {
    // truncate the lists
    this.xlist.length = righti + 1;
    this.ylist.length = righti + 1;
  }
  this.max_prob = -1;
};

CentrimoLine.prototype.max = function() {
  "use strict";
  var y_max, i;
  if (this.max_prob != -1) {
    return this.max_prob;
  }
  y_max = 0;
  for (i = 0; i < this.xlist.length; i++) {
    if (this.ylist[i] > y_max) {
      y_max = this.ylist[i];
    }
  }
  this.max_prop = y_max;
  return this.max_prop;
};

/*
 * CentrimoScale
 *
 * Calculates the increments on the y axis
 */
var CentrimoScale = function(max_prob) {
  "use strict";
  var decimals, inc, rounder, max, inc_plus;
  if (max_prob === 0) {
    this.max = 0.01;
    this.inc = 0.002;
    this.digits = 3;
    return;
  }
  // find the minimum number of decimals needed to display the largest
  // digit of the maximum probability
  decimals = Math.ceil(-(Math.log(max_prob) / Math.log(10)));
  // calculate an increment which is (at minimum) 10 times smaller the the max
  inc = Math.pow(10, -(decimals+1));
  // round-up the maximum probabilty to its largest digit
  rounder = Math.pow(10, decimals);
  max = Math.ceil(max_prob * rounder) / rounder;
  // adjust the increment so it's between 5 and 12 times the maximum
  // probability
  if (inc * 5 < max && inc * 12 > max) {
    inc *= 1;
  } else if (inc * 10 < max && inc * 24 > max) {
    inc *= 2;
  } else if (inc * 25 < max && inc * 60 > max) {
    inc *= 5;
  } else if (inc * 50 < max && inc * 120 > max) {
    inc *= 10;
  }
  max += inc;
  inc_plus = (1.125 * inc);
  while (max - inc_plus > max_prob) {
    max -= inc;
  }
  this.max = max;
  this.inc = inc;
  this.digits = decimals+1;
};

var CentrimoLegendMetrics = function(lw, lh, id_w, pv_w, sq_w) {
  "use strict";
  this.width = lw;
  this.height = lh;
  this.id_width = id_w;
  this.pv_width = pv_w;
  this.sq_width = sq_w;
};

var CentrimoGraphMetrics = function(legend_metrics, top_edge, bottom_edge,
    left_mark, left_val, right_mark, right_val) {
  if (typeof legend_metrics !== "object" || legend_metrics === null) {
    this.legend_width = 10;
    this.legend_height = 10;
  } else {
    this.legend_width = legend_metrics.width;
    this.legend_height = legend_metrics.height;
  }
  this.top_edge = top_edge;
  this.bottom_edge = bottom_edge;
  this.left_mark = left_mark;
  this.left_val = left_val;
  this.right_mark = right_mark;
  this.right_val = right_val;
};

/*
 * CentrimoGraph
 * Takes a results set and a window weight array and produces a graph. 
 * The weights in the window_weights should be non-negative and sum to 1.
 */
var CentrimoGraph = function(rset, window_weights, fine_text, start, end) {
  "use strict";
  var trim_left, trim_right, i, j, k, result, x, y, xpos, ypos, positions;
  var y_neg, ypos_neg, line_thickness;

  line_thickness = (window_weights.length < 10 ? 1 : 3);
  if (typeof fine_text !== "string") {
    fine_text = "";
  }
  this.fine_text = fine_text;
  this.lines = [];
  for (i = 0; i < rset.count(); i++) {
    result = rset.get(i);
    x = [];
    y = [];
    if (result.has_neg) {
      y_neg = [];
    }
    xpos = (result.motif_length - rset.seq_len() + window_weights.length) / 2;
    if (typeof trim_left === "undefined") {
      trim_left = xpos;
    } else if (trim_left < xpos) {
      trim_left = xpos;
    }
    positions = result.site_counts.length - window_weights.length + 1;
    for (j = 0; j < positions; j++, xpos += 1) {
      ypos = 0;
      // avoid division by zero when no sites are found
      if (result.total_sites > 0) {
        for (k = 0; k < window_weights.length; k++) {
          ypos += window_weights[k] * result.site_counts[j + k];
        }
        ypos /= result.total_sites;
      }
      x.push(xpos);
      y.push(ypos);
      // handle the negative dataset
      if (result.has_neg) {
        ypos_neg = 0;
        if (result.neg_total_sites > 0) {
          for (k = 0; k < window_weights.length; k++) {
            ypos_neg += window_weights[k] * result.neg_site_counts[j + k];
          }
          ypos_neg /= result.neg_total_sites;
        }
        y_neg.push(ypos_neg);
      }
    }
    this.lines.push(new CentrimoLine(result.name, result.sig, result.colour, [], line_thickness, true, x, y));
    if (result.has_neg) {
      this.lines.push(new CentrimoLine(result.name, result.sig, result.colour, [6,4], 2, false, x.slice(0), y_neg));
    }
    if (positions > 0) {
      if (typeof trim_right === "undefined") {
        trim_right = xpos - 1;
      } else if (trim_right > (xpos - 1)) {
        trim_right = xpos - 1;
      }
    }
  }
  if (typeof start !== "undefined") {
    if (start > trim_left) {
      trim_left = start;
    }
    this.start = start;
  } else {
    this.start = -Math.ceil(rset.seq_len() / 2);
  }
  if (typeof end !== "undefined") {
    if (end < trim_right) {
      trim_right = end;
    }
    this.end = end;
  } else {
    this.end = Math.floor(rset.seq_len() / 2);
  }
  this.max_prob = 0;
  for (i = 0; i < this.lines.length; i++) {
    this.lines[i].trim(trim_left, trim_right);
    this.max_prob = Math.max(this.max_prob, this.lines[i].max());
  }
  this.scale = new CentrimoScale(this.max_prob);
};

/*
 * draw_graph
 *
 * Draws a motif probability graph
 */
CentrimoGraph.prototype.draw_graph = function (ctx, w, h, draw_legend, legend_x, legend_y) {
  "use strict";
  var gap, l_margin, t_margin, b_margin, r_margin, legend_metrics, 
      legend_width, legend_height;
  gap = 10;
  l_margin = gap + 30 + 10 * (2 + this.scale.digits);
  t_margin = 20;
  b_margin = 60;
  r_margin = 10;
  legend_metrics = this.measure_legend(ctx);
  // setting global
  legend_width = legend_metrics.width;
  legend_height = legend_metrics.height;
  // constrain legend to within graph area
  legend_x = Math.round(legend_x);
  legend_y = Math.round(legend_y);
  if (legend_x < (l_margin + gap)) {
    legend_x = l_margin + gap;
  } else if ((legend_x + legend_metrics.width) > (w - r_margin - gap)) {
    legend_x = w - r_margin - legend_metrics.width - gap;
  }
  if (legend_y < (t_margin + gap)) {
    legend_y = t_margin + gap;
  } else if ((legend_y + legend_metrics.height) > (h - b_margin - gap)) {
    legend_y = h - b_margin - legend_metrics.height - gap;
  }

  // draw graph
  ctx.save();
  // draw border
  ctx.beginPath();
  ctx.moveTo(l_margin - 0.5, t_margin +0.5);
  ctx.lineTo(l_margin - 0.5, h - (b_margin - 0.5));
  ctx.lineTo(w - r_margin - 0.5, h - (b_margin - 0.5));
  ctx.lineTo(w - r_margin - 0.5, t_margin +0.5);
  ctx.closePath();
  ctx.stroke();
  // draw fineprint
  ctx.save();
  ctx.font = "9px Helvetica";
  ctx.textAlign = "right";
  ctx.textBaseline = "bottom";
  ctx.fillText(this.fine_text, w - 1, h - 2);
  ctx.restore();
  // draw y axis
  ctx.save();
  ctx.translate(l_margin, t_margin);
  this.draw_y_axis(ctx, 0, h - (t_margin + b_margin));
  ctx.restore();
  // draw y labels
  ctx.save();
  ctx.translate(gap, t_margin);
  this.draw_y_axis_label(ctx, l_margin, h - (t_margin + b_margin));
  ctx.restore();
  // draw x axis
  ctx.save();
  ctx.translate(l_margin, h - b_margin);
  this.draw_x_axis(ctx, w - (l_margin + r_margin), b_margin);
  ctx.restore();
  // draw top axis
  ctx.save();
  ctx.translate(l_margin, t_margin);
  this.draw_top_axis(ctx, w - (l_margin + r_margin), 0);
  ctx.restore();
  // draw x axis labels
  ctx.save();
  ctx.translate(l_margin, h - b_margin);
  this.draw_x_axis_label(ctx, w - (l_margin + r_margin), b_margin - gap);
  ctx.restore();
  // draw lines
  ctx.save();
  ctx.translate(l_margin, t_margin);
  this.draw_lines(ctx, w - (l_margin + r_margin), h - (t_margin + b_margin), 8);
  ctx.restore();
  // draw legend
  if (draw_legend) { 
    ctx.save();
    ctx.translate(legend_x, legend_y);
    this.draw_legend(ctx, legend_metrics);
    ctx.restore();
  }
  ctx.restore();
  return new CentrimoGraphMetrics(legend_metrics, t_margin, h - b_margin,
      l_margin, this.start, w - r_margin, this.end);
};

/*
 * draw_x_axis
 *
 * TODO this currently only supports symmetrical graphs
 * and needs to be updated.
 */
CentrimoGraph.prototype.draw_x_axis = function(ctx, w, h) {
  "use strict";
  var length, tick_max, nticks, tick_inc, scale_x, i, x;
  ctx.save();
  ctx.translate(w / 2, 0);
  length = this.end - this.start;
  tick_max = length / 2;
  nticks = 5;
  tick_inc = Math.round(tick_max / (10*nticks)) * 10;
  scale_x = w / length;
  ctx.beginPath();
  ctx.moveTo(0.5, -5);
  ctx.lineTo(0.5, 3);
  ctx.stroke();
  ctx.font = "14pt Helvetica";
  ctx.textBaseline = "top";
  ctx.textAlign = "center";
  ctx.fillText("0", 0, 5);
  for (i = tick_inc; i < tick_max; i += tick_inc) {
    x = Math.round(i * scale_x) + 0.5;
    ctx.beginPath();
    ctx.moveTo(x, -5);
    ctx.lineTo(x, 3);
    ctx.stroke();
    ctx.fillText(""+i, x, 5);
    ctx.beginPath();
    ctx.moveTo(-x, -5);
    ctx.lineTo(-x, 3);
    ctx.stroke();
    ctx.fillText(""+(-i), -x, 5);
  }
  ctx.restore();
};

/*
 * draw_top_axis
 *
 * TODO this currently only supports symmetrical graphs.
 */
CentrimoGraph.prototype.draw_top_axis = function(ctx, w, h) {
  "use strict";
  var length, tick_max, scale_x, i, x;
  ctx.save();
  ctx.translate(w / 2, 0);
  length = this.end - this.start;
  tick_max = length / 2;
  scale_x = w / length;
  ctx.beginPath();
  ctx.moveTo(0.5, 0);
  ctx.lineTo(0.5, 8);
  ctx.stroke();
  for (i = 50; i < tick_max; i += 50) {
    x = Math.round(i * scale_x) + 0.5;
    ctx.beginPath();
    ctx.moveTo(x, 0);
    ctx.lineTo(x, 8);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(-x, 0);
    ctx.lineTo(-x, 8);
    ctx.stroke();
  }
  ctx.restore();
};

/*
 * draw_x_axis_label
 */
CentrimoGraph.prototype.draw_x_axis_label = function(ctx, w, h) {
  "use strict";
  ctx.save();
  ctx.font = "14pt Helvetica";
  ctx.textAlign = "center";
  ctx.textBaseline = "bottom";
  ctx.fillText("Position of Best Site in Sequence", w/2, h);
  ctx.restore();
};

/*
 * draw_y_axis
 *
 * TODO some work needs to be done to allow moving the zero
 */
CentrimoGraph.prototype.draw_y_axis = function(ctx, w, h) {
  "use strict";
  var y_scale, p, y;
  ctx.save();
  ctx.font = "14pt Helvetica";
  ctx.textBaseline = "middle";
  ctx.textAlign = "right";

  y_scale = h / this.scale.max;
  for (p = 0; p < this.scale.max; p += this.scale.inc) {
    y = Math.round(h - p * y_scale) + 0.5;
    this.draw_y_tic(ctx, this.scale.digits, y, p);
  }
  this.draw_y_tic(ctx, this.scale.digits, 0.5, this.scale.max);

  ctx.restore();
};

/*
 * draw_y_tic
 */
CentrimoGraph.prototype.draw_y_tic = function(ctx, digits, y, p) {
  "use strict";
  ctx.beginPath();
  ctx.moveTo(5, y);
  ctx.lineTo(-3, y);
  ctx.stroke();
  ctx.fillText(p.toFixed(digits), -5, y);
};

/*
 * draw_y_axis_label
 */
CentrimoGraph.prototype.draw_y_axis_label = function(ctx, w, h) {
  "use strict";
  ctx.save();
  ctx.translate(0, h/2);
  ctx.rotate(-Math.PI / 2);
  ctx.font = "14pt Helvetica";
  ctx.textBaseline = "top";
  ctx.textAlign = "center";
  ctx.fillText("Probability", 0, 0);
  ctx.restore();
};

/*
 * draw_lines
 */
CentrimoGraph.prototype.draw_lines = function(ctx, w, h, tic_size) {
  "use strict";
  var scale_y, scale_x, i, line, x_points, y_points, j, x, y, dasher;
  if (typeof tic_size === "undefined") {
    tic_size = 0;
  }
  scale_y = h / this.scale.max;
  scale_x = w / (this.end - this.start);
  ctx.save();
  ctx.translate((-this.start) * scale_x, 0);
  ctx.strokeStyle = '#DDD';
  ctx.beginPath();
  ctx.moveTo(0.5, tic_size);
  ctx.lineTo(0.5, h - tic_size);
  ctx.stroke();
  ctx.restore();
  ctx.save();
  ctx.lineJoin = "bevel";
  ctx.miterLimit = 0;
  for (i = 0; i < this.lines.length; i++) {
    line = this.lines[i];
    ctx.lineWidth = line.thickness;
    x_points = line.xlist;
    y_points = line.ylist;
    ctx.strokeStyle = line.colour;
    ctx.beginPath();
    for (j = 0; j < x_points.length; j++) {
      if (isNaN(x_points[j])) {
        throw new Error("X NaN!");
      }
      if (isNaN(y_points[j])) {
        throw new Error("Y NaN!");
      }
      x = (x_points[j] - this.start) * scale_x;
      y = h - y_points[j] * scale_y;
      if (j === 0) {
        dasher = new Dasher(ctx, x, y, line.dash);
      } else {
        dasher.dashTo(x, y);
      }
    }
    ctx.stroke();
  }
  ctx.restore();
};

/*
 * measure_legend
 */
CentrimoGraph.prototype.measure_legend = function(ctx) {
  "use strict";
  var lw, lh, sq_w, id_w, pv_w, lines, i, line, len;
  // initilise the line height to the size of the padding
  lh = 2 * LEGEND_PAD;
  // calculate the column widths
  sq_w = LEGEND_LINE - 2;
  id_w = 0;
  pv_w = 0;
  ctx.save();
  ctx.font = "" + LEGEND_LINE + "px " + LEGEND_FONT; 
  for (i = 0; i < this.lines.length; i++) {
    line = this.lines[i];
    if (!line.show_on_legend) {
      continue;
    }
    lh += LEGEND_LINE * 1.2;
    len = ctx.measureText(line.name).width;
    if (id_w < len) {
      id_w = len;
    }
    len = ctx.measureText(line.sig).width;
    if (pv_w < len) {
      pv_w = len;
    }
  }
  lh = Math.round(lh);
  ctx.restore();
  // legend width is a function of the column widths
  lw = id_w + pv_w + sq_w + 4 * LEGEND_PAD;

  return new CentrimoLegendMetrics(lw, lh, id_w, pv_w, sq_w);
};

/*
 * draw_legend
 */
CentrimoGraph.prototype.draw_legend = function(ctx, metrics) {
  "use strict";
  var ln_h, pad, w, h, id_w, pv_w, sq_w, id_x, pv_x, sq_x, i, line;
  if (this.lines.length === 0) {
    return;
  }
  ln_h = LEGEND_LINE;
  pad = LEGEND_PAD;
  w = metrics.width;
  h = metrics.height;
  id_w = metrics.id_width;
  pv_w = metrics.pv_width;
  sq_w = metrics.sq_width;
  id_x = 0;
  pv_x = id_x + id_w + pad;
  sq_x = pv_x + pv_w + pad;

  ctx.save();
  ctx.font = "" + ln_h + "px " + LEGEND_FONT;
  ctx.textAlign = "left";
  ctx.textBaseline = "alphabetic";
  // draw it
  ctx.save();
  ctx.fillStyle = 'white';
  ctx.fillRect(0.5, 0.5, w-1, h-1);
  ctx.strokeStyle = 'black';
  ctx.strokeRect(0.5, 0.5, w-1, h-1);
  ctx.restore();
  ctx.translate(pad, pad);
  ctx.fillStyle = "black";
  for (i = 0; i < this.lines.length; i++) {
    line = this.lines[i];
    if (!line.show_on_legend) {
      continue;
    }
    ctx.translate(0, ln_h);
    ctx.save();
    ctx.fillStyle = line.colour;
    ctx.fillRect(sq_x, -sq_w + 0.1 * ln_h, sq_w, sq_w);
    ctx.restore();
    ctx.fillText(line.name, id_x, 0);
    ctx.fillText(line.sig, pv_x, 0);
    ctx.translate(0, 0.2 * ln_h);
  }
  ctx.restore();
};

/*
 * triangular_weights
 * Returns an array of length n containing normalized weights.
 *
 */
function triangular_weights(n) {
  "use strict";
  var weights, half, half_i, sum, i, unscaled_weight;
  weights = [];
  half = n/2;
  half_i = Math.floor(half);
  sum = 0;
  for (i = 0; i < half_i; i++) {
    unscaled_weight = (i + 0.5) / half;
    weights[i] = unscaled_weight;
    weights[n - i -1] = unscaled_weight;
    sum += 2 * unscaled_weight;
  }
  if (n % 2 == 1) {
    weights[half_i] = 1;
    sum += 1;
  }
  // normalize
  for (i = 0; i < n; i++) {
    weights[i] /= sum;
  }
  return weights;
}

/*
 * uniform_weights
 * Returns an array of length n containing normalized weights.
 *
 */
function uniform_weights(n) {
  "use strict";
  var weights, weight, i;
  weights = [];
  weight = 1.0 / n;
  for (i = 0; i < n; i++) {
    weights[i] = weight;
  }
  return weights;
}
</script>
    <script>
      // 
      // return true if any part of the passed element is visible in the viewport
      //
      function element_in_viewport(elem) {
        var rect = elem.getBoundingClientRect();
        return (
            rect.top < (window.innerHeight || document.body.clientHeight) &&
            rect.bottom > 0 &&
            rect.left < (window.innerWidth || document.body.clientWidth) &&
            rect.right > 0
            );
      }

      //
      // Functions to delay a drawing task until it is required or it would not lag the display to do so
      //

      // a list of items still to be drawn
      var drawable_list = [];
      // the delay between drawing objects that are not currently visible
      var draw_delay = 1;
      // the delay after a user interaction
      var user_delay = 300;
      // the delay after a user has stopped scrolling and is viewing the stuff drawn on the current page
      var stop_delay = 300;
      // the timer handle; allows resetting of the timer after user interactions
      var draw_timer = null;

      //
      // Drawable
      //
      // elem - a page element which defines the position on the page that drawing is to be done
      // task - an object with the method run which takes care of painting the object
      //
      var Drawable = function(elem, task) {
        this.elem = elem;
        this.task = task;
      }

      //
      // Drawable.is_visible
      //
      // Determines if the element is visible in the viewport
      //
      Drawable.prototype.is_visible = function() {
        return element_in_viewport(this.elem);
      }

      //
      // Drawable.run
      //
      // Run the task held by the drawable
      Drawable.prototype.run = function() {
        if (this.task) this.task.run();
        this.task = null;
      }

      //
      // Drawable.run
      //
      // Run the task iff visible
      // returns true if the task ran or has already run
      Drawable.prototype.run_visible = function() {
        if (this.task) {
          if (element_in_viewport(this.elem)) {
            this.task.run();
            this.task = null;
            return true;
          }
          return false;
        } else {
          return true;
        }
      }

      //
      // draw_on_screen
      //
      // Checks each drawable object and draws those on screen.
      //
      function draw_on_screen() {
        var found = false;
        for (var i = 0; i < drawable_list.length; i++) {
          if (drawable_list[i].run_visible()) {
            drawable_list.splice(i--, 1);
            found = true;
          }
        }
        return found;
      }

      //
      // process_draw_tasks
      //
      // Called on a delay to process the next avaliable
      // draw task.
      //
      function process_draw_tasks() {
        var delay = draw_delay;
        draw_timer = null;
        if (drawable_list.length == 0) return; //no more tasks
        if (draw_on_screen()) {
          delay = stop_delay; //give the user a chance to scroll
        } else {
          //get next task
          var drawable = drawable_list.shift();
          drawable.task.run();
        }
        //allow UI updates between tasks
        draw_timer = window.setTimeout("process_draw_tasks()", delay);
      }

      //
      // delayed_process_draw_tasks
      //
      // Call process_draw_tasks after a short delay.
      // The delay serves to group multiple redundant events.       
      // Should be set as event handler for onscroll and onresize.
      //
      function delayed_process_draw_tasks() {
        //reset the timer
        if (drawable_list.length > 0) { 
          if (draw_timer != null) clearTimeout(draw_timer);
          draw_timer = window.setTimeout("process_draw_tasks()", user_delay);
        }
      }

      //
      // add_draw_task
      //
      // Add a drawing task to be called immediately if it is
      // visible, or to be called on a delay to reduce stuttering
      // effect on the web browser.
      function add_draw_task(elem, task) {
        drawable = new Drawable(elem, task);
        if (drawable.is_visible()) {
          task.run();
        } else {
          drawable_list.push(drawable);
          //reset timer
          if (draw_timer != null) clearTimeout(draw_timer);
          draw_timer = window.setTimeout("process_draw_tasks()", user_delay);
        }
      }

</script>
    <script>
pre_load_setup();


/*
 * name_from_source
 *
 * Makes a file name more human friendly to read.
 */
function name_from_source(source) {
  if (source == "-") {
    return "-"
  }
  //assume source is a file name
  var file = source.replace(/^.*\/([^\/]+)$/,"$1");
  var noext = file.replace(/\.[^\.]+$/, "");
  return noext.replace(/_/g, " ");
}

/*
 * pre_load_setup
 *
 *  Sets up initial variables which may be
 *  required for the HTML document creation.
 */
function pre_load_setup() {
  "use strict";
  var seq_db, dbs, i, db, progs, prog;
  seq_db = data['sequence_db'];
  if (!seq_db['name']) {
    seq_db['name'] = name_from_source(seq_db['source']);
  }
  // get the names of the motif databases
  dbs = data['motif_dbs'];
  for (i = 0; i < dbs.length; i++) {
    db = dbs[i];
    if (!db['name']) {
      db['name'] = name_from_source(db['source']);
    }
  }
}

/*
 * $
 *
 * Shorthand function for getElementById
 */
function $(el) {
  return document.getElementById(el);
}

/*
 * coords
 *
 * Calculates the x and y offset of an element.
 * From http://www.quirksmode.org/js/findpos.html
 */
function coords(elem) {
  var myX = myY = 0;
  if (elem.offsetParent) {
    do {
      myX += elem.offsetLeft;
      myY += elem.offsetTop;
    } while (elem = elem.offsetParent);
  }
  return [myX, myY];
}

/*
 * help_popup
 *
 * Moves around help pop-ups so they appear
 * below an activator.
 */
function help_popup(activator, popup_id) {
  if (help_popup.popup === undefined) {
    help_popup.popup = null;
  }
  if (help_popup.activator === undefined) {
    help_popup.activator = null;
  }

  if (typeof(activator) == 'undefined') { // no activator so hide
    help_popup.popup.style.display = 'none';
    help_popup.popup = null;
    return;
  }
  var pop = $(popup_id);
  if (pop == help_popup.popup) {
    if (activator == help_popup.activator) {
      //hide popup (as we've already shown it for the current help button)
      help_popup.popup.style.display = 'none';
      help_popup.popup = null;
      return; // toggling complete!
    }
  } else if (help_popup.popup != null) {
    //activating different popup so hide current one
    help_popup.popup.style.display = 'none';
  }
  help_popup.popup = pop;
  help_popup.activator = activator;

  //must make the popup visible to measure it or it has zero width
  pop.style.display = 'block';
  var xy = coords(activator);
  var padding = 10;
  var edge_padding = 15;
  var scroll_padding = 15;

  var pop_left = (xy[0] + (activator.offsetWidth / 2)  - (pop.offsetWidth / 2));
  var pop_top = (xy[1] + activator.offsetHeight + padding);

  // ensure the box is not past the top or left of the page
  if (pop_left < 0) pop_left = edge_padding;
  if (pop_top < 0) pop_top = edge_padding;
  // ensure the box does not cause horizontal scroll bars
  var page_width = null;
  if (window.innerWidth) {
    page_width = window.innerWidth;
  } else if (document.body) {
    page_width = document.body.clientWidth;
  }
  if (page_width) {
    if (pop_left + pop.offsetWidth > page_width) {
      pop_left = page_width - pop.offsetWidth - edge_padding - scroll_padding; //account for scrollbars
    }
  }

  pop.style.left = pop_left + "px";
  pop.style.top = pop_top + "px";
}

/*
 * page_loaded
 *
 * Called when the page has loaded for the first time.
 */
function page_loaded() {
  post_load_setup();
}

/*
 * page_loaded
 *
 * Called when a cached page is reshown.
 */
function page_shown(e) {
  if (e.persisted) post_load_setup();
}

/*
 * page_loaded
 *
 * Called when a page has been resized
 */
function page_resize() {
  update_scrollpad();
}

function post_load_setup() {
  update_scrollpad();
  delayed_process_draw_tasks();
}

function make_tar_link(container) {
  "use strict";
  var tar_file, p, link;
  // This URL is replaced by the webservice after a tar has been created
  // it is a string 50 characters long so it can be rewritten in-place
  tar_file = "TAR_FILE                                          "; 
  tar_file = tar_file.replace(/\s+$/,"");
  container.innerHTML = "";
  if (tar_file.substr(0, 4) != "TAR_" || tar_file.substr(4) != "FILE") {
    p = document.createElement("p");
    p.className = "tar";
    p.appendChild(document.createTextNode(
    "The full MEME-ChIP analysis can be downloaded as a gzipped tar file from "
    ));
    link = document.createElement("a");
    link.href = tar_file;
    link.appendChild(document.createTextNode("here"));
    p.appendChild(link);
    p.appendChild(document.createTextNode("."));
    container.appendChild(p);
  }
}

function make_description(container, description) {
  "use strict";
  var header, box, paragraphs, p, lines, i, j;
  container.innerHTML = "";
  if (description) {
    header = document.createElement("h2");
    header.className = "mainh pad2";
    header.id = "description";
    header.appendChild(document.createTextNode("Description"));
    container.appendChild(header);
    box = document.createElement("div");
    box.className = "box";
    container.appendChild(box);
    paragraphs = data['description'].split("\n\n");
    for (i = 0; i < paragraphs.length; i++) {
      p = document.createElement("p");
      lines = paragraphs[i].split("\n");
      for (j = 0; j < lines.length; j++) {
        if (j != 0) p.appendChild(document.createElement('br'));
        p.appendChild(document.createTextNode(lines[j]));
      }
      box.appendChild(p);
    }
  }
}

function make_clustered_motifs(container) {
  var dna_alphabet = new Alphabet("ACGT", "A 0.25 C 0.25 G 0.25 T 0.25");
  var groups = data['groups'];
  var motifs = data['motifs'];
  var seq_len = data["sequence_db"]["centrimo_seqlen"];
  var sync_tables = [];
  var i, j;

  container.innerHTML = "";
  toggle_class(container, "more_logos", 1);
  toggle_class(container, "show_known_motifs", data["motif_dbs"].length > 0);
  // check centrimo finished correctly
  var centrimo_ok = false;
  var programs = data["programs"];
  for (i = 0; i < programs.length; i++) {
    if (programs[i]["name"] === "centrimo") {
      centrimo_ok = (programs[i]["status"] == 0);
      break;
    }
  }
  // if centrimo failed then hide it's column
  toggle_class(container, "show_distribution", centrimo_ok);

  // add groups
  for (i = 0; i < groups.length; i++) {
    var alignment = groups[i];
    // calculate the alignment length
    var align_len = 0;
    for (j = 0; j < alignment.length; j++) {
      var align = alignment[j];
      var len = align['offset'] + motifs[align["motif"]]["len"];
      if (align_len < len) align_len = len;
    }
    // create the box to hold group
    var motifbox = document.createElement('div');
    container.appendChild(motifbox);
    motifbox.className = "motifbox";
    // create a table to display this cluster of motifs
    var tbl = document.createElement('table');
    tbl.className = "motifs";
    sync_tables.push(tbl);
    // create the table header
    var thead = document.createElement('thead');
    tbl.appendChild(thead);
    var rhead = thead.insertRow(thead.rows.length);
    add_text_header_cell(rhead, "Motif Found");
    add_text_header_cell(rhead, "Discovery/Enrichment Program", "pop_source");
    add_text_header_cell(rhead, "E-value", "pop_ev");
    add_text_header_cell(rhead, "Known or Similar Motifs", "pop_tomtom", "col_known_motifs");
    add_text_header_cell(rhead, "Distribution", "pop_centrimo", "col_distribution");

    // insert motifs in the table
    var centrimo_list = [];
    var tbody = document.createElement('tbody');
    tbl.appendChild(tbody);
    for (j = 0; j < alignment.length; j++) {
      make_alignment_row(dna_alphabet, seq_len, motifs, tbody, align_len, alignment[j], j != 0);
      var motif = motifs[alignment[j]["motif"]];
      if (motif["centrimo_sites"]) centrimo_list.push(motif);
    }
    var expandbox = document.createElement('div');
    expandbox.addEventListener("transitionend", logos_end_transition, true);
    expandbox.addEventListener("oTransitionEnd", logos_end_transition, true);
    expandbox.addEventListener("webkitTransitionEnd", logos_end_transition, true);
    expandbox.addEventListener("MSTransitionEnd", logos_end_transition, true);
    expandbox.appendChild(tbl);
    motifbox.appendChild(expandbox);
    motifbox.appendChild(make_flip(motifbox));
    if (alignment.length > 1) {
      motifbox.appendChild(make_expand(motifbox, alignment.length, expandbox, tbl));
      var btn = make_compact_btn(motifbox, alignment.length, expandbox, tbl);
      motifbox.appendChild(btn);
      motifbox.compact_btn = btn;
      motifbox.addEventListener("mousemove", position_compact_btn, true);
    }
    if (centrimo_list.length > 1) {
      var group = document.createElement("span");
      group.className = "action";
      var link = document.createElement('a');
      link.appendChild(document.createTextNode("CentriMo Group \u21B7"));
      link.href = centrimo_url(centrimo_list);
      group.appendChild(link);
      group.appendChild(help_button("pop_centrimo_group"));
      motifbox.appendChild(group);
    }
  }
  sync_table_columns(sync_tables);
  toggle_class(container, "more_logos", 0);
}

function make_alignment_row(alphabet, seq_len, motifs, tbody, align_len, align, more) {
  // create the row
  var row = tbody.insertRow(tbody.rows.length);
  if (more) row.className = "more_logo";
  // get the motif information
  var motif = motifs[align["motif"]];
  var pspm = new Pspm(motif["pwm"], motif["id"], 0, 0, 
      motif["sites"], motif["evalue"]);
  // Motif Logos
  var cell = document.createElement("td");
  if (!more) {// make unaligned logos
    var unaligned = document.createElement("span");
    unaligned.className = "unaligned";
    unaligned.appendChild(make_logo(alphabet, pspm, false, 
          0, "normal_logo"));
    unaligned.appendChild(make_logo(alphabet, pspm, true, 
        0, "flipped_logo"));
    cell.appendChild(unaligned);
  }
  var aligned = document.createElement("span");
  aligned.className = "aligned";
  aligned.appendChild(make_logo(alphabet, pspm, align["rc"], 
        align["offset"], "normal_logo"));
  aligned.appendChild(make_logo(alphabet, pspm, !align["rc"], 
      align_len - (align["offset"] + motif["len"]), "flipped_logo"));
  cell.appendChild(aligned);
  row.appendChild(cell);
  // Motif Source
  var link = document.createElement("a");
  if (motif["prog"] == "meme") {
    link.appendChild(document.createTextNode("MEME"));
    link.title = "Click to view the MEME output";
    link.href = "meme_out/meme.html#motif_" + encodeURIComponent(motif["id"]);
  } else if (motif["prog"] == "dreme") {
    link.appendChild(document.createTextNode("DREME"));
    link.title = "Click to view the DREME output";
    link.href = "dreme_out/dreme.html?more=" + encodeURIComponent(motif["id"]);
  } else { // CentriMo
    link.appendChild(document.createTextNode("CentriMo"));
    link.title = "Click to view the CentriMo output";
    link.href = centrimo_url([motif]);
  }
  add_cell(row, link);
  // Significance
  add_text_cell(row, motif["sig"]);
  // TOMTOM Summary
  cell = document.createElement("td");
  cell.className = "col_known_motifs";
  if (motif["prog"] != "centrimo") {
    var matches = motif["tomtom_matches"];
    for (var i = 0; i < matches.length && i < 3; i++) {
      var match = matches[i];
      var name = (match["alt"]? match["alt"] + " (" + match["id"] + ")" : match["id"]);
      if (i != 0) cell.appendChild(document.createElement("br"));
      var link = document.createElement("a");
      link.title = "Click to view the Tomtom alignment for this motif.";
      link.href = motif["prog"] + "_tomtom_out/tomtom.html#match_q_" + 
        encodeURIComponent(motif["id"]) + "_t_" + (match["db"] + 1) + "_" + 
        encodeURIComponent(match["id"]);
      link.appendChild(document.createTextNode(name));
      cell.appendChild(link);
    }
  } else {
    var link = document.createElement("a");
    link.href = motif["url"];
    link.title = "Click to view motif website.";
    var name = (motif["alt"]? motif["alt"] + " (" + motif["id"] + ")" : motif["id"]);
    link.appendChild(document.createTextNode(name));
    cell.appendChild(link);
  }
  row.appendChild(cell);
  // CentriMo Summary
  add_cell(row, make_distribution(seq_len, motif), "col_distribution");
}

function make_program_listing(container) {
  container.innerHTML = "";
  var tbl = document.createElement("table");
  tbl.className = "programs";
  var thead = document.createElement("thead");
  tbl.appendChild(thead);
  row = thead.insertRow(thead.rows.length);
  add_text_header_cell(row, "Command", "", "col_cmd");
  add_text_header_cell(row, "Running Time", "", "col_runtime");
  add_text_header_cell(row, "Status", "", "col_status");
  add_text_header_cell(row, "Outputs", "", "col_outputs");
  var tbody = document.createElement("tbody");
  tbl.appendChild(tbody);
  var progs = data["programs"];
  for (var i = 0; i < progs.length; i++) {
    row = tbody.insertRow(tbody.rows.length);
    var prog = progs[i];
    var cmd_area = document.createElement("div");
    cmd_area.className = "col_cmd";
    var prog_end = prog["cmd"].indexOf(" ");
    if (prog_end == -1) prog_end = prog["cmd"].length;
    var bold_name = document.createElement("b");
    bold_name.appendChild(document.createTextNode(prog["cmd"].substr(0, prog_end)));
    cmd_area.appendChild(bold_name);
    cmd_area.appendChild(document.createTextNode(prog["cmd"].substr(prog_end)));
    add_cell(row, cmd_area, "col_cmd");
    var hours = Math.floor(prog["time"] / 3600);
    var minutes = Math.floor((prog["time"] - 3600 * hours) / 60);
    var seconds = prog["time"] - 3600 * hours - 60 * minutes;
    var time_str;
    if (hours > 0) {
      time_str = "" + hours + "h " + minutes + "m " + seconds.toFixed(2) + "s";
    } else if (minutes > 0) {
      time_str = "" + minutes + "m " + seconds.toFixed(2) + "s";
    } else {
      time_str = "" + seconds.toFixed(2) + "s";
    }
    add_text_cell(row, time_str, "col_runtime");
    var status_text;
    if (prog["oot"]) {
      status_text = "Out of Time";
    } else if (prog["status"] === 0) {
      if (prog["messages_file"]) {
        status_text = "Warnings";
      } else {
        status_text = "Success";
      }
    } else if (prog["status"] === -1) {
      status_text = "Can't Run";
    } else if (prog["status"] & 127 !== 0) {
      status_text = sig_name(prog["status"] & 127);
    } else {
      status_text = "Error " + (prog["status"] >>> 8);
    }
    if (prog["messages_file"]) {
      var link = document.createElement("a");
      link.href = prog["messages_file"];
      link.appendChild(document.createTextNode(status_text));
      add_cell(row, link, "col_status");
    } else {
      add_text_cell(row, status_text, "col_status");
    }
    if (prog["outputs"].length == 0) {
      add_text_cell(row, "", "col_outputs");
    } else {
      var outputs = prog["outputs"];
      var list = document.createElement("ul");
      for (var j = 0; j < outputs.length; j++) {
        var link = document.createElement("a");
        link.href = outputs[j]["file"];
        var name = outputs[j]["file"];
        if (outputs[j]["name"]) {
          name = outputs[j]["name"];
        }
        link.appendChild(document.createTextNode(name));
        var li = document.createElement("li");
        li.appendChild(link);
        list.appendChild(li);
      }
      add_cell(row, list, "col_outputs");
    }
  }
  container.appendChild(tbl);
}

function sig_name(sig_num) {
  "use strict";
  var sig_names = [
    "SIGHUP", "SIGINT", "SIGQUIT", "SIGILL", "SIGTRAP", "SIGABRT", "SIGBUS", 
    "SIGFPE", "SIGKILL", "SIGUSR1", "SIGSEGV", "SIGUSR2", "SIGPIPE", "SIGALRM", 
    "SIGTERM", "SIG16", "SIGCHILD", "SIGCONT", "SIGSTOP", "SIGTSTP", "SIGTTIN", 
    "SIGTTOU", "SIGURG", "SIGXCPU", "SIGXFSZ", "SIGVTALRM", "SIGPROF", "SIG28", 
    "SIGPOLL", "SIG30", "SIGSYS"
  ];
  if ((sig_num - 1) < sig_names.length) {
    return sig_names[sig_num - 1];
  } else {
    return "SIG" + sig_num;
  }
}

function make_sequence_db_listing(container) {
  "use strict";
  var tbl, thead, tbody, row, db, link;
  container.innerHTML = "";
  tbl = document.createElement("table");
  tbl.className = "inputs";
  thead = document.createElement("thead");
  tbl.appendChild(thead);
  row = thead.insertRow(thead.rows.length);
  add_text_header_cell(row, "Database");
  add_text_header_cell(row, "Source");
  add_text_header_cell(row, "Sequence Count");
  tbody = document.createElement("tbody");
  tbl.appendChild(tbody);
  db = data['sequence_db'];
  row = tbody.insertRow(tbody.rows.length);
  link = document.createElement("a");
  link.href = db["file"];
  link.appendChild(document.createTextNode(db["name"]));
  add_cell(row, link);
  add_text_cell(row, db['source']);
  add_text_cell(row, db['count']);
  container.appendChild(tbl);
}

function make_motif_db_listing(container) {
  "use strict";
  var tbl, thead, tbody, row, i, db, motif_dbs;
  container.innerHTML = "";
  motif_dbs = data['motif_dbs'];
  if (motif_dbs.length == 0) {
    $("motif_dbs_header").style.display = "none";
    return;
  }
  tbl = document.createElement("table");
  tbl.className = "inputs";
  thead = document.createElement("thead");
  tbl.appendChild(thead);
  row = thead.insertRow(thead.rows.length);
  add_text_header_cell(row, "Database");
  add_text_header_cell(row, "Source");
  add_text_header_cell(row, "Motif Count");
  tbody = document.createElement("tbody");
  tbl.appendChild(tbody);
  for (i = 0; i < motif_dbs.length; i++) {
    db = motif_dbs[i];
    row = tbody.insertRow(tbody.rows.length);
    add_text_cell(row, db['name']);
    add_text_cell(row, db['source']);
    add_text_cell(row, db['count']);
  }
  container.appendChild(tbl);
}

var DelayLogoTask = function(logo, canvas) {
  this.logo = logo;
  this.canvas = canvas;
};

DelayLogoTask.prototype.run = function () {
  draw_logo_on_canvas(this.logo, this.canvas, false);
};


function make_logo(alphabet, pspm, rc, offset, className) {
  if (rc) pspm = pspm.copy().reverse_complement(alphabet);
  var logo = new Logo(alphabet, "");
  logo.add_pspm(pspm, offset);
  var canvas = document.createElement('canvas');
  canvas.height = 90;
  canvas.width = 0;
  canvas.className = className;
  size_logo_on_canvas(logo, canvas, false);
  add_draw_task(canvas, new DelayLogoTask(logo, canvas));
  return canvas;
}

var DelayCentrimoPlotTask = function(graph, canvas) {
  this.graph = graph;
  this.canvas = canvas;
};

DelayCentrimoPlotTask.prototype.run = function () {
  this.graph.draw_lines(this.canvas.getContext("2d"), 
      this.canvas.width, this.canvas.height);
};

function make_distribution(seq_len, motif) {
  if (motif["centrimo_sites"]) {
    var canvas = document.createElement("canvas");
    canvas.title = "Click to view the CentriMo output";
    canvas.width = 200;
    canvas.height = 90;
    var rset = new CentrimoRSet(seq_len);
    rset.add("", "", "#000", motif["len"], motif["centrimo_total_sites"], motif["centrimo_sites"]);
    var graph = new CentrimoGraph(rset, triangular_weights(20));
    add_draw_task(canvas, new DelayCentrimoPlotTask(graph, canvas));
    var link = document.createElement("a");
    link.appendChild(canvas);
    link.href = centrimo_url([motif]);
    return link;
  } else {
    return document.createTextNode("Not Centrally Enriched");
  }
}

function centrimo_url(motifs) {
  var url = "centrimo_out/centrimo.html";
  for (var i = 0; i < motifs.length; i++) {
    var motif = motifs[i];
    var db = motif["db"];
    // If MEME or DREME were run we have to modify the db as it will be 
    // different to the db that CentriMo uses.
    if (motif["prog"] == "meme") {
      db = 0; // if meme finds motifs it is always specified first
    } else if (motif["prog"] == "dreme") {
      // dreme is normally specified second unless meme finds no motifs
      db = (data["motif_count"]["meme"] > 0 ? 1 : 0);
    } else { // program is ame
      // other databases always come after meme and dreme databases
      if (data["motif_count"]["meme"] > 0) db++;
      if (data["motif_count"]["dreme"] > 0) db++;
    }
    url += (i == 0 ? "?" : "&");
    url += "show=db" + db + "+" + encodeURIComponent(motif["id"]);
  }
  return url;
}

function make_flip(target) {
  var flip_activator = document.createElement('span');
  flip_activator.className = "action";
  flip_activator.appendChild(document.createTextNode("Reverse Complement \u21C6"));
  flip_activator.flip_target = target;
  flip_activator.onclick = flip_logos;
  return flip_activator;
}

function flip_logos() {
  toggle_class(this.flip_target, "flipped_logos");
}

function make_expand(target, nmotifs, grow_box, grow_table) {
  var control = document.createElement('span');
  control.className = "action";
  var activator = document.createElement('span');
  activator.appendChild(document.createTextNode("Show " + (nmotifs - 1) + 
        " More \u21A7"));
  activator.className = "more_action";
  activator.expand_target = target;
  activator.grow_box = grow_box;
  activator.grow_table = grow_table;
  activator.onclick = more_logos;
  control.appendChild(activator);
  var deactivator = document.createElement('span');
  deactivator.appendChild(document.createTextNode("Show  Less \u21A5"));
  deactivator.className = "less_action";
  deactivator.expand_target = target;
  deactivator.grow_box = grow_box;
  deactivator.grow_table = grow_table;
  deactivator.onclick = less_logos;
  control.appendChild(deactivator);
  control.appendChild(help_button("pop_show_clustered"));
  return control;
}

function make_compact_btn(target, nmotifs, grow_box, grow_table) {
  var canvas = document.createElement('canvas');
  canvas.className = "moving_less_action";
  canvas.width = 30;
  canvas.height = 160;
  if (canvas.getContext) {
    var ctx = canvas.getContext('2d');
    draw_compact_btn(ctx, canvas.width, canvas.height);
  }
  canvas.expand_target = target;
  canvas.grow_box = grow_box;
  canvas.grow_table = grow_table;
  canvas.onclick = less_logos;
  return canvas;
}

function draw_compact_btn(ctx, w, h) {
  ctx.save();
  ctx.fillStyle = "black";
  ctx.font = "30px Helvetica";
  ctx.save();
  ctx.textAlign = "center";
  ctx.textBaseline = "top";
  ctx.fillText("\u21A7", w/2 , 0);
  ctx.restore();
  ctx.save();
  ctx.font = "20px Helvetica";
  ctx.translate(w/2, h/2);
  ctx.rotate(-Math.PI / 2);
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText("Show Less", 0, 0);
  ctx.restore();
  ctx.save();
  ctx.textAlign = "center";
  ctx.textBaseline = "alphabetic";
  ctx.fillText("\u21A5", w/2 , h);
  ctx.restore();
  ctx.restore();
}

function position_compact_btn(e) {
  if (!e) var e = window.event;
  var btn = this.compact_btn;
  if (btn) {
    var btn_rect = btn.getBoundingClientRect();
    if (e.clientY > btn_rect.top &&
        e.clientY < (btn_rect.top + btn_rect.height)) {
      return;
    }
    var rect = this.getBoundingClientRect();
    var t = e.clientY - rect.top - (btn.height / 2);
    var tpad = 20;
    var bpad = 50;
    if ((t + btn.height + bpad) > rect.height) t = rect.height - btn.height - bpad;
    if (t < tpad) t = tpad;

    if (typeof btn.update_timer === "undefined") {
      btn.style.top = t + "px";
    }
    if (btn.update_timer) {
      btn.update_top = t;
    } else {
      btn.update_timer = setTimeout(
          function (a_btn) { 
            a_btn.style.top = a_btn.update_top + "px"; 
            btn.update_timer = null;
          }, 500, btn);
    }
  }
}

// from 
// http://stackoverflow.com/questions/7264899/detect-css-transitions-using-javascript-and-without-modernizr
function supportsTransitions() {
    var b = document.body || document.documentElement;
    var s = b.style;
    var p = 'transition';
    if(typeof s[p] == 'string') {return true; }

    // Tests for vendor specific prop
    v = ['Moz', 'Webkit', 'Khtml', 'O', 'ms'],
    p = p.charAt(0).toUpperCase() + p.substr(1);
    for(var i=0; i<v.length; i++) {
      if(typeof s[v[i] + p] == 'string') { return true; }
    }
    return false;
}

function more_logos(e) {
  var will_transition = supportsTransitions();
  if (!more_logos.prev_caller) {
    // stage 1
    toggle_class(this.grow_box, "more_logos", 0);
    if (will_transition) {
      // set size to clip to currently displayed row
      this.grow_box.style.maxHeight = this.grow_table.offsetHeight + "px";
    }
    // need to let the UI update so this works
    more_logos.prev_caller = this;
    setTimeout(more_logos, 0);
    return;
  } else {
    // stage 2
    var me = more_logos.prev_caller;
    if (will_transition) {
      toggle_class(me.expand_target, "inprogress", 1);
      toggle_class(me.grow_box, "motifexpander", 1);
    }
    // show other rows
    toggle_class(me.expand_target, "more_logos", 1);
    if (me.expand_target.compact_btn) {
      me.expand_target.compact_btn.style.top = "20px";
    }
    if (will_transition) {
      // expand size
      me.grow_box.style.maxHeight = me.grow_table.offsetHeight + "px";
    }
    more_logos.prev_caller = null;
  }
}

function less_logos() {
  var will_transition = supportsTransitions();
  if (!less_logos.prev_caller) {
    //stage 1
    toggle_class(this.grow_box, "more_logos", 0);
    if (will_transition) {
      // set size to clip to currently displayed rows
      this.grow_box.style.maxHeight = this.grow_table.offsetHeight + "px";
    }
    // need to let the UI update so this works
    less_logos.prev_caller = this;
    setTimeout(less_logos, 0);
    return;
  } else {
    // stage 2
    var me = less_logos.prev_caller;
    if (will_transition) {
      toggle_class(me.expand_target, "inprogress", 1);
      toggle_class(me.grow_box, "motifexpander", 1);
    }
    toggle_class(me.expand_target, "more_logos", 0);
    if (will_transition) {
      // collapse size
      me.grow_box.style.maxHeight = me.grow_table.offsetHeight + "px";
      toggle_class(me.grow_box, "more_logos", 1);
    } else {
      if (!element_in_viewport(me.expand_target)) {
        me.expand_target.scrollIntoView(true);
      }
    }
    less_logos.prev_caller = null;
  }
}

function logos_end_transition(e) {
  var targ;
  if (!e) var e = window.event;
  if (e.target) targ = e.target;
  else if (e.srcElement) targ = e.srcElement;
  if (targ.nodeType == 3) // defeat Safari bug
    targ = targ.parentNode;

  toggle_class(targ, "motifexpander", 0);
  toggle_class(targ, "more_logos", 0);
  targ.style.maxHeight = "";
  if (!element_in_viewport(targ)) {
    targ.scrollIntoView(true);
  }
  var motifbox_re = /\bmotifbox\b/;
  var p = targ.parentNode;
  while (p) {
    if (motifbox_re.test(p.className)) {
      toggle_class(p, "inprogress", 0);
      break;
    }
    p = p.parentNode;
  }
}

function toggle_help() {
  help_popup(this, this.topic);
}

function help_button(topic) {
  var btn = document.createElement("div");
  btn.className = "help";
  btn.topic = topic;
  btn.onclick = toggle_help;
  return btn;
}

/*
 * add_cell
 *
 * Add a cell to the table row.
 */
function add_cell(row, node, cls) {
  var cell = row.insertCell(row.cells.length);
  if (node) cell.appendChild(node);
  if (cls) cell.className = cls;
}

/*
 * add_cell
 *
 * Add a header cell to the table row.
 */
function add_header_cell(row, node, help_topic, cls) {
  var th = document.createElement("th");
  row.appendChild(th);
  if (node) th.appendChild(node);
  if (help_topic) th.appendChild(help_button(help_topic));
  if (cls) th.className = cls;
}

/*
 * add_text_cell
 *
 * Add a text cell to the table row.
 */
function add_text_cell(row, text, cls) {
  var node = null;
  if (typeof(text) != 'undefined') node = document.createTextNode(text);
  add_cell(row, node, cls);
}

/*
 * add_text_header_cell
 *
 * Add a text header cell to the table row.
 */
function add_text_header_cell(row, text, help_topic, cls) {
  var node = null;
  if (typeof(text) != 'undefined') {
    var nbsp = (help_topic ? "\u00A0" : "");
    node = document.createTextNode(text + nbsp);
  }
  add_header_cell(row, node, help_topic, cls);
}

/*
 * toggle_class
 *
 * Adds or removes a class from the node. If the parameter 'enabled' is not 
 * passed then the existence of the class will be toggled, otherwise it will be
 * included if enabled is true.
 */
function toggle_class(node, cls, enabled) {
  var classes = node.className;
  var list = classes.replace(/^\s+/, '').replace(/\s+$/, '').split(/\s+/);
  var found = false;
  for (var i = 0; i < list.length; i++) {
    if (list[i] == cls) {
      list.splice(i, 1);
      i--;
      found = true;
    }
  }
  if (enabled === undefined) {
    if (!found) list.push(cls);
  } else {
    if (enabled) list.push(cls);
  }
  node.className = list.join(" ");
}

/*
 * sync_table_columns
 *
 * Sets the column widths to be the maximum of the required column widths
 *
 */
function sync_table_columns(tables) {
  var colw = [];
  for (var t = 0; t < tables.length; t++) {
    var table = tables[t];
    for (var r = 0; r < table.rows.length; r++) {
      var row = table.rows[r];
      for (var c = colw.length; c < row.cells.length; c++) {
        colw[c] = 0;
      }
      for (var c = 0; c < row.cells.length; c++) {
        var cell = row.cells[c];
        if (cell.offsetWidth > colw[c]) colw[c] = cell.offsetWidth;
      }
    }
  }
  for (var t = 0; t < tables.length; t++) {
    var table = tables[t];
    for (var r = 0; r < table.rows.length; r++) {
      var row = table.rows[r];
      for (var c = 0; c < row.cells.length; c++) {
        var cell = row.cells[c];
        cell.style.width = colw[c] + "px";
      }
    }
  }
}

/*
 * update_scrollpad
 *
 * Creates padding at the bottom of the page to allow
 * scrolling of anything into view.
 */
function update_scrollpad() {
  var elem = (document.compatMode === "CSS1Compat") ? 
      document.documentElement : document.body;
  document.getElementById("scrollpad").style.height = Math.abs(elem.clientHeight - 100) + "px";
}
</script>
    <style>
table.inputs {
  margin-top: 20px;
  border-collapse:collapse;
}
table.inputs * td, table.inputs * th {
  padding-left: 15px;
  padding-right: 15px;
  padding-top: 1px;
  padding-bottom: 1px;
}

table.motifs {
  table-layout: fixed;
}
table.motifs * td {
  padding: 1px 5px;
}

div.motifbox {
  border-radius: 10px; 
  border: 2px solid #CCC;
  margin-bottom: 5px;
  padding: 5px;
  padding-left:30px;
  position: relative;
}

div.motifexpander {
  overflow-y: hidden;
  -moz-transition: max-height 1s; 
  -webkit-transition: max-height 1s;  
  -ms-transition: max-height 1s;  
  -o-transition: max-height 1s;  
  transition: max-height 1s;
}

canvas.normal_logo {
  display: block;
}

canvas.flipped_logo {
  display: none;
}

div.flipped_logos * canvas.normal_logo {
  display: none;
}

div.flipped_logos * canvas.flipped_logo {
  display: block;
}

*.action {
  display: inline-block;
  margin-right: 30px;
  cursor: pointer;
  font-size: large;
  -moz-user-select: none;  
  -webkit-user-select: none;  
  -ms-user-select: none;
}
*.action a {
  color: black;
  text-decoration:none;
}
*.more_logos * span.more_action {
  display: none;
}
*.more_logos * span.less_action {
  display: inline-block;
}
span.more_action {
  display: inline-block;
}
span.less_action {
  display: none;
}
*.more_logo {
  display: none;
}
*.more_logos * tr.more_logo {
  display: table-row;
}

canvas.moving_less_action{
  display: none;
  cursor: pointer;
  position: absolute;
  left: 0px;
  top: 20px;
  -moz-transition: top 1s; 
  -webkit-transition: top 1s;  
  -ms-transition: top 1s;  
  -o-transition: top 1s;  
  transition: top 1s;
}

*.more_logos:hover > canvas.moving_less_action {
  display: block;
}

*.more_logos.inprogress:hover > canvas.moving_less_action {
  display: none;
}

span.aligned {
  display: none;
}
span.unaligned {
  display: inline;
}
*.more_logos * span.aligned {
  display: inline;
}
*.more_logos * span.unaligned {
  display: none;
}

td.col_distribution {
  text-align: center;
}
th.col_distribution, td.col_distribution {
  display: none;
}
*.show_distribution * th.col_distribution, 
  *.show_distribution * td.col_distribution {
  display: table-cell;
}

th.col_known_motifs, td.col_known_motifs {
  display: none;
}

*.show_known_motifs * th.col_known_motifs, 
  *.show_known_motifs * td.col_known_motifs {
  display: table-cell;
}

div.pop_content {
  position:absolute;
  z-index:1;
  width:300px;
  padding: 5px;
  background: #E4ECEC;
  font-size: 12px;
  font-family: Arial;
  border-style: double;
  border-width: 3px;
  border-color: #AA2244;
  display:none;
}

table.programs {
  table-layout: fixed;
  width: 100%;
}

table.programs * td, table.programs * th {
  padding-top: 5px;
  padding-bottom: 5px;
}

th.col_cmd, td.col_cmd {
}

td.col_cmd {
  vertical-align: top;
}

div.col_cmd {
}

th.col_runtime, td.col_runtime {
  width: 9em;
}

td.col_runtime {
  vertical-align: top;
  text-align: right;
  padding-right: 10px;
}

th.col_status, td.col_status {
  width: 10em;
  vertical-align: top;
}

td.col_status {
  text-align: center;
}

th.col_outputs, td.col_outputs {
  width: 15em;
  vertical-align:top;
}

td.col_outputs ul {
  margin-top: 0px;
  margin-bottom: 0px;
}

p.tar {
  font-size: larger;
}
</style>
    <style>
        /* The following is the content of meme.css */
        body { background-color:white; font-size: 12px; font-family: Verdana, Arial, Helvetica, sans-serif;}

        div.help {
          display: inline-block;
          margin: 0px;
          padding: 0px;
          width: 12px;
          height: 13px;
          cursor: pointer;
          background-image: url("help.gif");
          background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAANAQMAAACn5x0BAAAAAXNSR0IArs4c6QAAAAZQTFRFAAAAnp6eqp814gAAAAF0Uk5TAEDm2GYAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH2gMJBQgGYqhNZQAAACZJREFUCNdj+P+BoUGAoV+AYeYEEGoWYGgTYGgRAAm2gRGQ8f8DAOnhC2lYnqs6AAAAAElFTkSuQmCC");
        }

        div.help2 {
          color: #999;
          display: inline-block;
          width: 12px;
          height: 12px;
          border: 1px solid #999;
          font-size: 13px;
          line-height:12px;
          font-family: Helvetica, sans-serif;
          font-weight: bold;
          font-style: normal;
          cursor: pointer;
        }
        div.help2:hover {
          color: #000;
          border-color: #000;
        }
        
        p.spaced { line-height: 1.8em;}
        
        span.citation { font-family: "Book Antiqua", "Palatino Linotype", serif; color: #004a4d;}

        p.pad { padding-left: 30px; padding-top: 5px; padding-bottom: 10px;}

        td.jump { font-size: 13px; color: #ffffff; background-color: #00666a;
          font-family: Georgia, "Times New Roman", Times, serif;}

        a.jump { margin: 15px 0 0; font-style: normal; font-variant: small-caps;
          font-weight: bolder; font-family: Georgia, "Times New Roman", Times, serif;}

        h2.mainh {font-size: 1.5em; font-style: normal; margin: 15px 0 0;
          font-variant: small-caps; font-family: Georgia, "Times New Roman", Times, serif;}

        h2.line {border-bottom: 1px solid #CCCCCC; font-size: 1.5em; font-style: normal;
          margin: 15px 0 0; padding-bottom: 3px; font-variant: small-caps;
          font-family: Georgia, "Times New Roman", Times, serif;}

        h4 {border-bottom: 1px solid #CCCCCC; font-size: 1.2em; font-style: normal;
          margin: 10px 0 0; padding-bottom: 3px; font-family: Georgia, "Times New Roman", Times, serif;}

        h5 {margin: 0px}

        a.help { font-size: 9px; font-style: normal; text-transform: uppercase;
          font-family: Georgia, "Times New Roman", Times, serif;}

        div.pad { padding-left: 30px; padding-top: 5px; padding-bottom: 10px;}
        
        div.pad1 { margin: 10px 5px;}

        div.pad2 { margin: 25px 5px 5px;}
        h2.pad2 { padding: 25px 5px 5px;}

        div.pad3 { padding: 5px 0px 10px 30px;}

        div.box { border: 2px solid #CCCCCC; padding:10px;}

        div.bar { border-left: 7px solid #00666a; padding:5px; margin-top:25px; }

        div.subsection {margin:25px 0px;}

        img {border:0px none;}

        th.majorth {text-align:left;}
        th.minorth {font-weight:normal; text-align:left; width:8em; padding: 3px 0px;}
        th.actionth {font-weight:normal; text-align:left;}

        .strand_name {text-align:left;}
        .strand_side {padding:0px 10px;}
        .strand_start {padding:0px 10px;}
        .strand_pvalue {text-align:center; padding:0px 10px;}
        .strand_lflank {text-align:right; padding-right:5px; font-weight:bold; font-size:large; font-family: 'Courier New', Courier, monospace; color:gray;}
        .strand_seq {text-align:center; font-weight:bold; font-size:large; font-family: 'Courier New', Courier, monospace;}
        .strand_rflank {text-align:left; padding-left:5px; font-weight:bold; font-size:large; font-family: 'Courier New', Courier, monospace; color:gray;}

        .block_td {height:25px;}
        .block_container {position:relative; width:98%; height:25px; padding:0px; margin: 0px 0px 0px 1em;}
        .block_motif {position:absolute; z-index:3; height:12px; top:0px; text-align:center; vertical-align:middle; background-color:cyan;}
        .block_rule {position:absolute; z-index:2; width:100%; height:1px; top:12px; left:0px; background-color:gray;}
        .block_plus_sym {position:absolute; z-index:4; line-height:12px; top:0px; left:-1em;}
        .block_minus_sym {position:absolute; z-index:4; line-height:12px; top:13px; left:-1em;}

        .tic_major {position:absolute; border-left:2px solid blue; height:0.5em; top:0em;}
        .tic_minor {position:absolute; border-left:1px solid blue; height:0.2em; top:0em;}
        .tic_label {position:absolute; top:0.5em;  height: 1em; text-align:center; vertical-align:middle}

        .explain h5 {font-size:1em; margin-left: 1em;}

        div.doc {margin-left: 2em; margin-bottom: 3em;}
        
        div.tabArea {
          font-size: 80%;
          font-weight: bold;
        }

        a.tab {
          background-color: #ddddff;
          border: 1px solid #000000;
          padding: 2px 1em 2px 1em;
          text-decoration: none;
        }
        div.tabArea.base a.tab {
          border-top-width: 0px;
        }
        div.tabArea.top a.tab {
          border-bottom-width: 0px;
        }

        a.tab, a.tab:visited {
          color: #808080;
        }

        a.tab:hover {
          background-color: #d0d0d0;
          color: #606060;
        }
        a.tab.activeTab, a.tab.activeTab:hover, a.tab.activeTab:visited {
          background-color: #f0f0f0;
          color: #000000;
        }
        div.tabMain {
          border: 1px solid #000000;
          background-color: #ffffff;
          padding: 5px;
          margin-right: 5px;
        }
        th.trainingset {
          border-bottom: thin dashed black; 
          font-weight:normal; 
          padding:0px 10px;
        }
        .dnaseq {
          font-weight: bold; 
          font-size: large; 
          font-family: 'Courier New', Courier, monospace;
        }
        .dna_A {
          color: rgb(204,0,0);
        }
        .dna_C {
          color: rgb(0,0,204);
        }
        .dna_G {
          color: rgb(255,179,0);
        }
        .dna_T {
          color: rgb(0,128,0);
        }
</style>
  </head>
  <body onload="page_loaded()" onpageshow="page_shown(event)" 
    onresize="page_resize()" onscroll="delayed_process_draw_tasks()">
    <!-- Help popups -->
    <div class="pop_content" id="pop_source">
      <p>This is a link to the motif in the output of the particular motif 
      discovery (e.g., MEME) or motif enrichment (e.g., CentriMo) program that 
      reported it.</p>
      <div style="float:right; bottom:0px;">[ 
        <a href="javascript:help_popup()">close</a> ]</div>
    </div>
    <div class="pop_content" id="pop_ev">
      <p>This is the significance of the motif according to the particular motif
      discovery (e.g., MEME) or motif enrichment (e.g., CentriMo) program that 
      reported it.</p>
      <p>Follow the link under the "Discovery/Enrichment Program" column for 
      more information on how the significance value was derived.</p>
      <div style="float:right; bottom:0px;">[ 
        <a href="javascript:help_popup()">close</a> ]</div>
    </div>
    <div class="pop_content" id="pop_tomtom">
      <p>Motifs reported by a motif discovery program (e.g., MEME) are compared 
      with known motifs in a motif database specified by the user. This column 
      lists the (up to) three most similar motifs. Only known motifs with 
      TOMTOM similarity E-values of less than 1.0 to the discovered motif will 
      be shown here. Clicking any of these links will show the TOMTOM results 
      where all alignments can be viewed.</p>
      <p>Motifs reported by a motif enrichment program (e.g., CentriMo) list the
      motif's name and a link to the motif's entry on the database website if it
      is available.</p>
      <div style="float:right; bottom:0px;">[ 
        <a href="javascript:help_popup()">close</a> ]</div>
    </div>
    <div class="pop_content" id="pop_centrimo">
      <p>This graph shows the distribution of the best matches to the motif in 
      the sequences as found by a CentriMo analysis.</p>
      <p>The vertical line in the center of the graph corresponds to the center
      of the sequences.</p>
      <p>Clicking on a motif's graph will take you to the CentriMo output with 
      that motif selected for graphing.</p>
      <div style="float:right; bottom:0px;">[ 
        <a href="javascript:help_popup()">close</a> ]</div>
    </div>
    <div class="pop_content" id="pop_show_clustered">
      <p>Clicking here will show you all the motifs found by motif discovery or 
      motif enrichment analysis that are significantly similar to the reported 
      motif.</p>  
      <p>The additional motifs are shown aligned with the reported motif, 
      sorted in order of significance of the motif according to the 
      particular motif discovery (e.g., MEME) or motif enrichment 
      (e.g., CentriMo) program that reported it.</p>
      <p>To cluster the motifs MEME ChIP does the following:</p>
      <ol>
        <li>Start with no groups and all significant reported motifs.</li>
        <li>Run TOMTOM with all significant reported motifs to determine 
        pairwise similarity.</li>
        <li>Group Highly Similar Motifs---
        <div style="padding-left: 10px;">
          While ungrouped motifs:
          <div style="padding-left: 10px;">
            Select most significant ungrouped motif.
            <div style="border: 1px solid gray; color: gray">
              This is called the "seed" motif for the group and we will call the
              E-value of its seed motif the group's "significance".
            </div>
            Form a new group from the seed motif and all other motifs that 
            are not yet in a group and who are strongly similar to the seed 
            motif (default: TOMTOM E-value &le; 0.05).
          </div>
        </div>
        </li>
        <li>Merge Groups---
        <div style="padding-left: 10px">
          For each group (most significant to least significant), merge it with 
          any less significant group if all of its motifs are weakly similar to
          the first group's seed motif (default: TOMTOM E-value &le; 0.5).
        </div>
        </li>
      </ol>
      <div style="float:right; bottom:0px;">[ 
        <a href="javascript:help_popup()">close</a> ]</div>
    </div>
    <div class="pop_content" id="pop_centrimo_group">
      <p>Clicking here takes you to the CentriMo motif enrichment analysis with 
      the results for this motif and any similar motifs selected.</p>
      <div style="float:right; bottom:0px;">[ 
        <a href="javascript:help_popup()">close</a> ]</div>
    </div>
    

    <!-- End help popups -->
    <h1><img src="http://meme.nbcr.net/meme/doc/images/memechip_logo.png" alt="MEME ChIP"></h1>
    <p>
      If you use MEME-ChIP in your research, please cite the following paper:<br />
      <span class="citation">
        Philip Machanick and Timothy L. Bailey, "MEME-ChIP: motif analysis of large DNA datasets",
        <i>Bioinformatics</i>, <b>27</b>12, 1696-1697, 2011.
      </span>
    </p>
    <!-- navigation -->
    <div class="pad2">
      <a class="jump" href="#data_sec">Motifs</a>
      &nbsp;&nbsp;|&nbsp;&nbsp;
      <a class="jump" href="#programs_sec">Programs</a>
      &nbsp;&nbsp;|&nbsp;&nbsp;
      <a class="jump" href="#input_sec">Input Files</a>
      &nbsp;&nbsp;|&nbsp;&nbsp;
      <a class="jump" href="#info_sec">Program information</a>
    </div>
    <!-- alert the user when their browser is not up to the task -->
    <noscript><h1 style="color:red">Javascript is required to view these results!</h1></noscript>
    <h1 id="html5_warning" style="color:red; display:none;">Your browser does not support canvas!</h1>
    <script>if (!window.HTMLCanvasElement) $("html5_warning").style.display = "block";</script>
    <!-- -->
    <span id="ins_tar"></span>
    <script>make_tar_link($("ins_tar"));</script>
    <!-- write out the job description -->
    <span id="ins_desc"></span>
    <script>make_description($("ins_desc"), data["description"]);</script>
    <!-- write out clustered motifs -->
    <h2 class="mainh pad2" id="data_sec">Motifs</h2>
    <div class="box">
      <p>The motifs found by the programs MEME, DREME and CentriMo; 
      clustered by similarity and ordered by E-value.</p>
      <div id="logos"></div>
      <script>make_clustered_motifs($("logos"));</script>
    </div>
    <!-- write out a list of all programs run -->
    <h2 class="mainh pad2" id="programs_sec">Programs</h2>
    <div class="box" id="program_listing"></div>
    <script>make_program_listing($("program_listing"));</script>
    <!-- write out input files -->
    <h2 id="input_sec" class="mainh pad2">Input Files</h2>
    <div class="box">
      <h4>Sequences</h4>
      <div id="sequence_db"></div>
      <script>make_sequence_db_listing($("sequence_db"));</script>
      <h4 id="motif_dbs_header">Motifs</h4>
      <div id="motif_dbs"></div>
      <script>make_motif_db_listing($("motif_dbs"));</script>
    </div>
    <!-- list information on this program -->
    <div id="info_sec" class="bar">
      <div class="subsection">
        <h5 id="version">MEME-ChIP version</h5>
        <span id="ins_version"></span> 
        (Release date: <span id="ins_release"></span>)<br>
      </div>
      <script>
        $("ins_version").innerHTML = data["version"];
        $("ins_release").innerHTML = data["release"];
      </script>
      <div class="subsection">
        <h5 id="reference">Reference</h5>
        <span class="citation">
        Philip Machanick and Timothy L. Bailey, "MEME-ChIP: motif analysis of large DNA datasets",
        <i>Bioinformatics</i>, <b>27</b>12, 1696-1697, 2011.
        </span>
        <div class="subsection">
          <h5 id="command">Command line summary</h5>
          <textarea id="cmd" rows="1" style="width:100%;" readonly="readonly">
          </textarea>
          <script>$("cmd").value = data["cmd"].join(" ");</script>
        </div>
      </div>
    </div>
    <div id="scrollpad"></div>
  </body>
</html>
