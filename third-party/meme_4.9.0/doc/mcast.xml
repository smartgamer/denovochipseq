<?xml-stylesheet type='text/xsl' href='options.xsl'?>
<html>
  <head>
    <title>mcast - a motif search tool</title>
    <link href="./meme-suite.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <div id="main">
      <script src="./meme-suite-logo.js" type="text/javascript">></script>
      <img src="images/mcast-logo.png" alt="MCAST logo" />
      <p />
      <b>Usage:</b>
      <code>mcast [options] &lt;motifs&gt; &lt;database&gt;</code>
      <p />
      <b>Description:</b>

      <p/>
      <code>MCAST</code> searches a sequence database for
      statistically significant clusters of non-overlapping
      occurrences of a given set of motifs.

      <p/>
      A motif "hit" is a sequence position that is sufficiently similar to a
      motif in the query, where the
      score for a motif at a particular sequence position is
      computed without gaps. 
      To compute the <i>p-</i>value of a
      motif score, <code>MCAST</code> assumes that the
      sequences in the database were generated by a 0-order Markov
      process (see option <code><nobr>--bgfile</nobr></code>, below).
      To be considered a hit, the <i>p</i>-value of the motif
      alignment score must be less than the significance threshold,
      <i>pthresh</i> (see
      option <code><nobr>--motif-pthresh</nobr></code>, below).  Note
      that <code>MCAST</code> searches for hits on both strands of the
      sequences.

      <p/> A cluster of non-overlapping hits is called a "match".  The
      user specifies the maximum allowed distance between the hits in
      a match using the <code><nobr>--max-gap</nobr></code> option.
      Two hits separated by more than the maximum allowed gap will be
      reported in separate matches.

      <p/>
      The <i>p-</i>value of a hit is converted to a "p-score" in order
      to compute the total score of the match it participates in. 
      The p-score for a hit with <i>p-</i>value <i>p</i> is
      <p />
      <div style="margin-left: 2em">
      <i>S = -log<sub>2</sub>(p/pthresh),</i>
      </div>
      <p />
      The total score of a match is the sum of the p-scores of
      the hits making up the match.

      <p/>
      <code>MCAST</code> searches for all possible matches between the
      query motifs and the sequences in the database, and reports the
      matches with the largest scores in decreasing order.  Three
      types of statistical confidence estimates
      (<i>p</i>-value, <i>E</i>-value, and <i>q</i>-value) are
      estimated for each score, and the reported matches can be
      filtered by applying <i>p</i>-value or <i>q</i>-value
      thresholds (see the
      options <code><nobr>--output-pthresh</nobr></code>
      and <code><nobr>--output-pthresh</nobr></code> below).

      <p/>
      In order for <code>MCAST</code> to compute statistical
      confidence estimates, at least 100 matches must be found.  If
      the database contains too few sequences, or if certain other
      options are made too stringent, then too few
      matches may exist for significance statistics to be computed.
      In this case, the <i>p</i>-value, <i>q</i>-value,
      and <i>E</i>-value columns are set to "NaN", and all matches are
      printed.  This limitation can be overcome by specifying the
      <code><nobr>--synth</nobr></code> and <code><nobr>---bgfile
      options</nobr></code>.  When those options are set, synthetic
      sequences will be generated from the provided background model
      and used to estimate significance statistics.

      <p/>
      When computing statistical confidence
      estimates, <code>MCAST</code> must retain the matches in memory
      until the final distribution of scores can be estimated.  This
      means that the scanning of genome sized datasets has the
      potential to exhaust all available memory.  To avoid this
      problem,
      <code>MCAST</code> uses reservoir sampling of the match scores,
      and limits the number of matches that are kept in memory.
      The default number of matches kept in memory is 100,000,
      but this value can be adjusted via the
      <code><nobr>--max-stored-scores</nobr></code> option.
      If the maximum number of stored matches is reached, then
      <code>MCAST</code> will drop the least significant half of the
      matches.  This behavior may result in matches missing from
      the <code>MCAST</code> output, even though they would have
      satisified the user-specified <i>p</i>-value or <i>q</i>-value
      threshold.

      <p/>
      A full description of the algorithm may be found in:
      
      <blockquote>
      <p />
      <a href="http://bioinformatics.oxfordjournals.org/cgi/content/abstract/19/suppl_2/ii16">
      Bailey and Noble. "Searching for statistically significant regulatory
      modules." <i>Bioinformatics (Proceedings of the European Conference on
      Computational Biology)</i>. 19(Suppl. 2):ii16-ii25, 2003.</a>
      </blockquote>
      <p />
      <b>Input:</b>
      <ul> 
      <li>
      <code>&lt;motifs&gt;</code> is a list of motifs, in 
      <a href="meme-format.html">MEME</a>
      or 
      <a href="transfac-format.html">TRANSFAC</a> format.
      </li>
      <li>
      <code>&lt;database&gt;</code> is a collection of DNA sequences in
      <A HREF="fasta-format.html">FASTA</A> format. 
      </li>
      </ul>
      <p />
      <b>Output:</b>
      <p />
      MCAST will create a directory named <code>mcast_out</code>
      (the name of this directory can be overridden via the
      <code><nobr>--o</nobr></code> or <code><nobr>--oc</nobr></code> options)
      The directory will contain:
      <ul>
      <li>
      A file named <code>mcast.xml</code> describing the inputs to MCAST in XML format
      </li>
      <li>
      A file named <code>cisml.xml</code> reporting the matches in XML format using the 
      <a href="http://zlab.bu.edu/~phaverty/SupplementalData/CisML">CisML</a> schema
      </li>
      <li>
      A file named <code>mcast.html</code> reporting the matches in HTML format
      </li>
      <li>
      A file named <code>mcast.txt</code> reporting the matches in tab-delimited format
      </li>
      <li>
      A file named <code>mcast.gff</code> reporting the matches in
      <a href="http://www.sanger.ac.uk/resources/software/gff/">GFF format</a>
      </li>
      <li>
      A file named <code>mcast.wig</code> reporting the matches in 
      <a href="https://cgwb.nci.nih.gov/goldenPath/help/wiggle.html">wiggle track format</a>
      </li>
      </ul>
      <p />
      The HTML output contains
      <ul>
      <li>A list of the motifs, and the best possible "hit" for each</li>
      <li>A list of matches. 
      Each match record contains
        <ul>
        <li>
        The name of the sequence
        </li> 
        <li>
        The starting and ending coordinates for the match.
        The coordinates are 1-based, 
        and start at the first position in the sequence.
        </li>
        <li>The match score</li>
        <li>The match p-value</li>
        <li>The match e-value</li>
        <li>The match q-value</li>
        <li>A block diagram showing the relative positions of each motif "hit" in the match</li>
        <li>A detailed view of each match is available as a pop-up window. 
        The detailed view shows the full sequence for the match,
        the alignment to the motifs,
        and the <i>p</i>-values for the motif hits</li>
        </ul>
      </li>
      <li>The inputs to <code>MCAST</code></li>
      <li>Text describing the MCAST results</li>
      </ul>
      <p />
      The plain text output contains a line for each match.
      Each line contains the following fields:
      <ul>
      <li>An id string for the match</li>
      <li>The name of the sequence containing the match</li>
      <li>The starting and ending coordinates of the match (1-based)</li>
      <li>The match score</li>
      <li>The match p-value</li>
      <li>The match e-value</li>
      <li>The match q-value</li>
      <li>The sequence of the matched region</li>
      </ul>
      The lines are sorted by score in descending order.
      <p />
      The wiggle track output contains the following entries:
      <ul>
        <li>A track line containing:</li>
          <ul>
            <li>The track type</li>
            <li>The source of the track (MCAST)</li>
          </ul>
        <li>A step size line containing:</li>
          <ul>
            <li>The sequence name</li>
            <li>The width of the match</li>
          </ul>
        <li>A data line containing:</li>
          <ul>
            <li>The start position of the match (closed, 1-based coordinates)</li>
            <li>A score based on the p-value of the match: -log(<i>p</i>-value) where</li>
          </ul>
      </ul>
      <p />
      The wiggle track output is sorted by sequence name and position.
      <p /><b>Options:</b>
      <ul>
      <li><command-option name="bgfile"/></li>
      <li><command-option name="bgweight"/></li>
      <li><command-option name="max-gap"/></li>
      <li><command-option name="max-stored-scores"/></li>
      <li><command-option name="motif-pthresh"/></li>
      <li><command-option name="o"/></li>
      <li><command-option name="oc"/></li>
      <li><command-option name="output-ethresh"/></li>
      <li><command-option name="output-pthresh"/></li>
      <li><command-option name="output-qthresh"/></li>
      <!--
      <li><command-option name="synth"/></li>
      -->
      <li><command-option name="transfac"/></li>
      <li><command-option name="verbosity"/></li>
      </ul>
    </div>
  </body>
</html>
