<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<?xml-stylesheet type='text/xsl' href='options.xsl'?><html xmlns="http://www.w3.org/1999/xhtml">
  <head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>mcast - a motif search tool</title>
    <link href="./meme-suite.css" rel="stylesheet" type="text/css" />
  </head>
  <body>
    <div id="main">
      <script src="./meme-suite-logo.js" type="text/javascript">&gt;</script>
      <img src="images/mcast-logo.png" alt="MCAST logo" />
      <p></p>
      <b>Usage:</b>
      <code>mcast [options] &lt;motifs&gt; &lt;database&gt;</code>
      <p></p>
      <b>Description:</b>

      <p></p>
      <code>MCAST</code> searches a sequence database for
      statistically significant clusters of non-overlapping
      occurrences of a given set of motifs.

      <p></p>
      A motif "hit" is a sequence position that is sufficiently similar to a
      motif in the query, where the
      score for a motif at a particular sequence position is
      computed without gaps. 
      To compute the <i>p-</i>value of a
      motif score, <code>MCAST</code> assumes that the
      sequences in the database were generated by a 0-order Markov
      process (see option <code><nobr>--bgfile</nobr></code>, below).
      To be considered a hit, the <i>p</i>-value of the motif
      alignment score must be less than the significance threshold,
      <i>pthresh</i> (see
      option <code><nobr>--motif-pthresh</nobr></code>, below).  Note
      that <code>MCAST</code> searches for hits on both strands of the
      sequences.

      <p></p> A cluster of non-overlapping hits is called a "match".  The
      user specifies the maximum allowed distance between the hits in
      a match using the <code><nobr>--max-gap</nobr></code> option.
      Two hits separated by more than the maximum allowed gap will be
      reported in separate matches.

      <p></p>
      The <i>p-</i>value of a hit is converted to a "p-score" in order
      to compute the total score of the match it participates in. 
      The p-score for a hit with <i>p-</i>value <i>p</i> is
      <p></p>
      <div style="margin-left: 2em">
      <i>S = -log<sub>2</sub>(p/pthresh),</i>
      </div>
      <p></p>
      The total score of a match is the sum of the p-scores of
      the hits making up the match.

      <p></p>
      <code>MCAST</code> searches for all possible matches between the
      query motifs and the sequences in the database, and reports the
      matches with the largest scores in decreasing order.  Three
      types of statistical confidence estimates
      (<i>p</i>-value, <i>E</i>-value, and <i>q</i>-value) are
      estimated for each score, and the reported matches can be
      filtered by applying <i>p</i>-value or <i>q</i>-value
      thresholds (see the
      options <code><nobr>--output-pthresh</nobr></code>
      and <code><nobr>--output-pthresh</nobr></code> below).

      <p></p>
      In order for <code>MCAST</code> to compute statistical
      confidence estimates, at least 100 matches must be found.  If
      the database contains too few sequences, or if certain other
      options are made too stringent, then too few
      matches may exist for significance statistics to be computed.
      In this case, the <i>p</i>-value, <i>q</i>-value,
      and <i>E</i>-value columns are set to "NaN", and all matches are
      printed.  This limitation can be overcome by specifying the
      <code><nobr>--synth</nobr></code> and <code><nobr>---bgfile
      options</nobr></code>.  When those options are set, synthetic
      sequences will be generated from the provided background model
      and used to estimate significance statistics.

      <p></p>
      When computing statistical confidence
      estimates, <code>MCAST</code> must retain the matches in memory
      until the final distribution of scores can be estimated.  This
      means that the scanning of genome sized datasets has the
      potential to exhaust all available memory.  To avoid this
      problem,
      <code>MCAST</code> uses reservoir sampling of the match scores,
      and limits the number of matches that are kept in memory.
      The default number of matches kept in memory is 100,000,
      but this value can be adjusted via the
      <code><nobr>--max-stored-scores</nobr></code> option.
      If the maximum number of stored matches is reached, then
      <code>MCAST</code> will drop the least significant half of the
      matches.  This behavior may result in matches missing from
      the <code>MCAST</code> output, even though they would have
      satisified the user-specified <i>p</i>-value or <i>q</i>-value
      threshold.

      <p></p>
      A full description of the algorithm may be found in:
      
      <blockquote>
      <p></p>
      <a href="http://bioinformatics.oxfordjournals.org/cgi/content/abstract/19/suppl_2/ii16">
      Bailey and Noble. "Searching for statistically significant regulatory
      modules." <i>Bioinformatics (Proceedings of the European Conference on
      Computational Biology)</i>. 19(Suppl. 2):ii16-ii25, 2003.</a>
      </blockquote>
      <p></p>
      <b>Input:</b>
      <ul> 
      <li>
      <code>&lt;motifs&gt;</code> is a list of motifs, in 
      <a href="meme-format.html">MEME</a>
      or 
      <a href="transfac-format.html">TRANSFAC</a> format.
      </li>
      <li>
      <code>&lt;database&gt;</code> is a collection of DNA sequences in
      <A HREF="fasta-format.html">FASTA</A> format. 
      </li>
      </ul>
      <p></p>
      <b>Output:</b>
      <p></p>
      MCAST will create a directory named <code>mcast_out</code>
      (the name of this directory can be overridden via the
      <code><nobr>--o</nobr></code> or <code><nobr>--oc</nobr></code> options)
      The directory will contain:
      <ul>
      <li>
      A file named <code>mcast.xml</code> describing the inputs to MCAST in XML format
      </li>
      <li>
      A file named <code>cisml.xml</code> reporting the matches in XML format using the 
      <a href="http://zlab.bu.edu/~phaverty/SupplementalData/CisML">CisML</a> schema
      </li>
      <li>
      A file named <code>mcast.html</code> reporting the matches in HTML format
      </li>
      <li>
      A file named <code>mcast.txt</code> reporting the matches in tab-delimited format
      </li>
      <li>
      A file named <code>mcast.gff</code> reporting the matches in
      <a href="http://www.sanger.ac.uk/resources/software/gff/">GFF format</a>
      </li>
      <li>
      A file named <code>mcast.wig</code> reporting the matches in 
      <a href="https://cgwb.nci.nih.gov/goldenPath/help/wiggle.html">wiggle track format</a>
      </li>
      </ul>
      <p></p>
      The HTML output contains
      <ul>
      <li>A list of the motifs, and the best possible "hit" for each</li>
      <li>A list of matches. 
      Each match record contains
        <ul>
        <li>
        The name of the sequence
        </li> 
        <li>
        The starting and ending coordinates for the match.
        The coordinates are 1-based, 
        and start at the first position in the sequence.
        </li>
        <li>The match score</li>
        <li>The match p-value</li>
        <li>The match e-value</li>
        <li>The match q-value</li>
        <li>A block diagram showing the relative positions of each motif "hit" in the match</li>
        <li>A detailed view of each match is available as a pop-up window. 
        The detailed view shows the full sequence for the match,
        the alignment to the motifs,
        and the <i>p</i>-values for the motif hits</li>
        </ul>
      </li>
      <li>The inputs to <code>MCAST</code></li>
      <li>Text describing the MCAST results</li>
      </ul>
      <p></p>
      The plain text output contains a line for each match.
      Each line contains the following fields:
      <ul>
      <li>An id string for the match</li>
      <li>The name of the sequence containing the match</li>
      <li>The starting and ending coordinates of the match (1-based)</li>
      <li>The match score</li>
      <li>The match p-value</li>
      <li>The match e-value</li>
      <li>The match q-value</li>
      <li>The sequence of the matched region</li>
      </ul>
      The lines are sorted by score in descending order.
      <p></p>
      The wiggle track output contains the following entries:
      <ul>
        <li>A track line containing:</li>
          <ul>
            <li>The track type</li>
            <li>The source of the track (MCAST)</li>
          </ul>
        <li>A step size line containing:</li>
          <ul>
            <li>The sequence name</li>
            <li>The width of the match</li>
          </ul>
        <li>A data line containing:</li>
          <ul>
            <li>The start position of the match (closed, 1-based coordinates)</li>
            <li>A score based on the p-value of the match: -log(<i>p</i>-value) where</li>
          </ul>
      </ul>
      <p></p>
      The wiggle track output is sorted by sequence name and position.
      <p></p><b>Options:</b>
      <ul>
      <li><code>--bgfile <i>&lt;bfile&gt;</i></code> 
    - Read background frequencies from
    <code><i>&lt;bfile&gt;</i></code>.  
    The file should be in 
    <a href="bfile-format.html">MEME background file format</a>.
    The default is to use frequencies
    embedded in the application from the non-redundant database.  If the
    argument is the keyword <code>motif-file</code>, then the frequencies
    will be taken from the motif file.
  </li>
      <li><code>--bgweight <i>&lt;weight&gt;</i></code> 
    - Add <i>&lt;weight&gt;</i> times the background frequency to
    the corresponding letter counts in each motif when
    converting them to postion specific scoring matrices.
    The default value is 4.0.
  </li>
      <li><code>--max-gap <i>&lt;max-gap&gt;</i></code>
    - The value of <code><i>&lt;max-gap&gt;</i></code> specifies
    the longest distance allowed between two hits in a match.
    Hits separated by more than <code><i>&lt;max-gap&gt;</i></code> 
    will be placed in different matches. The default value is 50.
    <b>Note</b>:
    Large values of <code><i>&lt;max-gap&gt;</i></code> combined with
    large values of <i>pthresh</i> may prevent <code>MCAST</code> from
    computing <i>E</i>-values.
  </li>
      <li><code>--max-stored-scores <code><i>&lt;max&gt;</i></code></code>
    - Set the maximum number of scores that will be stored.
    Precise calculation of q-values depends on having a complete list of scores.
    However, keeping a complete list of scores may exceed available memory.
    Once the number of stored scores reaches the maximum allowed, 
    the least significant 50% of scores will be dropped,
    and approximate q-values will be calculated.
    By default the maximum number of stored matches is 100,000.
  </li>
      <li><code>--motif-pthresh <i>&lt;pv&gt;</i></code>
    sets the scale for calculating <i>pscores</i> for motif hits.
    The default value is 0.0005.
    The p-score for a hit with <i>p-</i>value <i>p</i> is
    <p></p><div style="margin-left: 2em"><i>S = -log<sub>2</sub>(p/pthresh),</i></div><p></p></li>
      <li><code>--o <i>&lt;dir name&gt;</i></code>
    - Specifies the output directory.
    If the directory already exists, the contents will not be overwritten.
  </li>
      <li><code>--oc <i>&lt;dir name&gt;</i></code>
    - Specifies the output directory.
    If the directory already exists, the contents will be overwritten.
  </li>
      <li><code>--output-ethresh <i>&lt;float&gt;</i></code>
    - The E-value threshold for displaying search results.
    If the E-value of a match is greater than this value,
    then the match will not be printed. 
    The default E-value threshold is 10.0.
    If any combination of <code>--output-ethresh</code>, 
    <code>--output-pthresh</code>,
    or <code>--output-qthresh</code> is given,
    whichever option occurs last on the command line
    will determine the effective output filter.
  </li>
      <li><code>--output-pthresh <i>&lt;float&gt;</i></code>
    - The p-value threshold for displaying search results.
    If the p-value of a match is greater than this value,
    then the match will not be printed. 
    If both the <code>--output-pthresh</code> and <code>--output-qthresh</code>
    options appear on the command line, whichever appears later
    on the command line will be applied.
    The default p-value threshold is 1e-4.
  </li>
      <li><code>--output-qthresh <i>&lt;float&gt;</i></code>
    - The q-value threshold for displaying search results.
    If the q-value of a match is greater than this value,
    then the match will not be printed.
    By default, no q-value threshold is applied.
  </li>
      <!--
      <li><command-option name="synth"/></li>
      -->
      <li><code>--transfac</code>
    - The input motif file is assumed to be in 
    <a href="transfac-format.html">TRANSFAC format</a>
    and is converted to 
    <a href="meme-format.html">MEME format</a>
    before being used.
  </li>
      <li><code>--verbosity 1|2|3|4</code>
    - Set the verbosity of status reports to standard error.
    The default level is 2.
  </li>
      </ul>
    </div>
  </body>
</html>
